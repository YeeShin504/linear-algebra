
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python scripts for NUS MA1522 Linear Algebra for Computing">
      
      
        <meta name="author" content="Yee Shin Teng">
      
      
        <link rel="canonical" href="https://yeeshin504.github.io/linear-algebra/api/symbolic/">
      
      
        <link rel="prev" href="../custom_types/">
      
      
        <link rel="next" href="../inherited/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>symbolic - linear-algebra</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ma1522.symbolic.Matrix" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="linear-algebra" class="md-header__button md-logo" aria-label="linear-algebra" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            linear-algebra
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              symbolic
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/YeeShin504/linear-algebra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    YeeShin504/linear-algebra
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../custom_types/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/tutorial/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../live/demo/" class="md-tabs__link">
          
  
  
  Demonstrations

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="linear-algebra" class="md-nav__button md-logo" aria-label="linear-algebra" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    linear-algebra
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/YeeShin504/linear-algebra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    YeeShin504/linear-algebra
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    custom_types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    symbolic
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    symbolic
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Matrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Matrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.from_latex" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_latex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.from_str" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_str
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.from_list" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.create_unk_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_unk_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.create_rand_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_rand_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.copy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.subs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;subs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.simplify" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;simplify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.identify" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;identify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.select_cols" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_cols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.select_rows" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.sep_part_gen" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sep_part_gen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.sep_unk" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sep_unk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.scalar_factor" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;scalar_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.aug_line" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;aug_line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.rm_aug_line" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rm_aug_line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.row_join" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;row_join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.col_join" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;col_join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.scale_row" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;scale_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.swap_row" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;swap_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.reduce_row" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reduce_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.get_pivot_row" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_pivot_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.get_pivot_pos" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_pivot_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.get_pivot_elements" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_pivot_elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.ref" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.evaluate_cases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;evaluate_cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.rref" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.solve" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;solve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.inverse" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;inverse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.elem" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;elem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.adjoint" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;adjoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.adj" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;adj
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.cramer_solve" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cramer_solve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.column_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;column_constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.normalized" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;normalized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_linearly_independent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_linearly_independent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.get_linearly_independent_vectors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_linearly_independent_vectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.simplify_basis" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;simplify_basis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.extend_basis" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extend_basis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.intersect_subspace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;intersect_subspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_subspace_of" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_subspace_of
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_same_subspace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_same_subspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.coords_relative" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;coords_relative
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.transition_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;transition_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.nullspace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;nullspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.nullity" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;nullity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.orthogonal_complement" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;orthogonal_complement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_vec_orthogonal" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_vec_orthogonal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_mat_orthogonal" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_mat_orthogonal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.orthogonal_decomposition" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;orthogonal_decomposition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.proj_comp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;proj_comp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.norm_comp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;norm_comp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.gram_schmidt" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;gram_schmidt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.QRdecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;QRdecomposition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.solve_least_squares" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;solve_least_squares
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.create_vander" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_vander
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.apply_vander" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;apply_vander
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.cpoly" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cpoly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_diagonalizable" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_diagonalizable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.eigenvects_associated" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;eigenvects_associated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.diagonalize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;diagonalize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_orthogonally_diagonalizable" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_orthogonally_diagonalizable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.orthogonally_diagonalize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;orthogonally_diagonalize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_stochastic" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_stochastic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.equilibrium_vectors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;equilibrium_vectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.singular_value_decomposition" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;singular_value_decomposition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.fast_svd" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;fast_svd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.standard_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;standard_matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inherited/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    inherited methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 8
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 10
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tut11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 11
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Demonstrations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Demonstrations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../live/demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Live Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Matrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Matrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.from_latex" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_latex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.from_str" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_str
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.from_list" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.create_unk_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_unk_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.create_rand_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_rand_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.copy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.subs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;subs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.simplify" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;simplify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.identify" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;identify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.select_cols" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_cols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.select_rows" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.sep_part_gen" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sep_part_gen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.sep_unk" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sep_unk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.scalar_factor" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;scalar_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.aug_line" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;aug_line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.rm_aug_line" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rm_aug_line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.row_join" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;row_join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.col_join" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;col_join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.scale_row" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;scale_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.swap_row" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;swap_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.reduce_row" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reduce_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.get_pivot_row" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_pivot_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.get_pivot_pos" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_pivot_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.get_pivot_elements" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_pivot_elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.ref" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.evaluate_cases" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;evaluate_cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.rref" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.solve" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;solve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.inverse" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;inverse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.elem" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;elem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.adjoint" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;adjoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.adj" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;adj
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.cramer_solve" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cramer_solve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.column_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;column_constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.normalized" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;normalized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_linearly_independent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_linearly_independent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.get_linearly_independent_vectors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_linearly_independent_vectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.simplify_basis" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;simplify_basis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.extend_basis" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extend_basis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.intersect_subspace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;intersect_subspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_subspace_of" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_subspace_of
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_same_subspace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_same_subspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.coords_relative" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;coords_relative
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.transition_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;transition_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.nullspace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;nullspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.nullity" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;nullity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.orthogonal_complement" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;orthogonal_complement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_vec_orthogonal" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_vec_orthogonal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_mat_orthogonal" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_mat_orthogonal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.orthogonal_decomposition" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;orthogonal_decomposition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.proj_comp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;proj_comp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.norm_comp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;norm_comp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.gram_schmidt" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;gram_schmidt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.QRdecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;QRdecomposition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.solve_least_squares" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;solve_least_squares
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.create_vander" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_vander
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.apply_vander" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;apply_vander
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.cpoly" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cpoly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_diagonalizable" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_diagonalizable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.eigenvects_associated" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;eigenvects_associated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.diagonalize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;diagonalize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_orthogonally_diagonalizable" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_orthogonally_diagonalizable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.orthogonally_diagonalize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;orthogonally_diagonalize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.is_stochastic" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_stochastic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.equilibrium_vectors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;equilibrium_vectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.singular_value_decomposition" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;singular_value_decomposition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.fast_svd" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;fast_svd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ma1522.symbolic.Matrix.standard_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;standard_matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>symbolic</h1>

<div class="doc doc-object doc-class">



<h2 id="ma1522.symbolic.Matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">ma1522</span><span class="o">.</span><span class="n">symbolic</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">aug_pos</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#ma1522.symbolic.Matrix" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="sympy.MutableDenseMatrix" href="https://docs.sympy.org/latest/modules/matrices/dense.html#sympy.matrices.dense.MutableDenseMatrix">MutableDenseMatrix</a></code></p>


        <p>A symbolic matrix class extending <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/dense.html#sympy.matrices.dense.MutableDenseMatrix"><code>MutableDenseMatrix</code></a> with enhanced linear algebra operations.</p>
<p>The inherited methods from <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/dense.html#sympy.matrices.dense.MutableDenseMatrix"><code>MutableDenseMatrix</code></a>
can be found in the <a href="https://docs.sympy.org/latest/modules/matrices/matrices.html">SymPy Matrices Documentation</a>. A summary of the
inherited attributes and methods is also available on the <a href="../inherited/">Inherited Methods Summary</a> page.</p>


<details class="this-class-provides-comprehensive-linear-algebra-functionality-with-support-for" open>
  <summary>This class provides comprehensive linear algebra functionality with support for</summary>
  <ul>
<li>Matrix creation from various sources (lists, <span class="arithmatex">\(\rm\LaTeX\)</span>, random values)</li>
<li>Matrix decompositions (REF, RREF, LU, QR, SVD, diagonalization)</li>
<li>Vector space operations (orthogonalization, projections, basis manipulation)</li>
<li>Eigenvalue/eigenvector computations</li>
<li>Custom printing and <span class="arithmatex">\(\rm\LaTeX\)</span> formatting with augmented matrix support</li>
</ul>
</details>

<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li>Maintains symbolic expressions throughout operations</li>
<li>Follows MA1522 syllabus conventions for linear algebra</li>
<li>Provides detailed step-by-step output for learning purposes</li>
<li>Supports both exact symbolic and numerical computations</li>
</ul>
</details>

<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="ma1522.symbolic.Matrix._aug_pos">_aug_pos</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#set">set</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>)
          –
          <div class="doc-md-description">
            <p>Set of column indices where augmentation lines should be drawn
for displaying augmented matrices.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic matrix operations:</p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">RREF(rref=Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 0]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0, 1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">]), pivots=(0, 1))</span>
</span></code></pre></div></td></tr></table></div>
    <p>Creating from LaTeX:</p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_latex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\begin</span><span class="si">{pmatrix}</span><span class="s1"> 1 &amp; 2 </span><span class="se">\\</span><span class="s1"> 3 &amp; 4 \end</span><span class="si">{pmatrix}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">⎡1  2⎤</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">⎢    ⎥</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">⎣3  4⎦</span>
</span></code></pre></div></td></tr></table></div>
    <p>Eigenvalue decomposition:</p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span>
<span class="normal"><a href="#__codelineno-0-8">8</a></span>
<span class="normal"><a href="#__codelineno-0-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span> <span class="n">D</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">(Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[-sqrt(33)/6 - 1/2, -1/2 + sqrt(33)/6]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[                1,                 1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">]), Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[5/2 - sqrt(33)/2,                0]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[               0, 5/2 + sqrt(33)/2]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>

          









<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            from_latex(expr: str, verbosity: int = 1, row_join: bool = True, norm: bool = False, aug_pos: Iterable[int] | int | None = None) -> Matrix

  
      staticmethod
   (ma1522.symbolic.Matrix.from_latex)" href="#ma1522.symbolic.Matrix.from_latex">from_latex</a></code></b>
            –
            <div class="doc-md-description">
              <p>Converts a <span class="arithmatex">\(\rm\LaTeX\)</span> matrix/vector expression into a Matrix object.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            from_str(matrix_str: str, row_sep: str = ';', col_sep: str = ' ', aug_pos: Iterable[int] | int | None = None, is_real: bool = True) -> Matrix

  
      staticmethod
   (ma1522.symbolic.Matrix.from_str)" href="#ma1522.symbolic.Matrix.from_str">from_str</a></code></b>
            –
            <div class="doc-md-description">
              <p>Parses a string representation of a matrix into a Matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            from_list(vectors: list[Matrix], row_join: bool = True, aug_pos: Iterable[int] | int | None = None) -> Matrix

  
      staticmethod
   (ma1522.symbolic.Matrix.from_list)" href="#ma1522.symbolic.Matrix.from_list">from_list</a></code></b>
            –
            <div class="doc-md-description">
              <p>Creates a Matrix object from a list of vectors.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            create_unk_matrix(r: int = 1, c: int = 1, symbol: str | None = None, is_real: bool | None = True, shape: Shape | None = None) -> Matrix

  
      staticmethod
   (ma1522.symbolic.Matrix.create_unk_matrix)" href="#ma1522.symbolic.Matrix.create_unk_matrix">create_unk_matrix</a></code></b>
            –
            <div class="doc-md-description">
              <p>Creates a symbolic matrix with unknown entries.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            create_rand_matrix(r: int = 1, c: int = 1, shape: Shape | None = None, *args, **kwargs) -> Matrix

  
      staticmethod
   (ma1522.symbolic.Matrix.create_rand_matrix)" href="#ma1522.symbolic.Matrix.create_rand_matrix">create_rand_matrix</a></code></b>
            –
            <div class="doc-md-description">
              <p>Creates a matrix with random entries.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            copy() -> Matrix (ma1522.symbolic.Matrix.copy)" href="#ma1522.symbolic.Matrix.copy">copy</a></code></b>
            –
            <div class="doc-md-description">
              <p>Creates a copy of the matrix, preserving augmentation lines.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            subs(*args, **kwargs) -> Matrix (ma1522.symbolic.Matrix.subs)" href="#ma1522.symbolic.Matrix.subs">subs</a></code></b>
            –
            <div class="doc-md-description">
              <p>Substitutes values in the matrix entries.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            simplify(rational: bool = True, suppress_warnings: bool = False, tolerance: float = 0.0001, simplify: bool = True, expand: bool = True, collect_sym: Symbol | None = None, *args, **kwargs) -> None (ma1522.symbolic.Matrix.simplify)" href="#ma1522.symbolic.Matrix.simplify">simplify</a></code></b>
            –
            <div class="doc-md-description">
              <p>Simplifies the matrix by applying various simplification techniques.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            identify(tol: float | None = None, suppress_warnings: bool = False, *args, **kwargs) -> Matrix (ma1522.symbolic.Matrix.identify)" href="#ma1522.symbolic.Matrix.identify">identify</a></code></b>
            –
            <div class="doc-md-description">
              <p>Identifies the matrix by applying a transformation function to each entry.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            select_cols(*args: int) -> Matrix (ma1522.symbolic.Matrix.select_cols)" href="#ma1522.symbolic.Matrix.select_cols">select_cols</a></code></b>
            –
            <div class="doc-md-description">
              <p>Selects columns from the matrix based on the provided column indices.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            select_rows(*args: int) -> Matrix (ma1522.symbolic.Matrix.select_rows)" href="#ma1522.symbolic.Matrix.select_rows">select_rows</a></code></b>
            –
            <div class="doc-md-description">
              <p>Selects rows from the matrix based on the provided row indices.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            sep_part_gen() -> PartGen (ma1522.symbolic.Matrix.sep_part_gen)" href="#ma1522.symbolic.Matrix.sep_part_gen">sep_part_gen</a></code></b>
            –
            <div class="doc-md-description">
              <p>Separates a matrix into its particular and general solution parts.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            sep_unk() -> dict[Expr, Matrix] (ma1522.symbolic.Matrix.sep_unk)" href="#ma1522.symbolic.Matrix.sep_unk">sep_unk</a></code></b>
            –
            <div class="doc-md-description">
              <p>Separates the matrix into matrices with each free symbol set to 1.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scalar_factor(column: bool = True) -> ScalarFactor (ma1522.symbolic.Matrix.scalar_factor)" href="#ma1522.symbolic.Matrix.scalar_factor">scalar_factor</a></code></b>
            –
            <div class="doc-md-description">
              <p>Factorizes a matrix into the form <span class="arithmatex">\(\mathbf{A} = \mathbf{FD}\)</span>, where <span class="arithmatex">\(\mathbf{D}\)</span> is a diagonal matrix</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            aug_line(pos: int = -1) -> Matrix (ma1522.symbolic.Matrix.aug_line)" href="#ma1522.symbolic.Matrix.aug_line">aug_line</a></code></b>
            –
            <div class="doc-md-description">
              <p>Inserts an augmented line at the specified position.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            rm_aug_line(pos: int | None = None) -> Matrix (ma1522.symbolic.Matrix.rm_aug_line)" href="#ma1522.symbolic.Matrix.rm_aug_line">rm_aug_line</a></code></b>
            –
            <div class="doc-md-description">
              <p>Remove an augmentation line from the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            row_join(other: Matrix, aug_line: bool = True) -> Matrix (ma1522.symbolic.Matrix.row_join)" href="#ma1522.symbolic.Matrix.row_join">row_join</a></code></b>
            –
            <div class="doc-md-description">
              <p>Joins two matrices horizontally (column-wise), preserving augmentation lines.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            col_join(other: Matrix) -> Matrix (ma1522.symbolic.Matrix.col_join)" href="#ma1522.symbolic.Matrix.col_join">col_join</a></code></b>
            –
            <div class="doc-md-description">
              <p>Joins two matrices vertically (row-wise), preserving augmentation lines.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            scale_row(idx: int, scalar: Expr | float | int, verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.scale_row)" href="#ma1522.symbolic.Matrix.scale_row">scale_row</a></code></b>
            –
            <div class="doc-md-description">
              <p>Scales a row of the matrix by a scalar and simplifies the result.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            swap_row(idx_1: int, idx_2: int, verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.swap_row)" href="#ma1522.symbolic.Matrix.swap_row">swap_row</a></code></b>
            –
            <div class="doc-md-description">
              <p>Swaps two rows of the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            reduce_row(idx_1: int, scalar: Expr | float | int, idx_2: int, verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.reduce_row)" href="#ma1522.symbolic.Matrix.reduce_row">reduce_row</a></code></b>
            –
            <div class="doc-md-description">
              <p>Reduces a row by subtracting a scalar multiple of another row.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_pivot_row(col_idx: int, row_start_idx: int, follow_GE: bool = False) -> int | None (ma1522.symbolic.Matrix.get_pivot_row)" href="#ma1522.symbolic.Matrix.get_pivot_row">get_pivot_row</a></code></b>
            –
            <div class="doc-md-description">
              <p>Finds the row index of the pivot element in a given column.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_pivot_pos() -> list[tuple[int, int]] (ma1522.symbolic.Matrix.get_pivot_pos)" href="#ma1522.symbolic.Matrix.get_pivot_pos">get_pivot_pos</a></code></b>
            –
            <div class="doc-md-description">
              <p>Finds the positions of the pivot elements in the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_pivot_elements() -> list[Expr] (ma1522.symbolic.Matrix.get_pivot_elements)" href="#ma1522.symbolic.Matrix.get_pivot_elements">get_pivot_elements</a></code></b>
            –
            <div class="doc-md-description">
              <p>Retrieves the pivot elements from the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            ref(verbosity: int = 2, max_tries: int = 2, follow_GE: bool = False) -> PLU (ma1522.symbolic.Matrix.ref)" href="#ma1522.symbolic.Matrix.ref">ref</a></code></b>
            –
            <div class="doc-md-description">
              <p>Find the Row Echelon Form (REF) of the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            evaluate_cases(rhs: Matrix | None = None, use_ref: bool = True) -> None (ma1522.symbolic.Matrix.evaluate_cases)" href="#ma1522.symbolic.Matrix.evaluate_cases">evaluate_cases</a></code></b>
            –
            <div class="doc-md-description">
              <p>Evaluates and displays all possible cases for solutions to a linear system involving the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            rref(*args, pivots: bool = True, **kwargs) -> RREF | Matrix (ma1522.symbolic.Matrix.rref)" href="#ma1522.symbolic.Matrix.rref">rref</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the Reduced Row Echelon Form (RREF) of the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            solve(rhs: Matrix) -> list[Matrix] (ma1522.symbolic.Matrix.solve)" href="#ma1522.symbolic.Matrix.solve">solve</a></code></b>
            –
            <div class="doc-md-description">
              <p>Solves the linear system <code>Ax = rhs</code> for <code>x</code>.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            inverse(option: Literal['left', 'right', 'both'] | None = None, matrices: int = 1, verbosity: int = 0) -> Matrix | PartGen | None (ma1522.symbolic.Matrix.inverse)" href="#ma1522.symbolic.Matrix.inverse">inverse</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the left or right inverse of a matrix, depending on its rank and the specified option.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            elem() -> Matrix (ma1522.symbolic.Matrix.elem)" href="#ma1522.symbolic.Matrix.elem">elem</a></code></b>
            –
            <div class="doc-md-description">
              <p>Returns the identity matrix with the same number of rows as the current matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            adjoint() -> Matrix (ma1522.symbolic.Matrix.adjoint)" href="#ma1522.symbolic.Matrix.adjoint">adjoint</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the adjugate (classical adjoint) of the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            adj(method: Literal['bareiss', 'berkowitz', 'bird', 'laplace', 'lu'] = 'berkowitz') -> Matrix (ma1522.symbolic.Matrix.adj)" href="#ma1522.symbolic.Matrix.adj">adj</a></code></b>
            –
            <div class="doc-md-description">
              <p>Alias for the <a class="autorefs autorefs-internal" title="            adjoint() -> Matrix" href="#ma1522.symbolic.Matrix.adjoint"><code>adjoint</code></a> method.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            cramer_solve(rhs: Matrix, det_method: str = 'laplace', verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.cramer_solve)" href="#ma1522.symbolic.Matrix.cramer_solve">cramer_solve</a></code></b>
            –
            <div class="doc-md-description">
              <p>Solves the linear system using Cramer's Rule.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            column_constraints(use_ref: bool = False, verbosity: int = 1) -> Matrix (ma1522.symbolic.Matrix.column_constraints)" href="#ma1522.symbolic.Matrix.column_constraints">column_constraints</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the column constraints for the matrix by appending a symbolic vector.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            normalized(iszerofunc: Callable[[Expr], int] | None = None, factor: bool = False) -> Matrix | ScalarFactor (ma1522.symbolic.Matrix.normalized)" href="#ma1522.symbolic.Matrix.normalized">normalized</a></code></b>
            –
            <div class="doc-md-description">
              <p>Normalizes the column vectors of the matrix (scaling each vector to have a unit norm).</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_linearly_independent(colspace: bool = True, verbosity: int = 0) -> bool (ma1522.symbolic.Matrix.is_linearly_independent)" href="#ma1522.symbolic.Matrix.is_linearly_independent">is_linearly_independent</a></code></b>
            –
            <div class="doc-md-description">
              <p>Determines if the vectors in the matrix are linearly independent.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            get_linearly_independent_vectors(colspace: bool = True, verbosity: int = 1) -> Matrix (ma1522.symbolic.Matrix.get_linearly_independent_vectors)" href="#ma1522.symbolic.Matrix.get_linearly_independent_vectors">get_linearly_independent_vectors</a></code></b>
            –
            <div class="doc-md-description">
              <p>Returns a matrix containing the linearly independent vectors from the column space or row space.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            simplify_basis(colspace: bool = True, verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.simplify_basis)" href="#ma1522.symbolic.Matrix.simplify_basis">simplify_basis</a></code></b>
            –
            <div class="doc-md-description">
              <p>Returns a simplified basis for the column space or row space of the matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            extend_basis(span_subspace: Matrix | None = None, verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.extend_basis)" href="#ma1522.symbolic.Matrix.extend_basis">extend_basis</a></code></b>
            –
            <div class="doc-md-description">
              <p>Extends the matrix to form a basis for the span of the given subspace.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            intersect_subspace(other: Matrix, verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.intersect_subspace)" href="#ma1522.symbolic.Matrix.intersect_subspace">intersect_subspace</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the intersection of two subspaces by finding the nullspace of their orthogonal complements.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_subspace_of(other: Matrix, verbosity: int = 2) -> bool (ma1522.symbolic.Matrix.is_subspace_of)" href="#ma1522.symbolic.Matrix.is_subspace_of">is_subspace_of</a></code></b>
            –
            <div class="doc-md-description">
              <p>Checks if the current matrix is a subspace of another matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_same_subspace(other: Matrix | None = None, verbosity: int = 2) -> bool (ma1522.symbolic.Matrix.is_same_subspace)" href="#ma1522.symbolic.Matrix.is_same_subspace">is_same_subspace</a></code></b>
            –
            <div class="doc-md-description">
              <p>Checks if two subspaces are the same by verifying if each subspace is a subspace of the other.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            coords_relative(basis: Matrix, verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.coords_relative)" href="#ma1522.symbolic.Matrix.coords_relative">coords_relative</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the coordinates of the current vector relative to a given basis.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            transition_matrix(to: Matrix, verbosity: int = 2) -> Matrix (ma1522.symbolic.Matrix.transition_matrix)" href="#ma1522.symbolic.Matrix.transition_matrix">transition_matrix</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the transition matrix that transforms this matrix to another matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            nullspace(verbosity: int = 0, *args, **kwargs) -> list[Matrix] (ma1522.symbolic.Matrix.nullspace)" href="#ma1522.symbolic.Matrix.nullspace">nullspace</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the null space (kernel) of the matrix, i.e., the set of vectors that satisfy <code>self @ x = 0</code>.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            nullity() -> int (ma1522.symbolic.Matrix.nullity)" href="#ma1522.symbolic.Matrix.nullity">nullity</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the nullity of the matrix, which is the dimension of its null space.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            orthogonal_complement(verbosity: int = 0) -> Matrix (ma1522.symbolic.Matrix.orthogonal_complement)" href="#ma1522.symbolic.Matrix.orthogonal_complement">orthogonal_complement</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the orthogonal complement of the matrix (the null space of its transpose).</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_vec_orthogonal(verbosity: int = 1) -> bool (ma1522.symbolic.Matrix.is_vec_orthogonal)" href="#ma1522.symbolic.Matrix.is_vec_orthogonal">is_vec_orthogonal</a></code></b>
            –
            <div class="doc-md-description">
              <p>Checks if the column vectors of the matrix are orthogonal to each other.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_mat_orthogonal(verbosity: int = 1) -> bool (ma1522.symbolic.Matrix.is_mat_orthogonal)" href="#ma1522.symbolic.Matrix.is_mat_orthogonal">is_mat_orthogonal</a></code></b>
            –
            <div class="doc-md-description">
              <p>Checks if the matrix is orthogonal (i.e., its columns are orthonormal).</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            orthogonal_decomposition(to: Matrix, verbosity: int = 0) -> VecDecomp (ma1522.symbolic.Matrix.orthogonal_decomposition)" href="#ma1522.symbolic.Matrix.orthogonal_decomposition">orthogonal_decomposition</a></code></b>
            –
            <div class="doc-md-description">
              <p>Decomposes the current vector (or matrix) into its orthogonal projection onto a subspace and its orthogonal complement.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            proj_comp(to: Matrix, verbosity: int = 0) -> Matrix (ma1522.symbolic.Matrix.proj_comp)" href="#ma1522.symbolic.Matrix.proj_comp">proj_comp</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the orthogonal projection of the current vector (or matrix) onto the subspace spanned by the columns of another matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            norm_comp(to: Matrix, verbosity: int = 0) -> Matrix (ma1522.symbolic.Matrix.norm_comp)" href="#ma1522.symbolic.Matrix.norm_comp">norm_comp</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the component of the current vector (or matrix) orthogonal to the subspace spanned by the columns of another matrix.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            gram_schmidt(factor: bool = True, verbosity: int = 1) -> Matrix | ScalarFactor (ma1522.symbolic.Matrix.gram_schmidt)" href="#ma1522.symbolic.Matrix.gram_schmidt">gram_schmidt</a></code></b>
            –
            <div class="doc-md-description">
              <p>Performs Gram-Schmidt orthogonalization to convert a set of vectors (columns of the matrix) into</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            QRdecomposition(full: bool = False, verbosity: int = 0) -> QR (ma1522.symbolic.Matrix.QRdecomposition)" href="#ma1522.symbolic.Matrix.QRdecomposition">QRdecomposition</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the QR decomposition of the matrix. Optionally computes the full QR decomposition.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            solve_least_squares(rhs: Matrix, verbosity: int = 1, matrices: int = 1, *args, **kwargs) -> Matrix | PartGen (ma1522.symbolic.Matrix.solve_least_squares)" href="#ma1522.symbolic.Matrix.solve_least_squares">solve_least_squares</a></code></b>
            –
            <div class="doc-md-description">
              <p>Solves the least squares problem <span class="arithmatex">\(\min || \mathrm{self} \, \mathbf{x} - \mathrm{rhs}||^2\)</span>.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            create_vander(num_rows: int = 1, num_cols: int = 1, symbol: str = 'x', is_real: bool = True) -> Matrix

  
      staticmethod
   (ma1522.symbolic.Matrix.create_vander)" href="#ma1522.symbolic.Matrix.create_vander">create_vander</a></code></b>
            –
            <div class="doc-md-description">
              <p>Creates a Vandermonde matrix with symbolic entries.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            apply_vander(x: Matrix) -> Matrix (ma1522.symbolic.Matrix.apply_vander)" href="#ma1522.symbolic.Matrix.apply_vander">apply_vander</a></code></b>
            –
            <div class="doc-md-description">
              <p>Applies a Vandermonde transformation to the current matrix using the given vector.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            cpoly(force_factor: bool = True) -> Mul | tuple[Mul, Mul] (ma1522.symbolic.Matrix.cpoly)" href="#ma1522.symbolic.Matrix.cpoly">cpoly</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the characteristic polynomial of the matrix and attempts to factor it into real and complex parts.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_diagonalizable(reals_only: bool = True, verbosity: int = 1, *args, **kwargs) -> bool (ma1522.symbolic.Matrix.is_diagonalizable)" href="#ma1522.symbolic.Matrix.is_diagonalizable">is_diagonalizable</a></code></b>
            –
            <div class="doc-md-description">
              <p>Checks if the matrix is diagonalizable, with the option to focus only on real eigenvalues.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            eigenvects_associated(eigenvalue: Expr | int | float) -> list[Matrix] | None (ma1522.symbolic.Matrix.eigenvects_associated)" href="#ma1522.symbolic.Matrix.eigenvects_associated">eigenvects_associated</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the eigenvectors associated with a given eigenvalue.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            diagonalize(reals_only: bool = True, verbosity: int = 0, *args, **kwargs) -> PDP (ma1522.symbolic.Matrix.diagonalize)" href="#ma1522.symbolic.Matrix.diagonalize">diagonalize</a></code></b>
            –
            <div class="doc-md-description">
              <p>Diagonalizes the matrix if possible, focusing on real eigenvalues unless specified otherwise.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_orthogonally_diagonalizable(verbosity: int = 2) -> bool (ma1522.symbolic.Matrix.is_orthogonally_diagonalizable)" href="#ma1522.symbolic.Matrix.is_orthogonally_diagonalizable">is_orthogonally_diagonalizable</a></code></b>
            –
            <div class="doc-md-description">
              <p>Determines whether the matrix is orthogonally diagonalizable.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            orthogonally_diagonalize(reals_only: bool = True, factor: bool = True, verbosity=1, *args, **kwargs) -> PDP (ma1522.symbolic.Matrix.orthogonally_diagonalize)" href="#ma1522.symbolic.Matrix.orthogonally_diagonalize">orthogonally_diagonalize</a></code></b>
            –
            <div class="doc-md-description">
              <p>Orthogonally diagonalizes the matrix, ensuring that eigenvectors corresponding to different eigenvalues are orthogonal.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            is_stochastic(verbosity: int = 1) -> bool (ma1522.symbolic.Matrix.is_stochastic)" href="#ma1522.symbolic.Matrix.is_stochastic">is_stochastic</a></code></b>
            –
            <div class="doc-md-description">
              <p>Checks if the matrix is stochastic.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            equilibrium_vectors() -> Matrix (ma1522.symbolic.Matrix.equilibrium_vectors)" href="#ma1522.symbolic.Matrix.equilibrium_vectors">equilibrium_vectors</a></code></b>
            –
            <div class="doc-md-description">
              <p>Computes the equilibrium vectors of the matrix, i.e., the nullspace of (I - A).</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            singular_value_decomposition(verbosity: int = 0, tol: float = 0.0, verify: bool = True) -> SVD (ma1522.symbolic.Matrix.singular_value_decomposition)" href="#ma1522.symbolic.Matrix.singular_value_decomposition">singular_value_decomposition</a></code></b>
            –
            <div class="doc-md-description">
              <p>Performs Singular Value Decomposition (SVD) on the matrix, following the MA1522 syllabus.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            fast_svd(option: Literal['np', 'sym'] = 'np', identify: bool = True, tol: float | None = None) -> SVD | NumSVD (ma1522.symbolic.Matrix.fast_svd)" href="#ma1522.symbolic.Matrix.fast_svd">fast_svd</a></code></b>
            –
            <div class="doc-md-description">
              <p>A faster version of SVD that computes numerically using NumPy's SVD function.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="            standard_matrix(out: Matrix, matrices: int = 1) -> list[Matrix] | list[PartGen] (ma1522.symbolic.Matrix.standard_matrix)" href="#ma1522.symbolic.Matrix.standard_matrix">standard_matrix</a></code></b>
            –
            <div class="doc-md-description">
              <p>Returns the standard matrix for the transformation from self to out.</p>
            </div>
          </li>
    </ul>



                  <details class="quote">
                    <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">aug_pos</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">if</span> <span class="n">aug_pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aug_pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">aug_pos</span><span class="p">])</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aug_pos</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">aug_pos</span><span class="p">):</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">aug_pos</span><span class="p">)</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="sa">f</span><span class="s2">&quot;Invalid type for aug_pos: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">aug_pos</span><span class="p">)</span><span class="si">}</span><span class="s2">. Expected Iterable[int].&quot;</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.from_latex" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">from_latex</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_join</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">aug_pos</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ma1522.symbolic.Matrix.from_latex" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Converts a <span class="arithmatex">\(\rm\LaTeX\)</span> matrix/vector expression into a Matrix object.</p>
<p>Parses <span class="arithmatex">\(\rm\LaTeX\)</span> matrix environments (pmatrix, array) and vector lists into a Matrix.
Handles matrix multiplication expressions and normalizes vectors when requested.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>expr</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p><span class="arithmatex">\(\rm\LaTeX\)</span> string containing:</p>
<ul>
<li>Matrix environments:
    <code>\begin{pmatrix} ... \end{pmatrix}</code>, <code>\begin{array}{ccc} ... \end{array}</code></li>
<li>Vector lists:
    <code>\{ \begin{pmatrix} ... \end{pmatrix}, \begin{pmatrix} ... \end{pmatrix}\}</code></li>
<li>Matrix products:
    <code>\begin{pmatrix}...\end{pmatrix}\begin{pmatrix} ... \end{pmatrix}</code></li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Controls output detail level:
- 0: No output
- 1: Display parsed matrix</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>row_join</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, vector lists are treated as columns.
If False, vectors are treated as rows.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>norm</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If True, normalizes vectors to unit length.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>aug_pos</code></b>
              (<code><a class="autorefs autorefs-external" title="collections.abc.Iterable" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>] | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If provided, specifies the column indices
where augmentation lines should be drawn in the output matrix. This is useful for displaying
augmented matrices in a visually clear manner. If <code>None</code>, no augmentation lines are drawn.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The parsed matrix with optional normalization.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#Exception">Exception</a></code>
            –
          <div class="doc-md-description">
            <p>If the <span class="arithmatex">\(\rm\LaTeX\)</span> expression is empty, invalid or cannot be parsed.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_latex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\begin</span><span class="si">{pmatrix}</span><span class="s1"> 1 &amp; 2 </span><span class="se">\\</span><span class="s1"> 3 &amp; 4 \end</span><span class="si">{pmatrix}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">Matrix([</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[1, 2]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[3, 4]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_latex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\begin</span><span class="si">{pmatrix}</span><span class="s1"> 1 </span><span class="se">\\</span><span class="s1"> 2 </span><span class="se">\\</span><span class="s1"> 3 \end</span><span class="si">{pmatrix}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">Matrix([</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[  sqrt(14)/14]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[   sqrt(14)/7]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3*sqrt(14)/14]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_latex</span><span class="p">(</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="n">row_join</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="n">norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="n">aug_pos</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Converts a $\rm\LaTeX$ matrix/vector expression into a Matrix object.</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    Parses $\rm\LaTeX$ matrix environments (pmatrix, array) and vector lists into a Matrix.</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    Handles matrix multiplication expressions and normalizes vectors when requested.</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    Args:</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        expr (str): $\rm\LaTeX$ string containing:</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            - Matrix environments:</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">                `\begin{pmatrix} ... \end{pmatrix}`, `\begin{array}{ccc} ... \end{array}`</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            - Vector lists:</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">                `\{ \begin{pmatrix} ... \end{pmatrix}, \begin{pmatrix} ... \end{pmatrix}\}`</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            - Matrix products:</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">                `\begin{pmatrix}...\end{pmatrix}\begin{pmatrix} ... \end{pmatrix}`</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        verbosity (int): Controls output detail level:</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            - 0: No output</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            - 1: Display parsed matrix</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        row_join (bool): If True, vector lists are treated as columns.</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            If False, vectors are treated as rows.</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        norm (bool): If True, normalizes vectors to unit length.</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        aug_pos (Iterable[int] | int | None): If provided, specifies the column indices</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            where augmentation lines should be drawn in the output matrix. This is useful for displaying</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            augmented matrices in a visually clear manner. If `None`, no augmentation lines are drawn.</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        (Matrix): The parsed matrix with optional normalization.</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        Exception: If the $\rm\LaTeX$ expression is empty, invalid or cannot be parsed.</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        &gt;&gt;&gt; Matrix.from_latex(r&#39;\begin{pmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{pmatrix}&#39;, verbosity=0)</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        [1, 2]</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        [3, 4]</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        ])</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        &gt;&gt;&gt; Matrix.from_latex(r&#39;\begin{pmatrix} 1 \\ 2 \\ 3 \end{pmatrix}&#39;, verbosity=0, norm=True)</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        [  sqrt(14)/14]</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        [   sqrt(14)/7]</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        [3*sqrt(14)/14]</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        ])</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="c1"># Step 1: Modify the LaTeX string to ensure compatibility with the parser.</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="c1"># Convert array-like LaTeX to pmatrix for proper matrix formatting</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="c1"># Replace \begin{array}{ccc*} with \begin{pmatrix}</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">modified_latex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin\{array\}(?:\{[^}]*\})?&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="si">{pmatrix}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">expr</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="p">)</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="c1"># Replace \end{array} with \end{pmatrix}</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">modified_latex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end\{array\}&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end</span><span class="si">{pmatrix}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">modified_latex</span><span class="p">)</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="c1"># Remove LaTeX semicolon for cleaner parsing</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="n">modified_latex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">modified_latex</span><span class="p">)</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="c1"># Step 2: Use latex2sympy to parse the modified LaTeX expression into SymPy Matrix</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">latex2sympy</span><span class="p">(</span><span class="n">modified_latex</span><span class="p">)</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="n">display</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="c1"># Step 3: Handle the parsed result based on its type (list, MatMul, or Matrix)</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">()</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="n">vector_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="n">vector</span> <span class="o">=</span> <span class="n">vector</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="n">vector_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">vector_list</span><span class="p">,</span> <span class="n">row_join</span><span class="p">)</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">MatMul</span><span class="p">):</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="c1"># If the matrix is a product of matrices, evaluate the product directly</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">):</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="c1"># Directly converts the SymPy Matrix into the custom Matrix object to inherit the custom methods</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="c1"># If the result is neither a list nor a matrix expression, return the raw result</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">if</span> <span class="n">aug_pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="n">aug_pos</span><span class="p">)</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="c1"># Step 4: Normalisation</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="k">if</span> <span class="n">norm</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">):</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">return</span> <span class="n">mat</span><span class="o">.</span><span class="n">normalized</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">return</span> <span class="n">mat</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.from_str" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">from_str</span><span class="p">(</span><span class="n">matrix_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">col_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">aug_pos</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">is_real</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ma1522.symbolic.Matrix.from_str" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Parses a string representation of a matrix into a Matrix.</p>
<p>This method enables quick creation of a Matrix object from a string format similar to
the one used in MATLAB. It supports both row and column separators and
uses SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/parsing.html#sympy.parsing.sympy_parser.parse_expr"><code>parse_expr</code></a> to convert
the entries of the matrix from a string format into a Matrix object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>matrix_str</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
            <p>The string representation of the matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>row_sep</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                  <code>&#39;;&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>The separator for rows in the string.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>col_sep</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                  <code>&#39; &#39;</code>
)
          –
          <div class="doc-md-description">
            <p>The separator for columns in the string.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>aug_pos</code></b>
              (<code><a class="autorefs autorefs-external" title="collections.abc.Iterable" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>] | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If provided, specifies the column indices
where augmentation lines should be drawn in the output matrix. This is useful for displaying
augmented matrices in a visually clear manner. If <code>None</code>, no augmentation lines are drawn.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>is_real</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the symbols in the matrix are considered real-valued. Otherwise, they are complex.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A Matrix object representing the parsed matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#SyntaxError">SyntaxError</a></code>
            –
          <div class="doc-md-description">
            <p>If the string cannot be parsed into a matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="s2">&quot;[1 2; 3 4]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">Matrix([</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[1, 2]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[3, 4]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_str</span><span class="p">(</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="n">matrix_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="n">row_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="n">col_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="n">aug_pos</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">is_real</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses a string representation of a matrix into a Matrix.</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">    This method enables quick creation of a Matrix object from a string format similar to</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    the one used in MATLAB. It supports both row and column separators and</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    uses SymPy&#39;s [`parse_expr`][sympy.parsing.sympy_parser.parse_expr] to convert</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">    the entries of the matrix from a string format into a Matrix object.</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    Args:</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        matrix_str (str): The string representation of the matrix.</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        row_sep (str, optional): The separator for rows in the string.</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        col_sep (str): The separator for columns in the string.</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        aug_pos (Iterable[int] | int | None, optional): If provided, specifies the column indices</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">            where augmentation lines should be drawn in the output matrix. This is useful for displaying</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">            augmented matrices in a visually clear manner. If `None`, no augmentation lines are drawn.</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        is_real (bool, optional): If True, the symbols in the matrix are considered real-valued. Otherwise, they are complex.</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        (Matrix): A Matrix object representing the parsed matrix.</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        SyntaxError: If the string cannot be parsed into a matrix.</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        &gt;&gt;&gt; Matrix.from_str(&quot;[1 2; 3 4]&quot;)</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        [1, 2]</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        [3, 4]</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        ])</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="n">matrix_str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">matrix_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">removesuffix</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="p">)</span>  <span class="c1"># remove surrounding brackets</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="n">rows</span> <span class="o">=</span> <span class="n">matrix_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">row_sep</span><span class="p">)</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="n">matrix</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">cols</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">col_sep</span><span class="p">)</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">parse_expr</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">])</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="k">if</span> <span class="n">aug_pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="n">aug_pos</span><span class="p">)</span>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="n">symbols</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="n">new_symbols</span> <span class="o">=</span> <span class="n">_standardise_symbol</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">is_real</span><span class="o">=</span><span class="n">is_real</span><span class="p">)</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="n">matrix</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">s</span><span class="p">:</span> <span class="n">n</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">new_symbols</span><span class="p">)})</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="k">return</span> <span class="n">matrix</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.from_list" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">from_list</span><span class="p">(</span><span class="n">vectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">],</span> <span class="n">row_join</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">aug_pos</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ma1522.symbolic.Matrix.from_list" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Creates a Matrix object from a list of vectors.</p>
<p>This method takes a list of vectors (each represented as a Matrix object)
and combines them into a single matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>vectors</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a>]</code>)
          –
          <div class="doc-md-description">
            <p>A list of Matrix objects, where each Matrix
represents a row or column vector.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>row_join</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the vectors are joined horizontally.
If False, the vectors are stacked vertically.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>aug_pos</code></b>
              (<code><a class="autorefs autorefs-external" title="collections.abc.Iterable" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>] | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If provided, specifies the column indices
where augmentation lines should be drawn in the output matrix. This is useful for displaying
augmented matrices in a visually clear manner. If <code>None</code>, no augmentation lines are drawn.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix constructed from the list of vectors.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.ShapeError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.ShapeError">ShapeError</a></code>
            –
          <div class="doc-md-description">
            <p>If the vectors do not have compatible dimensions for joining.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">vec1</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">vec2</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">])</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1, 3]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[2, 4]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">],</span> <span class="n">row_join</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">Matrix([</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[1]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[4]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_list</span><span class="p">(</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="n">vectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">],</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="n">row_join</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="n">aug_pos</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a Matrix object from a list of vectors.</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">    This method takes a list of vectors (each represented as a Matrix object)</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    and combines them into a single matrix.</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    Args:</span>
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        vectors (list[Matrix]): A list of Matrix objects, where each Matrix</span>
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            represents a row or column vector.</span>
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458"></a>
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        row_join (bool, optional): If True, the vectors are joined horizontally.</span>
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">            If False, the vectors are stacked vertically.</span>
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        aug_pos (Iterable[int] | int | None, optional): If provided, specifies the column indices</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">            where augmentation lines should be drawn in the output matrix. This is useful for displaying</span>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">            augmented matrices in a visually clear manner. If `None`, no augmentation lines are drawn.</span>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        (Matrix): A matrix constructed from the list of vectors.</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        sympy.matrices.exceptions.ShapeError: If the vectors do not have compatible dimensions for joining.</span>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        &gt;&gt;&gt; vec1 = Matrix([[1], [2]])</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        &gt;&gt;&gt; vec2 = Matrix([[3], [4]])</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        &gt;&gt;&gt; Matrix.from_list([vec1, vec2])</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        [1, 3]</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        [2, 4]</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        ])</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        &gt;&gt;&gt; Matrix.from_list([vec1, vec2], row_join=False)</span>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        [1]</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        [2]</span>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">        [3]</span>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        [4]</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">        ])</span>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">vectors</span><span class="p">:</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="k">return</span> <span class="n">Matrix</span><span class="p">([])</span>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">vectors</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">vectors</span><span class="p">:</span>
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="k">if</span> <span class="n">row_join</span><span class="p">:</span>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="k">if</span> <span class="n">aug_pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="n">aug_pos</span><span class="p">)</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="k">return</span> <span class="n">res</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.create_unk_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">create_unk_matrix</span><span class="p">(</span><span class="n">r</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">is_real</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">Shape</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ma1522.symbolic.Matrix.create_unk_matrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Creates a symbolic matrix with unknown entries.</p>
<p>This method generates a matrix of size <span class="arithmatex">\(r \times c\)</span> with symbolic
entries. The entries are named based on the provided <code>symbol</code> parameter and
indexed by their row and column positions. The <code>is_real</code> flag determines whether
the symbols are real-valued.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>For a column vector without a specified symbol, the entries will be named
    following conventions, i.e., <span class="arithmatex">\(\begin{pmatrix} x \end{pmatrix}\)</span>,
    <span class="arithmatex">\(\begin{pmatrix} x \\ y \end{pmatrix}\)</span>,
    <span class="arithmatex">\(\begin{pmatrix} x \\ y \\ z \end{pmatrix}\)</span>, for 1, 2 and 3 rows respectively.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>r</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The number of rows in the matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>c</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The number of columns in the matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>symbol</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The base name for the symbols used in the matrix entries.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>is_real</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the symbols are real-valued. Otherwise, they are complex.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>shape</code></b>
              (<code><a class="autorefs autorefs-internal" title="            Shape (ma1522.custom_types.Shape)" href="../custom_types/#ma1522.custom_types.Shape">Shape</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If provided, the matrix will be reshaped to this
specific shape. Supported shapes include:</p>
<ul>
<li><a class="autorefs autorefs-internal" title="            DIAGONAL = 'DIAGONAL'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.DIAGONAL">DIAGONAL</a>: Returns a diagonal matrix.</li>
<li><a class="autorefs autorefs-internal" title="            SCALAR = 'SCALAR'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.SCALAR">SCALAR</a>: Returns a scalar matrix.</li>
<li><a class="autorefs autorefs-internal" title="            UPPER = 'UPPER'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.UPPER">UPPER</a>: Returns an upper triangular matrix.</li>
<li><a class="autorefs autorefs-internal" title="            LOWER = 'LOWER'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.LOWER">LOWER</a>: Returns a lower triangular matrix.</li>
<li><a class="autorefs autorefs-internal" title="            STRICT_UPPER = 'STRICT_UPPER'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.STRICT_UPPER">STRICT_UPPER</a>: Returns an upper triangular matrix without the diagonal.</li>
<li><a class="autorefs autorefs-internal" title="            STRICT_LOWER = 'STRICT_LOWER'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.STRICT_LOWER">STRICT_LOWER</a>: Returns a lower triangular matrix without the diagonal.</li>
<li><a class="autorefs autorefs-internal" title="            SYMMETRIC = 'SYMMETRIC'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.SYMMETRIC">SYMMETRIC</a>: Returns a symmetric matrix.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix with symbolic entries of the specified size.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.NonSquareMatrixError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.NonSquareMatrixError">NonSquareMatrixError</a></code>
            –
          <div class="doc-md-description">
            <p>If <code>shape</code> is ill-defined on a non-square matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">create_unk_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">Matrix([</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[a_1,1, a_1,2],</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[a_2,1, a_2,2]])</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">create_unk_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">Matrix([</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[y_1]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[y_2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[y_3]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            create_rand_matrix(r: int = 1, c: int = 1, shape: Shape | None = None, *args, **kwargs) -> Matrix

  
      staticmethod
  " href="#ma1522.symbolic.Matrix.create_rand_matrix"><code>create_rand_matrix</code></a>: Creates a matrix with random entries.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_unk_matrix</span><span class="p">(</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="n">r</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>    <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="n">is_real</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="n">shape</span><span class="p">:</span> <span class="n">Shape</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Creates a symbolic matrix with unknown entries.</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">    This method generates a matrix of size $r \times c$ with symbolic</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">    entries. The entries are named based on the provided `symbol` parameter and</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">    indexed by their row and column positions. The `is_real` flag determines whether</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">    the symbols are real-valued.</span>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">    Note:</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">        - For a column vector without a specified symbol, the entries will be named</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">            following conventions, i.e., $\begin{pmatrix} x \end{pmatrix}$,</span>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            $\begin{pmatrix} x \\ y \end{pmatrix}$,</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">            $\begin{pmatrix} x \\ y \\ z \end{pmatrix}$, for 1, 2 and 3 rows respectively.</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a>
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">    Args:</span>
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        r (int, optional): The number of rows in the matrix.</span>
</span><span id="__span-0-558"><a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        c (int, optional): The number of columns in the matrix.</span>
</span><span id="__span-0-559"><a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">        symbol (str, optional): The base name for the symbols used in the matrix entries.</span>
</span><span id="__span-0-560"><a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">        is_real (bool, optional): If True, the symbols are real-valued. Otherwise, they are complex.</span>
</span><span id="__span-0-561"><a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        shape (Shape, optional): If provided, the matrix will be reshaped to this</span>
</span><span id="__span-0-562"><a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">            specific shape. Supported shapes include:</span>
</span><span id="__span-0-563"><a id="__codelineno-0-563" name="__codelineno-0-563"></a>
</span><span id="__span-0-564"><a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">            - [DIAGONAL][(p).Shape.DIAGONAL]: Returns a diagonal matrix.</span>
</span><span id="__span-0-565"><a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">            - [SCALAR][(p).Shape.SCALAR]: Returns a scalar matrix.</span>
</span><span id="__span-0-566"><a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">            - [UPPER][(p).Shape.UPPER]: Returns an upper triangular matrix.</span>
</span><span id="__span-0-567"><a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">            - [LOWER][(p).Shape.LOWER]: Returns a lower triangular matrix.</span>
</span><span id="__span-0-568"><a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">            - [STRICT_UPPER][(p).Shape.STRICT_UPPER]: Returns an upper triangular matrix without the diagonal.</span>
</span><span id="__span-0-569"><a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">            - [STRICT_LOWER][(p).Shape.STRICT_LOWER]: Returns a lower triangular matrix without the diagonal.</span>
</span><span id="__span-0-570"><a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">            - [SYMMETRIC][(p).Shape.SYMMETRIC]: Returns a symmetric matrix.</span>
</span><span id="__span-0-571"><a id="__codelineno-0-571" name="__codelineno-0-571"></a>
</span><span id="__span-0-572"><a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-573"><a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        (Matrix): A matrix with symbolic entries of the specified size.</span>
</span><span id="__span-0-574"><a id="__codelineno-0-574" name="__codelineno-0-574"></a>
</span><span id="__span-0-575"><a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-576"><a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        sympy.matrices.exceptions.NonSquareMatrixError: If `shape` is ill-defined on a non-square matrix.</span>
</span><span id="__span-0-577"><a id="__codelineno-0-577" name="__codelineno-0-577"></a>
</span><span id="__span-0-578"><a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-579"><a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        &gt;&gt;&gt; Matrix.create_unk_matrix(2, 2, symbol=&#39;a&#39;)</span>
</span><span id="__span-0-580"><a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-581"><a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        [a_1,1, a_1,2],</span>
</span><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        [a_2,1, a_2,2]])</span>
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583"></a>
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        &gt;&gt;&gt; Matrix.create_unk_matrix(3, 1, symbol=&#39;y&#39;)</span>
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        [y_1]</span>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        [y_2]</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">        [y_3]</span>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">        ])</span>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">        - [`create_rand_matrix`][..]: Creates a matrix with random entries.</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="c1"># Create a vector of size rows with entries (x, y) or (..., y, z)</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="mi">26</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">symbol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">ls</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="k">match</span> <span class="n">r</span><span class="p">:</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>                <span class="n">ls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>                <span class="n">ls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a>            <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a>                <span class="n">ls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;xyz&quot;</span><span class="p">)</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a>                <span class="n">ascii_lowercase</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">)</span>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a>                <span class="n">ls</span> <span class="o">=</span> <span class="n">ascii_lowercase</span><span class="p">[</span><span class="mi">26</span> <span class="o">-</span> <span class="n">r</span> <span class="p">:]</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="n">is_real</span><span class="p">)</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="k">if</span> <span class="n">symbol</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">_(1:</span><span class="si">{</span><span class="n">r</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="n">is_real</span><span class="p">)</span>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a>    <span class="c1"># Creates a matrix of size rows * cols with entries symbol_i,j</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="n">symbol</span> <span class="o">=</span> <span class="n">symbol</span> <span class="ow">or</span> <span class="s2">&quot;x&quot;</span>  <span class="c1"># default is &quot;x&quot;</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="n">entries</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">_(1:</span><span class="si">{</span><span class="n">r</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)</span><span class="se">\\</span><span class="s2">,(1:</span><span class="si">{</span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="n">is_real</span><span class="p">)</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a>    <span class="k">if</span> <span class="n">shape</span><span class="p">:</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="k">return</span> <span class="n">res</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.create_rand_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">create_rand_matrix</span><span class="p">(</span><span class="n">r</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">Shape</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ma1522.symbolic.Matrix.create_rand_matrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Creates a matrix with random entries.</p>
<p>This method generates a matrix of size <span class="arithmatex">\(r \times c\)</span> where the
entries are real integers. The values in the matrix are generated using SymPy's
<a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.dense.randMatrix"><code>randMatrix</code></a> function.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The entries in the matrix are generated randomly and will change each time
    the function is called. Setting a random seed using <code>seed</code> in <code>**kwargs</code>
    will ensure reproducibility of the random values.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>r</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The number of rows in the matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>c</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The number of columns in the matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>shape</code></b>
              (<code><a class="autorefs autorefs-internal" title="            Shape (ma1522.custom_types.Shape)" href="../custom_types/#ma1522.custom_types.Shape">Shape</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>If provided, the matrix will be reshaped to this
specific shape. Supported shapes include:</p>
<ul>
<li><a class="autorefs autorefs-internal" title="            DIAGONAL = 'DIAGONAL'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.DIAGONAL">DIAGONAL</a>: Returns a diagonal matrix.</li>
<li><a class="autorefs autorefs-internal" title="            SCALAR = 'SCALAR'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.SCALAR">SCALAR</a>: Returns a scalar matrix.</li>
<li><a class="autorefs autorefs-internal" title="            UPPER = 'UPPER'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.UPPER">UPPER</a>: Returns an upper triangular matrix.</li>
<li><a class="autorefs autorefs-internal" title="            LOWER = 'LOWER'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.LOWER">LOWER</a>: Returns a lower triangular matrix.</li>
<li><a class="autorefs autorefs-internal" title="            STRICT_UPPER = 'STRICT_UPPER'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.STRICT_UPPER">STRICT_UPPER</a>: Returns an upper triangular matrix without the diagonal.</li>
<li><a class="autorefs autorefs-internal" title="            STRICT_LOWER = 'STRICT_LOWER'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.STRICT_LOWER">STRICT_LOWER</a>: Returns a lower triangular matrix without the diagonal.</li>
<li><a class="autorefs autorefs-internal" title="            SYMMETRIC = 'SYMMETRIC'

  
      class-attribute
      instance-attribute
  " href="../custom_types/#ma1522.custom_types.Shape.SYMMETRIC">SYMMETRIC</a>: Returns a symmetric matrix.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments passed to the <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.dense.randMatrix"><code>randMatrix</code></a>
function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments passed to the <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.dense.randMatrix"><code>randMatrix</code></a>
function.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A Matrix with random entries of the specified size.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.NonSquareMatrixError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.NonSquareMatrixError">NonSquareMatrixError</a></code>
            –
          <div class="doc-md-description">
            <p>If <code>shape</code> is ill-defined on a non-square matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">create_rand_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">Matrix([</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[81, 14,  3]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[94, 35, 31]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            create_unk_matrix(r: int = 1, c: int = 1, symbol: str | None = None, is_real: bool | None = True, shape: Shape | None = None) -> Matrix

  
      staticmethod
  " href="#ma1522.symbolic.Matrix.create_unk_matrix"><code>create_unk_matrix</code></a>: Creates a matrix with symbolic entries.</li>
<li><a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.dense.randMatrix"><code>randMatrix</code></a>: SymPy function to create a random matrix.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_rand_matrix</span><span class="p">(</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a>    <span class="n">r</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="n">c</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="n">shape</span><span class="p">:</span> <span class="n">Shape</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Creates a matrix with random entries.</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">    This method generates a matrix of size $r \times c$ where the</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">    entries are real integers. The values in the matrix are generated using SymPy&#39;s</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">    [`randMatrix`][sympy.matrices.dense.randMatrix] function.</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">    Note:</span>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">        - The entries in the matrix are generated randomly and will change each time</span>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            the function is called. Setting a random seed using `seed` in `**kwargs`</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            will ensure reproducibility of the random values.</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">    Args:</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">        r (int, optional): The number of rows in the matrix.</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">        c (int, optional): The number of columns in the matrix.</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        shape (Shape, optional): If provided, the matrix will be reshaped to this</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">            specific shape. Supported shapes include:</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">            - [DIAGONAL][(p).Shape.DIAGONAL]: Returns a diagonal matrix.</span>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            - [SCALAR][(p).Shape.SCALAR]: Returns a scalar matrix.</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            - [UPPER][(p).Shape.UPPER]: Returns an upper triangular matrix.</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">            - [LOWER][(p).Shape.LOWER]: Returns a lower triangular matrix.</span>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            - [STRICT_UPPER][(p).Shape.STRICT_UPPER]: Returns an upper triangular matrix without the diagonal.</span>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">            - [STRICT_LOWER][(p).Shape.STRICT_LOWER]: Returns a lower triangular matrix without the diagonal.</span>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">            - [SYMMETRIC][(p).Shape.SYMMETRIC]: Returns a symmetric matrix.</span>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        *args: Additional arguments passed to the [`randMatrix`][sympy.matrices.dense.randMatrix]</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">            function.</span>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">        **kwargs: Additional arguments passed to the [`randMatrix`][sympy.matrices.dense.randMatrix]</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">            function.</span>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">        (Matrix): A Matrix with random entries of the specified size.</span>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">        sympy.matrices.exceptions.NonSquareMatrixError: If `shape` is ill-defined on a non-square matrix.</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">        &gt;&gt;&gt; Matrix.create_rand_matrix(2, 3, seed=42)</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">        [81, 14,  3]</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">        [94, 35, 31]</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">        ])</span>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">        - [`create_unk_matrix`][..]: Creates a matrix with symbolic entries.</span>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">        - [`randMatrix`][sympy.matrices.dense.randMatrix]: SymPy function to create a random matrix.</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">randMatrix</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="k">if</span> <span class="n">shape</span><span class="p">:</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a>        <span class="k">return</span> <span class="n">res</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.copy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.copy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Creates a copy of the matrix, preserving augmentation lines.</p>
<p>This method returns a new <a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a> object that is a deep copy of the current matrix,
including any augmentation line positions (used for displaying augmented matrices).</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new matrix object with the same entries and augmentation lines as the original.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">aug_pos</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">})</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat_copy</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat_copy</span> <span class="o">==</span> <span class="n">mat</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">True</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat_copy</span> <span class="ow">is</span> <span class="n">mat</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">False</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-754"><a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-755"><a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-756"><a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">    Creates a copy of the matrix, preserving augmentation lines.</span>
</span><span id="__span-0-757"><a id="__codelineno-0-757" name="__codelineno-0-757"></a>
</span><span id="__span-0-758"><a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">    This method returns a new [`Matrix`][...] object that is a deep copy of the current matrix,</span>
</span><span id="__span-0-759"><a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">    including any augmentation line positions (used for displaying augmented matrices).</span>
</span><span id="__span-0-760"><a id="__codelineno-0-760" name="__codelineno-0-760"></a>
</span><span id="__span-0-761"><a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-762"><a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">        (Matrix): A new matrix object with the same entries and augmentation lines as the original.</span>
</span><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763"></a>
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]], aug_pos={1})</span>
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">        &gt;&gt;&gt; mat_copy = mat.copy()</span>
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        &gt;&gt;&gt; mat_copy == mat</span>
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">        True</span>
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">        &gt;&gt;&gt; mat_copy is mat</span>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">        False</span>
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772"></a>    <span class="n">new_mat</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773"></a>    <span class="n">aug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">new_mat</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="n">aug</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.subs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">subs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.subs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Substitutes values in the matrix entries.</p>
<p>This method overrides SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.subs"><code>subs</code></a>
method to ensure that the augmentation lines are preserved after substitution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Positional arguments for substitution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments for substitution.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new matrix with substituted values, preserving augmentation lines.</p>
          </div>
        </li>
    </ul>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="k">def</span><span class="w"> </span><span class="nf">subs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Substitutes values in the matrix entries.</span>
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779"></a>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">    This method overrides SymPy&#39;s [`subs`][sympy.matrices.matrixbase.MatrixBase.subs]</span>
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">    method to ensure that the augmentation lines are preserved after substitution.</span>
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782"></a>
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">    Args:</span>
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">        *args: Positional arguments for substitution.</span>
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">        **kwargs: Keyword arguments for substitution.</span>
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786"></a>
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">        (Matrix): A new matrix with substituted values, preserving augmentation lines.</span>
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="n">new_mat</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="n">aug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">new_mat</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="n">aug</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.simplify" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">simplify</span><span class="p">(</span><span class="n">rational</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="n">simplify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">collect_sym</span><span class="p">:</span> <span class="n">Symbol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

<a href="#ma1522.symbolic.Matrix.simplify" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Simplifies the matrix by applying various simplification techniques.</p>


<details class="this-method-performs-several-operations-on-the-matrix-to-simplify-its-entries" open>
  <summary>This method performs several operations on the matrix to simplify its entries</summary>
  <ul>
<li>Rational simplification.</li>
<li>General symbolic simplification.</li>
<li>Expansion or factoring of expressions.</li>
<li>Collecting terms involving a specific symbol (if provided).</li>
</ul>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Rational simplification attempts to convert entries into rational numbers if possible.
    If there is a residue (e.g. attempting to convert a non-rational number into a rational),
    a warning is printed with the approximation error.</li>
<li>Expansion and factoring can be controlled by the <code>expand</code> parameter.</li>
<li>The matrix is modified in place.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rational</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, applies rational simplification
to the matrix entries using <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/simplify/simplify.html#sympy.simplify.simplify.nsimplify"><code>sym.nsimplify</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>suppress_warnings</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If True, suppresses warnings about non-zero residues
after rational simplification.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tolerance</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.0001</code>
)
          –
          <div class="doc-md-description">
            <p>The tolerance for rational simplification.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>simplify</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, applies general symbolic simplification using <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/simplify/simplify.html#sympy.simplify.simplify.simplify"><code>sym.simplify</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>expand</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, applies expansion to the matrix entries. If False, applies factoring instead.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>collect_sym</code></b>
              (<code><a class="autorefs autorefs-external" title="sympy.core.symbol.Symbol" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.symbol.Symbol">Symbol</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>A symbol to collect terms with. If provided,
<a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/simplify/simplify.html#sympy.simplify.radsimp.collect"><code>sym.collect</code></a> will be applied to all entries of the matrix with respect to this symbol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments passed to the <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/simplify/simplify.html#sympy.simplify.simplify.simplify"><code>sym.simplify</code></a> function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments passed to the <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/simplify/simplify.html#sympy.simplify.simplify.simplify"><code>sym.simplify</code></a> function.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new simplified matrix with the applied operations.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">rational</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[x + 1, x + 2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[x + 3, x + 4]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="k">def</span><span class="w"> </span><span class="nf">simplify</span><span class="p">(</span>
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797"></a>    <span class="n">rational</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="n">simplify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801"></a>    <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802"></a>    <span class="n">collect_sym</span><span class="p">:</span> <span class="n">Symbol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="__span-0-804"><a id="__codelineno-0-804" name="__codelineno-0-804"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-805"><a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Simplifies the matrix by applying various simplification techniques.</span>
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807"></a>
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">    This method performs several operations on the matrix to simplify its entries:</span>
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">        - Rational simplification.</span>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">        - General symbolic simplification.</span>
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">        - Expansion or factoring of expressions.</span>
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">        - Collecting terms involving a specific symbol (if provided).</span>
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813"></a>
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">    Note:</span>
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">        - Rational simplification attempts to convert entries into rational numbers if possible.</span>
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">            If there is a residue (e.g. attempting to convert a non-rational number into a rational),</span>
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">            a warning is printed with the approximation error.</span>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">        - Expansion and factoring can be controlled by the `expand` parameter.</span>
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        - The matrix is modified in place.</span>
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820"></a>
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">    Args:</span>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        rational (bool, optional): If True, applies rational simplification</span>
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">            to the matrix entries using [`sym.nsimplify`][sympy.simplify.simplify.nsimplify].</span>
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        suppress_warnings (bool, optional): If True, suppresses warnings about non-zero residues</span>
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">            after rational simplification.</span>
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">        tolerance (float, optional): The tolerance for rational simplification.</span>
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">        simplify (bool, optional): If True, applies general symbolic simplification using [`sym.simplify`][sympy.simplify.simplify.simplify].</span>
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        expand (bool, optional): If True, applies expansion to the matrix entries. If False, applies factoring instead.</span>
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">        collect_sym (Symbol, optional): A symbol to collect terms with. If provided,</span>
</span><span id="__span-0-830"><a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">            [`sym.collect`][sympy.simplify.radsimp.collect] will be applied to all entries of the matrix with respect to this symbol.</span>
</span><span id="__span-0-831"><a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">        *args: Additional arguments passed to the [`sym.simplify`][sympy.simplify.simplify.simplify] function.</span>
</span><span id="__span-0-832"><a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">        **kwargs: Additional arguments passed to the [`sym.simplify`][sympy.simplify.simplify.simplify] function.</span>
</span><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833"></a>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">        (Matrix): A new simplified matrix with the applied operations.</span>
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836"></a>
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[sym.symbols(&#39;x&#39;) + 1, sym.symbols(&#39;x&#39;) + 2], [sym.symbols(&#39;x&#39;) + 3, sym.symbols(&#39;x&#39;) + 4]])</span>
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        &gt;&gt;&gt; mat.simplify(rational=False, expand=True)</span>
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">        &gt;&gt;&gt; mat</span>
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        [x + 1, x + 2]</span>
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        [x + 3, x + 4]</span>
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">        ])</span>
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846"></a>
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a>    <span class="k">if</span> <span class="n">rational</span><span class="p">:</span>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">nsimplify</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="n">residues</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a>        <span class="k">if</span> <span class="n">residues</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">suppress_warnings</span><span class="p">:</span>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">residues</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a>            <span class="n">warn</span><span class="p">(</span>
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="s2">                Non-zero Approximation Error: </span><span class="si">{</span><span class="n">res</span><span class="si">}</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="s2">                Rational approximation might have failed. Try lower tolerance.&quot;&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a>                <span class="ne">RuntimeWarning</span><span class="p">,</span>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a>                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="p">)</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a>    <span class="k">if</span> <span class="n">simplify</span><span class="p">:</span>
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862"></a>    <span class="k">if</span> <span class="n">expand</span><span class="p">:</span>
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</span><span id="__span-0-864"><a id="__codelineno-0-864" name="__codelineno-0-864"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">applyfunc</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sym</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-0-866"><a id="__codelineno-0-866" name="__codelineno-0-866"></a>    <span class="k">if</span> <span class="n">collect_sym</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-867"><a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">applyfunc</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sym</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">collect_sym</span><span class="p">))</span>
</span><span id="__span-0-868"><a id="__codelineno-0-868" name="__codelineno-0-868"></a>
</span><span id="__span-0-869"><a id="__codelineno-0-869" name="__codelineno-0-869"></a>    <span class="c1"># Create a new Matrix object from the simplified list and update the original object</span>
</span><span id="__span-0-870"><a id="__codelineno-0-870" name="__codelineno-0-870"></a>    <span class="n">aug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="n">aug</span><span class="p">)</span>  <span class="c1"># prevent SymPy from losing _aug_pos</span>
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.identify" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">identify</span><span class="p">(</span><span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.identify" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Identifies the matrix by applying a transformation function to each entry.</p>
<p>This method applies a transformation to each element of the matrix using
the <a class="autorefs autorefs-external" href="https://mpmath.org/doc/current/identification.html#mpmath.identify"><code>identify</code></a> function from the <code>mp</code> module. After identification,
the method checks if there is any residue (i.e., if the matrix has been modified).</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>If there is a residue (i.e., unable to identify an entry, such as <span class="arithmatex">\(\pi\)</span>),
    a warning is printed with the approximation error. This can be resolved by
    lowering <code>tolerance</code> or supplying appropriate <code>constants</code> as <code>**kwargs</code> to
    the <code>identify</code> function.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>tol</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>A tolerance value that is passed to the
<a class="autorefs autorefs-external" href="https://mpmath.org/doc/current/identification.html#mpmath.identify"><code>identify</code></a> function. If None, no tolerance is applied.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>suppress_warnings</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If True, suppresses warnings about non-zero residues
after identification.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Additional positional arguments passed to the
<a class="autorefs autorefs-external" href="https://mpmath.org/doc/current/identification.html#mpmath.identify"><code>identify</code></a> function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments passed to the
<a class="autorefs autorefs-external" href="https://mpmath.org/doc/current/identification.html#mpmath.identify"><code>identify</code></a> function.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new matrix that results from applying the transformation to
each element of the original matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">e</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">identify</span><span class="p">()</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[        2, E]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[sqrt(2)/2, 0]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-external" href="https://mpmath.org/doc/current/identification.html#mpmath.identify"><code>mpmath.identify</code></a>: The function used to identify
  the entries of the matrix.</li>
<li><a class="autorefs autorefs-internal" title="            simplify(rational: bool = True, suppress_warnings: bool = False, tolerance: float = 0.0001, simplify: bool = True, expand: bool = True, collect_sym: Symbol | None = None, *args, **kwargs) -> None" href="#ma1522.symbolic.Matrix.simplify"><code>simplify</code></a>:
  For general simplification of the matrix entries.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="k">def</span><span class="w"> </span><span class="nf">identify</span><span class="p">(</span>
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Identifies the matrix by applying a transformation function to each entry.</span>
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878"></a>
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    This method applies a transformation to each element of the matrix using</span>
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">    the [`identify`][mpmath.identify] function from the `mp` module. After identification,</span>
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">    the method checks if there is any residue (i.e., if the matrix has been modified).</span>
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882"></a>
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">    Note:</span>
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">        - If there is a residue (i.e., unable to identify an entry, such as $\pi$),</span>
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">            a warning is printed with the approximation error. This can be resolved by</span>
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">            lowering `tolerance` or supplying appropriate `constants` as `**kwargs` to</span>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">            the `identify` function.</span>
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888"></a>
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    Args:</span>
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">        tol (float, optional): A tolerance value that is passed to the</span>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">            [`identify`][mpmath.identify] function. If None, no tolerance is applied.</span>
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">        suppress_warnings (bool, optional): If True, suppresses warnings about non-zero residues</span>
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">            after identification.</span>
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">        *args: Additional positional arguments passed to the</span>
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">            [`identify`][mpmath.identify] function.</span>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">        **kwargs: Additional keyword arguments passed to the</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">            [`identify`][mpmath.identify] function.</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        (Matrix): A new matrix that results from applying the transformation to</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">            each element of the original matrix.</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a>
</span><span id="__span-0-903"><a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-904"><a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">        &gt;&gt;&gt; import math</span>
</span><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[math.sqrt(4), math.e], [1/math.sqrt(2), 0.0]])</span>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">        &gt;&gt;&gt; mat.identify()</span>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">        [        2, E]</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">        [sqrt(2)/2, 0]</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">        ])</span>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">        - [`mpmath.identify`][mpmath.identify]: The function used to identify</span>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">          the entries of the matrix.</span>
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        - [`simplify`][..simplify]:</span>
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">          For general simplification of the matrix entries.</span>
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918"></a>
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">applyfunc</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mp</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a>    <span class="n">residues</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a>    <span class="k">if</span> <span class="n">residues</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">suppress_warnings</span><span class="p">:</span>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">residues</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a>        <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Non-zero Identification Error: </span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a>    <span class="k">return</span> <span class="n">temp</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.select_cols" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">select_cols</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.select_cols" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Selects columns from the matrix based on the provided column indices.</p>
<p>This method returns a new matrix consisting of the columns specified by the
provided indices. The columns are selected from the original matrix, and the
result is returned as a new matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>()</code>
)
          –
          <div class="doc-md-description">
            <p>One or more column indices (0-based) to select from the matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new matrix consisting of the selected columns.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 3]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[4, 6]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="k">def</span><span class="w"> </span><span class="nf">select_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Selects columns from the matrix based on the provided column indices.</span>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">    This method returns a new matrix consisting of the columns specified by the</span>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">    provided indices. The columns are selected from the original matrix, and the</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">    result is returned as a new matrix.</span>
</span><span id="__span-0-932"><a id="__codelineno-0-932" name="__codelineno-0-932"></a>
</span><span id="__span-0-933"><a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">    Args:</span>
</span><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">        *args (int): One or more column indices (0-based) to select from the matrix.</span>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">        (Matrix): A new matrix consisting of the selected columns.</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2, 3], [4, 5, 6]])</span>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">        &gt;&gt;&gt; mat.select_cols(0, 2)</span>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        [1, 3]</span>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        [4, 6]</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">        ])</span>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">idx</span><span class="p">)))</span>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.select_rows" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">select_rows</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.select_rows" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Selects rows from the matrix based on the provided row indices.</p>
<p>This method returns a new matrix consisting of the rows specified by the
provided indices. The rows are selected from the original matrix, and the
result is returned as a new matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>()</code>
)
          –
          <div class="doc-md-description">
            <p>One or more row indices (0-based) to select from the matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new matrix consisting of the selected rows.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">select_rows</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([[1, 2, 3]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="k">def</span><span class="w"> </span><span class="nf">select_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Selects rows from the matrix based on the provided row indices.</span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">    This method returns a new matrix consisting of the rows specified by the</span>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">    provided indices. The rows are selected from the original matrix, and the</span>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">    result is returned as a new matrix.</span>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">    Args:</span>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        *args (int): One or more row indices (0-based) to select from the matrix.</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">        (Matrix): A new matrix consisting of the selected rows.</span>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-967"><a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2, 3], [4, 5, 6]])</span>
</span><span id="__span-0-968"><a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">        &gt;&gt;&gt; mat.select_rows(0)</span>
</span><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="sd">        Matrix([[1, 2, 3]</span>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">        ])</span>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a>    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">idx</span><span class="p">)))</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.sep_part_gen" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">sep_part_gen</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">PartGen</span></code>

<a href="#ma1522.symbolic.Matrix.sep_part_gen" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Separates a matrix into its particular and general solution parts.</p>


<details class="this-method-separates-the-matrix-into-two-components" open>
  <summary>This method separates the matrix into two components</summary>
  <ul>
<li>The <strong>particular solution</strong>, which is the solution to the system when
    all free variables are set to zero.</li>
<li>The <strong>general solution</strong>, which is the full solution including the
    homogeneous part.</li>
</ul>
</details>        <p>It assumes that the matrix is in symbolic form and contains free variables that can be set to zero.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              PartGen(part_sol: Matrix, gen_sol: Matrix)

  
      dataclass
   (ma1522.custom_types.PartGen)" href="../custom_types/#ma1522.custom_types.PartGen">PartGen</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing two matrices:</p>
<ul>
<li><code>part_sol</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The particular solution
    (with free variables set to zero).</li>
<li><code>gen_sol</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The general solution (the original matrix
    minus the particular solution).</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">symbols</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PG</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">sep_part_gen</span><span class="p">()</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PG</span><span class="o">.</span><span class="n">part_sol</span> <span class="c1"># Particular solution</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[2,  3]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[0, -2]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">])</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PG</span><span class="o">.</span><span class="n">gen_sol</span> <span class="c1"># General solution</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="go">Matrix([</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="go">[  x, 0]</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="go">[3*x, x]</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="k">def</span><span class="w"> </span><span class="nf">sep_part_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartGen</span><span class="p">:</span>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    Separates a matrix into its particular and general solution parts.</span>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">    This method separates the matrix into two components:</span>
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        - The **particular solution**, which is the solution to the system when</span>
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">            all free variables are set to zero.</span>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        - The **general solution**, which is the full solution including the</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">            homogeneous part.</span>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a>
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">    It assumes that the matrix is in symbolic form and contains free variables that can be set to zero.</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        (PartGen): A dataclass containing two matrices:</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">            - `part_sol` ([`Matrix`][...]): The particular solution</span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">                (with free variables set to zero).</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">            - `gen_sol` ([`Matrix`][...]): The general solution (the original matrix</span>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">                minus the particular solution).</span>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a>
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        &gt;&gt;&gt; from sympy import symbols</span>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">        &gt;&gt;&gt; x = symbols(&#39;x&#39;)</span>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[x + 2, 3], [3*x, x - 2]])</span>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">        &gt;&gt;&gt; PG = mat.sep_part_gen()</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">        &gt;&gt;&gt; PG.part_sol # Particular solution</span>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">        [2,  3]</span>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">        [0, -2]</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">        ])</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">        &gt;&gt;&gt; PG.gen_sol # General solution</span>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">        [  x, 0]</span>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        [3*x, x]</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">        ])</span>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>    <span class="n">set_0</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">))</span>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>    <span class="n">part_sol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">set_0</span><span class="p">)</span>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>    <span class="n">gen_sol</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">part_sol</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>    <span class="k">return</span> <span class="n">PartGen</span><span class="p">(</span><span class="n">part_sol</span><span class="p">,</span> <span class="n">gen_sol</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.sep_unk" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">sep_unk</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Expr</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">]</span></code>

<a href="#ma1522.symbolic.Matrix.sep_unk" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Separates the matrix into matrices with each free symbol set to 1.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" title="sympy.core.expr.Expr" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.expr.Expr">Expr</a>, <a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a>]</code>
          –
          <div class="doc-md-description">
            <p>Returns a dictionary where the sum of the key*value pairs
reconstructs the original matrix. Each key is a free symbol, and each value is a
matrix with that symbol set to 1 and all other free symbols set to 0.</p>
          </div>
        </li>
    </ul>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="k">def</span><span class="w"> </span><span class="nf">sep_unk</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Expr</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">]:</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Separates the matrix into matrices with each free symbol set to 1.</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">        (dict[Expr, Matrix]): Returns a dictionary where the sum of the key*value pairs</span>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">            reconstructs the original matrix. Each key is a free symbol, and each value is a</span>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">            matrix with that symbol set to 1 and all other free symbols set to 0.</span>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>    <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>    <span class="n">res</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Expr</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Matrix</span><span class="p">)</span>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>        <span class="n">sub</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">syms</span> <span class="k">if</span> <span class="n">symbol</span> <span class="o">!=</span> <span class="n">sym</span><span class="p">))</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>        <span class="n">sub</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="n">res</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>    <span class="k">return</span> <span class="n">res</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.scalar_factor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">scalar_factor</span><span class="p">(</span><span class="n">column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarFactor</span></code>

<a href="#ma1522.symbolic.Matrix.scalar_factor" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Factorizes a matrix into the form <span class="arithmatex">\(\mathbf{A} = \mathbf{FD}\)</span>, where <span class="arithmatex">\(\mathbf{D}\)</span> is a diagonal matrix
and <span class="arithmatex">\(\mathbf{F}\)</span> contains the vectors with common divisors factored out (if <code>column=True</code>). If <code>column=False</code>,
then returns <span class="arithmatex">\(\mathbf{A} = \mathbf{DF}\)</span> instead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>column</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, factorizes by columns. If <code>False</code>, factorizes by rows.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ScalarFactor(diag: Matrix, full: Matrix, order: Literal['FD', 'DF'])

  
      dataclass
   (ma1522.custom_types.ScalarFactor)" href="../custom_types/#ma1522.custom_types.ScalarFactor">ScalarFactor</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass of two matrices (F, D) and order (FD or DF)</p>
<ul>
<li><code>diag</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The diagonal matrix containing the common divisors.</li>
<li><code>full</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The matrix with common divisors factored out.</li>
<li><code>order</code> (str): The order of the factorization, either "FD" (for column factorization) or "DF" (for row factorization).</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">SF</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">scalar_factor</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">SF</span><span class="o">.</span><span class="n">full</span><span class="p">,</span> <span class="n">SF</span><span class="o">.</span><span class="n">diag</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">(Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1, 3]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[2, 5]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">]), Matrix([</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[6, 0]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">[0, 3]</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="k">def</span><span class="w"> </span><span class="nf">scalar_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarFactor</span><span class="p">:</span>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Factorizes a matrix into the form $\mathbf{A} = \mathbf{FD}$, where $\mathbf{D}$ is a diagonal matrix</span>
</span><span id="__span-0-1038"><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">    and $\mathbf{F}$ contains the vectors with common divisors factored out (if `column=True`). If `column=False`,</span>
</span><span id="__span-0-1039"><a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">    then returns $\mathbf{A} = \mathbf{DF}$ instead.</span>
</span><span id="__span-0-1040"><a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>
</span><span id="__span-0-1041"><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1042"><a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">        column (bool): If `True`, factorizes by columns. If `False`, factorizes by rows.</span>
</span><span id="__span-0-1043"><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
</span><span id="__span-0-1044"><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1045"><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">        (ScalarFactor): A dataclass of two matrices (F, D) and order (FD or DF)</span>
</span><span id="__span-0-1046"><a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>
</span><span id="__span-0-1047"><a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">            - `diag` ([`Matrix`][...]): The diagonal matrix containing the common divisors.</span>
</span><span id="__span-0-1048"><a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">            - `full` ([`Matrix`][...]): The matrix with common divisors factored out.</span>
</span><span id="__span-0-1049"><a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">            - `order` (str): The order of the factorization, either &quot;FD&quot; (for column factorization) or &quot;DF&quot; (for row factorization).</span>
</span><span id="__span-0-1050"><a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>
</span><span id="__span-0-1051"><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1052"><a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[6, 9], [12, 15]])</span>
</span><span id="__span-0-1053"><a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">        &gt;&gt;&gt; SF = mat.scalar_factor(column=True)</span>
</span><span id="__span-0-1054"><a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        &gt;&gt;&gt; SF.full, SF.diag</span>
</span><span id="__span-0-1055"><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">        (Matrix([</span>
</span><span id="__span-0-1056"><a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">        [1, 3]</span>
</span><span id="__span-0-1057"><a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">        [2, 5]</span>
</span><span id="__span-0-1058"><a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">        ]), Matrix([</span>
</span><span id="__span-0-1059"><a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        [6, 0]</span>
</span><span id="__span-0-1060"><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        [0, 3]</span>
</span><span id="__span-0-1061"><a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">        ]))</span>
</span><span id="__span-0-1062"><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1063"><a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>
</span><span id="__span-0-1064"><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prettify</span><span class="p">(</span><span class="n">scalar</span><span class="p">:</span> <span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expr</span><span class="p">:</span>
</span><span id="__span-0-1065"><a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="n">num</span><span class="p">,</span> <span class="n">den</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">fraction</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span>
</span><span id="__span-0-1066"><a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>        <span class="k">if</span> <span class="n">den</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-1067"><a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>            <span class="c1"># return non-fractions as it is</span>
</span><span id="__span-0-1068"><a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>            <span class="k">return</span> <span class="n">num</span>
</span><span id="__span-0-1069"><a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>        <span class="c1"># for scalar in the form sqrt(x * k**2) / x, return k / sqrt(x)</span>
</span><span id="__span-0-1070"><a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>        <span class="c1"># most notable case is sqrt(x) / x, which should return 1/sqrt(x)</span>
</span><span id="__span-0-1071"><a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num</span> <span class="o">/</span> <span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">den</span><span class="p">),</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1072"><a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">is_integer</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1073"><a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>            <span class="k">with</span> <span class="n">sym</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-1074"><a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>                <span class="k">return</span> <span class="n">k</span> <span class="o">/</span> <span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">den</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1075"><a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1076"><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>            <span class="k">return</span> <span class="n">scalar</span>
</span><span id="__span-0-1077"><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>
</span><span id="__span-0-1078"><a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>    <span class="n">scalars</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-1079"><a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>    <span class="n">F</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-0-1080"><a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>    <span class="k">if</span> <span class="n">column</span><span class="p">:</span>
</span><span id="__span-0-1081"><a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
</span><span id="__span-0-1082"><a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>            <span class="n">g</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</span><span id="__span-0-1083"><a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>            <span class="n">F</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">g</span>
</span><span id="__span-0-1084"><a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>            <span class="n">scalars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prettify</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
</span><span id="__span-0-1085"><a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">*</span><span class="n">scalars</span><span class="p">)</span>
</span><span id="__span-0-1086"><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>        <span class="k">assert</span> <span class="bp">self</span> <span class="o">==</span> <span class="p">(</span><span class="n">F</span> <span class="o">@</span> <span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">(),</span> <span class="s2">&quot;Matrix factorization failed.&quot;</span>
</span><span id="__span-0-1087"><a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>        <span class="k">return</span> <span class="n">ScalarFactor</span><span class="p">(</span><span class="n">diag</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;FD&quot;</span><span class="p">)</span>
</span><span id="__span-0-1088"><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1089"><a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
</span><span id="__span-0-1090"><a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>            <span class="n">g</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</span><span id="__span-0-1091"><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>            <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">g</span>
</span><span id="__span-0-1092"><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>            <span class="n">scalars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prettify</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
</span><span id="__span-0-1093"><a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">*</span><span class="n">scalars</span><span class="p">)</span>
</span><span id="__span-0-1094"><a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>        <span class="k">assert</span> <span class="bp">self</span> <span class="o">==</span> <span class="p">(</span><span class="n">D</span> <span class="o">@</span> <span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">(),</span> <span class="s2">&quot;Matrix factorization failed.&quot;</span>
</span><span id="__span-0-1095"><a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>        <span class="k">return</span> <span class="n">ScalarFactor</span><span class="p">(</span><span class="n">diag</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;DF&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.aug_line" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">aug_line</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.aug_line" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Inserts an augmented line at the specified position.</p>
<p>This method adds an augmented line (i.e., a visual vertical line)
to the matrix at the specified column position. If no position is provided (default: -1),
the line is inserted at the last column.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The method updates the <code>_aug_pos</code> attribute to track the position of the inserted line.</li>
<li>Negative <code>pos</code> will be converted before inserting it into <code>_aug_pos</code>.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pos</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>-1</code>
)
          –
          <div class="doc-md-description">
            <p>The position (column index) where the augmented line will be inserted.
Default -1 means the augmented line is added at the end of the matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The current matrix with the augmented line added at the specified position.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#IndexError">IndexError</a></code>
            –
          <div class="doc-md-description">
            <p>If the <code>pos</code> is out of range.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">aug_line</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1 | 2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3 | 4]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">aug_line</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 2 | 1, 2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3, 4 | 3, 4]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            rm_aug_line(pos: int | None = None) -> Matrix" href="#ma1522.symbolic.Matrix.rm_aug_line"><code>rm_aug_line</code></a>: Removes an augmentation line from the matrix.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="k">def</span><span class="w"> </span><span class="nf">aug_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inserts an augmented line at the specified position.</span>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">    This method adds an augmented line (i.e., a visual vertical line)</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">    to the matrix at the specified column position. If no position is provided (default: -1),</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">    the line is inserted at the last column.</span>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">        - The method updates the `_aug_pos` attribute to track the position of the inserted line.</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">        - Negative `pos` will be converted before inserting it into `_aug_pos`.</span>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">        pos (int, optional):</span>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">            The position (column index) where the augmented line will be inserted.</span>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            Default -1 means the augmented line is added at the end of the matrix.</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">        (Matrix): The current matrix with the augmented line added at the specified position.</span>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">        IndexError: If the `pos` is out of range.</span>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>
</span><span id="__span-0-1123"><a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1124"><a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-1125"><a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">        &gt;&gt;&gt; mat.aug_line(0)</span>
</span><span id="__span-0-1126"><a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1127"><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">        [1 | 2]</span>
</span><span id="__span-0-1128"><a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">        [3 | 4]</span>
</span><span id="__span-0-1129"><a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">        ])</span>
</span><span id="__span-0-1130"><a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>
</span><span id="__span-0-1131"><a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-1132"><a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        &gt;&gt;&gt; mat.aug_line().row_join(mat)</span>
</span><span id="__span-0-1133"><a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1134"><a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">        [1, 2 | 1, 2]</span>
</span><span id="__span-0-1135"><a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">        [3, 4 | 3, 4]</span>
</span><span id="__span-0-1136"><a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">        ])</span>
</span><span id="__span-0-1137"><a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>
</span><span id="__span-0-1138"><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-1139"><a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">        - [`rm_aug_line`][..]: Removes an augmentation line from the matrix.</span>
</span><span id="__span-0-1140"><a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1141"><a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>
</span><span id="__span-0-1142"><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>    <span class="n">new_pos</span> <span class="o">=</span> <span class="n">pos</span>
</span><span id="__span-0-1143"><a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>    <span class="k">if</span> <span class="n">new_pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1144"><a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>        <span class="n">new_pos</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span>
</span><span id="__span-0-1145"><a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>
</span><span id="__span-0-1146"><a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">new_pos</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
</span><span id="__span-0-1147"><a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
</span><span id="__span-0-1148"><a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>            <span class="sa">f</span><span class="s2">&quot;Position for augmented line (</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">) out of range (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="__span-0-1149"><a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>        <span class="p">)</span>
</span><span id="__span-0-1150"><a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>
</span><span id="__span-0-1151"><a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">):</span>
</span><span id="__span-0-1152"><a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-1153"><a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_pos</span><span class="p">)</span>
</span><span id="__span-0-1154"><a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>    <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.rm_aug_line" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">rm_aug_line</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.rm_aug_line" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Remove an augmentation line from the matrix.</p>
<p>Removes the specified position from the matrix's augmentation line tracking.
If the matrix has no augmentation lines tracked or the position is not
currently marked as an augmentation line, the matrix remains unchanged.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This method modifies the matrix's internal <code>_aug_pos</code> attribute which
tracks augmentation line positions. If no <code>_aug_pos</code> attribute exists,
it will be initialized as an empty set.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pos</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The column position of the augmentation line to remove.
If it is not set, all augmentation lines will be removed</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The matrix instance (supports method chaining).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">aug_pos</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">rm_aug_line</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3, 4]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1156"><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="k">def</span><span class="w"> </span><span class="nf">rm_aug_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1157"><a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove an augmentation line from the matrix.</span>
</span><span id="__span-0-1158"><a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
</span><span id="__span-0-1159"><a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">    Removes the specified position from the matrix&#39;s augmentation line tracking.</span>
</span><span id="__span-0-1160"><a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">    If the matrix has no augmentation lines tracked or the position is not</span>
</span><span id="__span-0-1161"><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">    currently marked as an augmentation line, the matrix remains unchanged.</span>
</span><span id="__span-0-1162"><a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>
</span><span id="__span-0-1163"><a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1164"><a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">        This method modifies the matrix&#39;s internal `_aug_pos` attribute which</span>
</span><span id="__span-0-1165"><a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">        tracks augmentation line positions. If no `_aug_pos` attribute exists,</span>
</span><span id="__span-0-1166"><a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">        it will be initialized as an empty set.</span>
</span><span id="__span-0-1167"><a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>
</span><span id="__span-0-1168"><a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1169"><a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">        pos (int, optional): The column position of the augmentation line to remove.</span>
</span><span id="__span-0-1170"><a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">            If it is not set, all augmentation lines will be removed</span>
</span><span id="__span-0-1171"><a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>
</span><span id="__span-0-1172"><a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1173"><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">        (Matrix): The matrix instance (supports method chaining).</span>
</span><span id="__span-0-1174"><a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>
</span><span id="__span-0-1175"><a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1176"><a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]], aug_pos=0)</span>
</span><span id="__span-0-1177"><a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">        &gt;&gt;&gt; mat.rm_aug_line(0)</span>
</span><span id="__span-0-1178"><a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1179"><a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">        [1, 2]</span>
</span><span id="__span-0-1180"><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">        [3, 4]</span>
</span><span id="__span-0-1181"><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><span class="sd">        ])</span>
</span><span id="__span-0-1182"><a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1183"><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1184"><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-1185"><a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="__span-0-1186"><a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="k">if</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="p">:</span>
</span><span id="__span-0-1187"><a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="__span-0-1188"><a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.row_join" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">row_join</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">aug_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.row_join" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Joins two matrices horizontally (column-wise), preserving augmentation lines.</p>
<p>This method concatenates the columns of <code>self</code> and <code>other</code> to form a new matrix. Any augmentation lines
(vertical lines for augmented matrices) tracked in either matrix are preserved and adjusted for the new column positions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>other</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The matrix to join to the right of <code>self</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>aug_line</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, adds an augmentation line between the two matrices.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new matrix formed by joining <code>self</code> and <code>other</code> column-wise, with updated augmentation lines.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.ShapeError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.ShapeError">ShapeError</a></code>
            –
          <div class="doc-md-description">
            <p>If the number of rows in <code>self</code> and <code>other</code> do not match.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1, 2 | 5]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[3, 4 | 6]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1191"><a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="k">def</span><span class="w"> </span><span class="nf">row_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">aug_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1192"><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Joins two matrices horizontally (column-wise), preserving augmentation lines.</span>
</span><span id="__span-0-1193"><a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
</span><span id="__span-0-1194"><a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">    This method concatenates the columns of `self` and `other` to form a new matrix. Any augmentation lines</span>
</span><span id="__span-0-1195"><a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="sd">    (vertical lines for augmented matrices) tracked in either matrix are preserved and adjusted for the new column positions.</span>
</span><span id="__span-0-1196"><a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>
</span><span id="__span-0-1197"><a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">        other (Matrix): The matrix to join to the right of `self`.</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">        aug_line (bool, optional): If `True`, adds an augmentation line between the two matrices.</span>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">        (Matrix): A new matrix formed by joining `self` and `other` column-wise, with updated augmentation lines.</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">        sympy.matrices.exceptions.ShapeError: If the number of rows in `self` and `other` do not match.</span>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">        &gt;&gt;&gt; A = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">        &gt;&gt;&gt; B = Matrix([[5], [6]])</span>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">        &gt;&gt;&gt; A.row_join(B)</span>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">        [1, 2 | 5]</span>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">        [3, 4 | 6]</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">        ])</span>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">):</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">):</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="n">other</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>    <span class="c1"># Iterate over a copy of the set to prevent runtime errors</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_aug_pos</span><span class="p">):</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>    <span class="k">if</span> <span class="n">aug_line</span><span class="p">:</span>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="n">aug_pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.col_join" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">col_join</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.col_join" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Joins two matrices vertically (row-wise), preserving augmentation lines.</p>
<p>This method concatenates the rows of <code>self</code> and <code>other</code> to form a new matrix. Only augmentation lines
(vertical lines for augmented matrices) that are present in both matrices at the same column positions are preserved.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Both <code>self</code> and <code>other</code> matrices should have the same number of columns for the join to be valid.</li>
<li>The method updates the <code>_aug_pos</code> attribute to include only those positions that are common
  in both matrices, ensuring that the augmentation lines are correctly aligned after the join.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>other</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The matrix to join below <code>self</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new matrix formed by joining <code>self</code> and <code>other</code> row-wise, with preserved augmentation lines.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.ShapeError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.ShapeError">ShapeError</a></code>
            –
          <div class="doc-md-description">
            <p>If the number of columns in <code>self</code> and <code>other</code> do not match.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">aug_pos</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">})</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">aug_pos</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">})</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1 | 2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[3 | 4]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1230"><a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="k">def</span><span class="w"> </span><span class="nf">col_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">    Joins two matrices vertically (row-wise), preserving augmentation lines.</span>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">    This method concatenates the rows of `self` and `other` to form a new matrix. Only augmentation lines</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">    (vertical lines for augmented matrices) that are present in both matrices at the same column positions are preserved.</span>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">        - Both `self` and `other` matrices should have the same number of columns for the join to be valid.</span>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">        - The method updates the `_aug_pos` attribute to include only those positions that are common</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">          in both matrices, ensuring that the augmentation lines are correctly aligned after the join.</span>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">        other (Matrix): The matrix to join below `self`.</span>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>
</span><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">        (Matrix): A new matrix formed by joining `self` and `other` row-wise, with preserved augmentation lines.</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">        sympy.matrices.exceptions.ShapeError: If the number of columns in `self` and `other` do not match.</span>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">        &gt;&gt;&gt; A = Matrix([[1, 2]], aug_pos={0})</span>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">        &gt;&gt;&gt; B = Matrix([[3, 4]], aug_pos={0})</span>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">        &gt;&gt;&gt; A.col_join(B)</span>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1256"><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">        [1 | 2]</span>
</span><span id="__span-0-1257"><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">        [3 | 4]</span>
</span><span id="__span-0-1258"><a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">        ])</span>
</span><span id="__span-0-1259"><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1260"><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">):</span>
</span><span id="__span-0-1261"><a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-1262"><a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">):</span>
</span><span id="__span-0-1263"><a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>        <span class="n">other</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-1264"><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
</span><span id="__span-0-1265"><a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>    <span class="n">aug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span> <span class="o">&amp;</span> <span class="n">other</span><span class="o">.</span><span class="n">_aug_pos</span>
</span><span id="__span-0-1266"><a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="n">aug_pos</span><span class="o">=</span><span class="n">aug</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.scale_row" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">scale_row</span><span class="p">(</span><span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="n">Expr</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.scale_row" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Scales a row of the matrix by a scalar and simplifies the result.</p>
<p>This method scales a specified row of the matrix by multiplying it with a scalar
and then simplifies the matrix. The result is stored back in the matrix. Optionally,
the method can print information about the row scaling and display the matrix,
depending on the verbosity level.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The method modifies the matrix in-place and returns the updated matrix.</li>
<li>After scaling the row, the matrix is simplified using <a class="autorefs autorefs-internal" title="            simplify(rational: bool = True, suppress_warnings: bool = False, tolerance: float = 0.0001, simplify: bool = True, expand: bool = True, collect_sym: Symbol | None = None, *args, **kwargs) -> None" href="#ma1522.symbolic.Matrix.simplify"><code>simplify</code></a>.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>idx</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The index of the row to scale (0-based).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalar</code></b>
              (<code>(<a class="autorefs autorefs-external" title="sympy.core.expr.Expr" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.expr.Expr">Expr</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>)
          –
          <div class="doc-md-description">
            <p>The scalar by which to multiply the row.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>The level of verbosity for output.</p>
<ul>
<li>0: No output.</li>
<li>1: Print the row scaling operation.</li>
<li>2: Print the row scaling operation and display the matrix.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The modified matrix with the scaled row.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#IndexError">IndexError</a></code>
            –
          <div class="doc-md-description">
            <p>If the <code>idx</code> is out of range for the number of rows in the matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">scale_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[2, 4]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3, 4]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1268"><a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_row</span><span class="p">(</span>
</span><span id="__span-0-1269"><a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="n">Expr</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-0-1270"><a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1271"><a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1272"><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">    Scales a row of the matrix by a scalar and simplifies the result.</span>
</span><span id="__span-0-1273"><a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
</span><span id="__span-0-1274"><a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">    This method scales a specified row of the matrix by multiplying it with a scalar</span>
</span><span id="__span-0-1275"><a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">    and then simplifies the matrix. The result is stored back in the matrix. Optionally,</span>
</span><span id="__span-0-1276"><a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">    the method can print information about the row scaling and display the matrix,</span>
</span><span id="__span-0-1277"><a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">    depending on the verbosity level.</span>
</span><span id="__span-0-1278"><a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>
</span><span id="__span-0-1279"><a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1280"><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">        - The method modifies the matrix in-place and returns the updated matrix.</span>
</span><span id="__span-0-1281"><a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">        - After scaling the row, the matrix is simplified using [`simplify`][..].</span>
</span><span id="__span-0-1282"><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>
</span><span id="__span-0-1283"><a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1284"><a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">        idx (int): The index of the row to scale (0-based).</span>
</span><span id="__span-0-1285"><a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">        scalar (Expr, float, int): The scalar by which to multiply the row.</span>
</span><span id="__span-0-1286"><a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        verbosity (int, optional): The level of verbosity for output.</span>
</span><span id="__span-0-1287"><a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>
</span><span id="__span-0-1288"><a id="__codelineno-0-1288" name="__codelineno-0-1288"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-1289"><a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">            - 1: Print the row scaling operation.</span>
</span><span id="__span-0-1290"><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">            - 2: Print the row scaling operation and display the matrix.</span>
</span><span id="__span-0-1291"><a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
</span><span id="__span-0-1292"><a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1293"><a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">        (Matrix): The modified matrix with the scaled row.</span>
</span><span id="__span-0-1294"><a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>
</span><span id="__span-0-1295"><a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1296"><a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">        IndexError: If the `idx` is out of range for the number of rows in the matrix.</span>
</span><span id="__span-0-1297"><a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
</span><span id="__span-0-1298"><a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1299"><a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-1300"><a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">        &gt;&gt;&gt; mat.scale_row(0, 2, verbosity=0)</span>
</span><span id="__span-0-1301"><a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1302"><a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">        [2, 4]</span>
</span><span id="__span-0-1303"><a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><span class="sd">        [3, 4]</span>
</span><span id="__span-0-1304"><a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">        ])</span>
</span><span id="__span-0-1305"><a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1306"><a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>
</span><span id="__span-0-1307"><a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>    <span class="k">if</span> <span class="n">scalar</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1308"><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>        <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Matrix rows should not be scaled by 0&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-1309"><a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>
</span><span id="__span-0-1310"><a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>    <span class="n">scalar</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span>
</span><span id="__span-0-1311"><a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>    <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="n">scalar</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1312"><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1313"><a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>
</span><span id="__span-0-1314"><a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-1315"><a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>        <span class="n">display</span><span class="p">(</span>
</span><span id="__span-0-1316"><a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">left(</span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span><span class="si">}</span><span class="se">\\</span><span class="s2">right) R_</span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> </span><span class="se">\\</span><span class="s2">rightarrow R_</span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1317"><a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>            <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">,</span>
</span><span id="__span-0-1318"><a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>        <span class="p">)</span>
</span><span id="__span-0-1319"><a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-1320"><a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1321"><a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-1322"><a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>
</span><span id="__span-0-1323"><a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>    <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.swap_row" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">swap_row</span><span class="p">(</span><span class="n">idx_1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx_2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.swap_row" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Swaps two rows of the matrix.</p>
<p>This method swaps the contents of two rows in the matrix. The operation is performed
in-place, and the modified matrix is returned. Optionally, the method can print
information about the row swap and display the matrix, depending on the verbosity level.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The method modifies the matrix in-place and returns the updated matrix.</li>
<li>After performing the row swaps, the matrix is simplified using <a class="autorefs autorefs-internal" title="            simplify(rational: bool = True, suppress_warnings: bool = False, tolerance: float = 0.0001, simplify: bool = True, expand: bool = True, collect_sym: Symbol | None = None, *args, **kwargs) -> None" href="#ma1522.symbolic.Matrix.simplify"><code>simplify</code></a>.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>idx_1</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The index of the first row to swap (0-based).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>idx_2</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The index of the second row to swap (0-based).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>The level of verbosity for output.</p>
<ul>
<li>0: No output.</li>
<li>1: Print the row swap operation.</li>
<li>2: Print the row swap operation and display the matrix.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The modified matrix after the row swap.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#IndexError">IndexError</a></code>
            –
          <div class="doc-md-description">
            <p>If the <code>idx_1</code> or <code>idx_2</code> is out of range for the number of rows in the matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">swap_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[3, 4]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1, 2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1325"><a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="k">def</span><span class="w"> </span><span class="nf">swap_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx_1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx_2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1326"><a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Swaps two rows of the matrix.</span>
</span><span id="__span-0-1327"><a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
</span><span id="__span-0-1328"><a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">    This method swaps the contents of two rows in the matrix. The operation is performed</span>
</span><span id="__span-0-1329"><a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">    in-place, and the modified matrix is returned. Optionally, the method can print</span>
</span><span id="__span-0-1330"><a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">    information about the row swap and display the matrix, depending on the verbosity level.</span>
</span><span id="__span-0-1331"><a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>
</span><span id="__span-0-1332"><a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1333"><a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">        - The method modifies the matrix in-place and returns the updated matrix.</span>
</span><span id="__span-0-1334"><a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">        - After performing the row swaps, the matrix is simplified using [`simplify`][..].</span>
</span><span id="__span-0-1335"><a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>
</span><span id="__span-0-1336"><a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1337"><a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">        idx_1 (int): The index of the first row to swap (0-based).</span>
</span><span id="__span-0-1338"><a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">        idx_2 (int): The index of the second row to swap (0-based).</span>
</span><span id="__span-0-1339"><a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="sd">        verbosity (int, optional): The level of verbosity for output.</span>
</span><span id="__span-0-1340"><a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>
</span><span id="__span-0-1341"><a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-1342"><a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><span class="sd">            - 1: Print the row swap operation.</span>
</span><span id="__span-0-1343"><a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">            - 2: Print the row swap operation and display the matrix.</span>
</span><span id="__span-0-1344"><a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>
</span><span id="__span-0-1345"><a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1346"><a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">        (Matrix): The modified matrix after the row swap.</span>
</span><span id="__span-0-1347"><a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>
</span><span id="__span-0-1348"><a id="__codelineno-0-1348" name="__codelineno-0-1348"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1349"><a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">        IndexError: If the `idx_1` or `idx_2` is out of range for the number of rows in the matrix.</span>
</span><span id="__span-0-1350"><a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>
</span><span id="__span-0-1351"><a id="__codelineno-0-1351" name="__codelineno-0-1351"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1352"><a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-1353"><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="sd">        &gt;&gt;&gt; mat.swap_row(0, 1, verbosity=0)</span>
</span><span id="__span-0-1354"><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1355"><a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="sd">        [3, 4]</span>
</span><span id="__span-0-1356"><a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">        [1, 2]</span>
</span><span id="__span-0-1357"><a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="sd">        ])</span>
</span><span id="__span-0-1358"><a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1359"><a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>
</span><span id="__span-0-1360"><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>    <span class="bp">self</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="__span-0-1361"><a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>
</span><span id="__span-0-1362"><a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-1363"><a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>        <span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R_</span><span class="si">{</span><span class="n">idx_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> </span><span class="se">\\</span><span class="s2">leftrightarrow R_</span><span class="si">{</span><span class="n">idx_2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">)</span>
</span><span id="__span-0-1364"><a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-1365"><a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1366"><a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-1367"><a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>
</span><span id="__span-0-1368"><a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>    <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.reduce_row" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">reduce_row</span><span class="p">(</span><span class="n">idx_1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="n">Expr</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx_2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.reduce_row" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Reduces a row by subtracting a scalar multiple of another row.</p>
<p>This method modifies a row by subtracting a specified scalar multiple of another row.
The result is stored back in the matrix. Optionally, the method can print information
about the row reduction and display the matrix, depending on the verbosity level.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The method modifies the matrix in-place and returns the updated matrix.</li>
<li>After performing the row reduction, the matrix is simplified using <a class="autorefs autorefs-internal" title="            simplify(rational: bool = True, suppress_warnings: bool = False, tolerance: float = 0.0001, simplify: bool = True, expand: bool = True, collect_sym: Symbol | None = None, *args, **kwargs) -> None" href="#ma1522.symbolic.Matrix.simplify"><code>simplify</code></a>.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>idx_1</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The index of the row to reduce (0-based).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scalar</code></b>
              (<code>(<a class="autorefs autorefs-external" title="sympy.core.expr.Expr" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.expr.Expr">Expr</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>)
          –
          <div class="doc-md-description">
            <p>The scalar by which to multiply the second row.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>idx_2</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The index of the row from which to subtract the scalar multiple (0-based).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>The level of verbosity for output.</p>
<ul>
<li>0: No output.</li>
<li>1: Print the row reduction operation.</li>
<li>2: Print the row reduction operation and display the matrix.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The modified matrix after the row reduction.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#IndexError">IndexError</a></code>
            –
          <div class="doc-md-description">
            <p>If the <code>idx_1</code> or <code>idx_2</code> is out of range for the number of rows in the matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">reduce_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[-5, -6]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[ 3,  4]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1370"><a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce_row</span><span class="p">(</span>
</span><span id="__span-0-1371"><a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">idx_1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="n">Expr</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx_2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-0-1372"><a id="__codelineno-0-1372" name="__codelineno-0-1372"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1373"><a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduces a row by subtracting a scalar multiple of another row.</span>
</span><span id="__span-0-1374"><a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>
</span><span id="__span-0-1375"><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><span class="sd">    This method modifies a row by subtracting a specified scalar multiple of another row.</span>
</span><span id="__span-0-1376"><a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><span class="sd">    The result is stored back in the matrix. Optionally, the method can print information</span>
</span><span id="__span-0-1377"><a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><span class="sd">    about the row reduction and display the matrix, depending on the verbosity level.</span>
</span><span id="__span-0-1378"><a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>
</span><span id="__span-0-1379"><a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1380"><a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">        - The method modifies the matrix in-place and returns the updated matrix.</span>
</span><span id="__span-0-1381"><a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">        - After performing the row reduction, the matrix is simplified using [`simplify`][..].</span>
</span><span id="__span-0-1382"><a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
</span><span id="__span-0-1383"><a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1384"><a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">        idx_1 (int): The index of the row to reduce (0-based).</span>
</span><span id="__span-0-1385"><a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">        scalar (Expr, float, int): The scalar by which to multiply the second row.</span>
</span><span id="__span-0-1386"><a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">        idx_2 (int): The index of the row from which to subtract the scalar multiple (0-based).</span>
</span><span id="__span-0-1387"><a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">        verbosity (int, optional): The level of verbosity for output.</span>
</span><span id="__span-0-1388"><a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>
</span><span id="__span-0-1389"><a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-1390"><a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><span class="sd">            - 1: Print the row reduction operation.</span>
</span><span id="__span-0-1391"><a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">            - 2: Print the row reduction operation and display the matrix.</span>
</span><span id="__span-0-1392"><a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>
</span><span id="__span-0-1393"><a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1394"><a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><span class="sd">        (Matrix): The modified matrix after the row reduction.</span>
</span><span id="__span-0-1395"><a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>
</span><span id="__span-0-1396"><a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1397"><a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">        IndexError: If the `idx_1` or `idx_2` is out of range for the number of rows in the matrix.</span>
</span><span id="__span-0-1398"><a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>
</span><span id="__span-0-1399"><a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1400"><a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-1401"><a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">        &gt;&gt;&gt; mat.reduce_row(0, 2, 1, verbosity=0)</span>
</span><span id="__span-0-1402"><a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1403"><a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><span class="sd">        [-5, -6]</span>
</span><span id="__span-0-1404"><a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><span class="sd">        [ 3,  4]</span>
</span><span id="__span-0-1405"><a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><span class="sd">        ])</span>
</span><span id="__span-0-1406"><a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1407"><a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>
</span><span id="__span-0-1408"><a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>    <span class="n">scalar</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span>
</span><span id="__span-0-1409"><a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>    <span class="bp">self</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx_1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">scalar</span> <span class="o">*</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx_2</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1410"><a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1411"><a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>
</span><span id="__span-0-1412"><a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-1413"><a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>        <span class="n">display</span><span class="p">(</span>
</span><span id="__span-0-1414"><a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>            <span class="sa">f</span><span class="s2">&quot;R_</span><span class="si">{</span><span class="n">idx_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> - </span><span class="se">\\</span><span class="s2">left(</span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span><span class="si">}</span><span class="se">\\</span><span class="s2">right)R_</span><span class="si">{</span><span class="n">idx_2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> </span><span class="se">\\</span><span class="s2">rightarrow R_</span><span class="si">{</span><span class="n">idx_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1415"><a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>            <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">,</span>
</span><span id="__span-0-1416"><a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>        <span class="p">)</span>
</span><span id="__span-0-1417"><a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-1418"><a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-1419"><a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-1420"><a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>
</span><span id="__span-0-1421"><a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>    <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.get_pivot_row" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_pivot_row</span><span class="p">(</span><span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">row_start_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">follow_GE</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span></code>

<a href="#ma1522.symbolic.Matrix.get_pivot_row" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Finds the row index of the pivot element in a given column.</p>
<p>This method attempts to find a row that contains a non-zero element in the
specified column. If the <code>follow_GE</code> flag is <code>False</code>, it first looks for
a non-zero constant that does not contain any symbolic expressions. If no
such element is found, it will return the first non-zero element. If the
entire column contains only zeros, the method returns -1.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>col_idx</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The index of the column to search for the pivot.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>row_start_idx</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The row index to start searching from.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>follow_GE</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Flag to control whether to follow Gaussian elimination strategy.</p>
<ul>
<li><code>True</code>: Always return the first non-zero element, even if it is symbolic.</li>
<li><code>False</code>: First look for non-zero constants that are not symbolic expressions.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          –
          <div class="doc-md-description">
            <p>The index of the row containing the pivot element, or None if no pivot is found.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">get_pivot_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">0</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1423"><a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_pivot_row</span><span class="p">(</span>
</span><span id="__span-0-1424"><a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">row_start_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">follow_GE</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-1425"><a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1426"><a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the row index of the pivot element in a given column.</span>
</span><span id="__span-0-1427"><a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>
</span><span id="__span-0-1428"><a id="__codelineno-0-1428" name="__codelineno-0-1428"></a><span class="sd">    This method attempts to find a row that contains a non-zero element in the</span>
</span><span id="__span-0-1429"><a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="sd">    specified column. If the `follow_GE` flag is `False`, it first looks for</span>
</span><span id="__span-0-1430"><a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="sd">    a non-zero constant that does not contain any symbolic expressions. If no</span>
</span><span id="__span-0-1431"><a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><span class="sd">    such element is found, it will return the first non-zero element. If the</span>
</span><span id="__span-0-1432"><a id="__codelineno-0-1432" name="__codelineno-0-1432"></a><span class="sd">    entire column contains only zeros, the method returns -1.</span>
</span><span id="__span-0-1433"><a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>
</span><span id="__span-0-1434"><a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1435"><a id="__codelineno-0-1435" name="__codelineno-0-1435"></a><span class="sd">        col_idx (int): The index of the column to search for the pivot.</span>
</span><span id="__span-0-1436"><a id="__codelineno-0-1436" name="__codelineno-0-1436"></a><span class="sd">        row_start_idx (int): The row index to start searching from.</span>
</span><span id="__span-0-1437"><a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="sd">        follow_GE (bool, optional): Flag to control whether to follow Gaussian elimination strategy.</span>
</span><span id="__span-0-1438"><a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>
</span><span id="__span-0-1439"><a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">            - `True`: Always return the first non-zero element, even if it is symbolic.</span>
</span><span id="__span-0-1440"><a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="sd">            - `False`: First look for non-zero constants that are not symbolic expressions.</span>
</span><span id="__span-0-1441"><a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>
</span><span id="__span-0-1442"><a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1443"><a id="__codelineno-0-1443" name="__codelineno-0-1443"></a><span class="sd">        (int): The index of the row containing the pivot element, or None if no pivot is found.</span>
</span><span id="__span-0-1444"><a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>
</span><span id="__span-0-1445"><a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1446"><a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2, 3], [4, 5, 6], [0, 0, 0]])</span>
</span><span id="__span-0-1447"><a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><span class="sd">        &gt;&gt;&gt; mat.get_pivot_row(0, 0)</span>
</span><span id="__span-0-1448"><a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><span class="sd">        0</span>
</span><span id="__span-0-1449"><a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1450"><a id="__codelineno-0-1450" name="__codelineno-0-1450"></a>
</span><span id="__span-0-1451"><a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>    <span class="c1"># Step 1: Search for a non-zero constant that is not symbolic (if not following Gaussian elimination)</span>
</span><span id="__span-0-1452"><a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>    <span class="c1"># that it is easier to reduce other rows</span>
</span><span id="__span-0-1453"><a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">follow_GE</span><span class="p">:</span>
</span><span id="__span-0-1454"><a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>        <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">row_start_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
</span><span id="__span-0-1455"><a id="__codelineno-0-1455" name="__codelineno-0-1455"></a>            <span class="n">term</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">]</span>
</span><span id="__span-0-1456"><a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>            <span class="k">if</span> <span class="n">term</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1457"><a id="__codelineno-0-1457" name="__codelineno-0-1457"></a>                <span class="c1"># Check if it&#39;s not a symbolic expression</span>
</span><span id="__span-0-1458"><a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">Expr</span><span class="p">):</span>
</span><span id="__span-0-1459"><a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>                    <span class="k">return</span> <span class="n">row_idx</span>
</span><span id="__span-0-1460"><a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>                <span class="c1"># Check if it&#39;s a non-symbolic constant</span>
</span><span id="__span-0-1461"><a id="__codelineno-0-1461" name="__codelineno-0-1461"></a>                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1462"><a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>                    <span class="k">return</span> <span class="n">row_idx</span>
</span><span id="__span-0-1463"><a id="__codelineno-0-1463" name="__codelineno-0-1463"></a>
</span><span id="__span-0-1464"><a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>    <span class="c1"># Step 2: If no non-zero constant is found, return the first non-zero element (symbolic or not)</span>
</span><span id="__span-0-1465"><a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>    <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">row_start_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
</span><span id="__span-0-1466"><a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>        <span class="n">term</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">]</span>
</span><span id="__span-0-1467"><a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>        <span class="k">if</span> <span class="n">term</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1468"><a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>            <span class="k">return</span> <span class="n">row_idx</span>
</span><span id="__span-0-1469"><a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>
</span><span id="__span-0-1470"><a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>    <span class="c1"># Step 3: If no non-zero element is found, return None (indicating no pivot)</span>
</span><span id="__span-0-1471"><a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>    <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.get_pivot_pos" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_pivot_pos</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span></code>

<a href="#ma1522.symbolic.Matrix.get_pivot_pos" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Finds the positions of the pivot elements in the matrix.</p>
<p>This method checks the matrix to determine the positions of the pivots
(the first non-zero entry in each row) by examining each column one-by-one.
It assumes that the matrix is in Row Echelon Form (REF), as checked by the
<a class="autorefs autorefs-internal" title="            is_echelon

  
      property
  " href="../inherited/#ma1522.symbolic.Matrix.is_echelon"><code>is_echelon</code></a> property.</p>
<p>It uses <a class="autorefs autorefs-internal" title="            get_pivot_row(col_idx: int, row_start_idx: int, follow_GE: bool = False) -> int | None" href="#ma1522.symbolic.Matrix.get_pivot_row"><code>get_pivot_row</code></a> to find the pivot row for each column.
For each pivot found, a tuple (row, column) is added to the result list.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]]</code>
          –
          <div class="doc-md-description">
            <p>A list of lists, where each sublist contains a
tuple representing the position (row, column) of a pivot.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">get_pivot_pos</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[(0, 0), (1, 2)]</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1473"><a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_pivot_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
</span><span id="__span-0-1474"><a id="__codelineno-0-1474" name="__codelineno-0-1474"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the positions of the pivot elements in the matrix.</span>
</span><span id="__span-0-1475"><a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>
</span><span id="__span-0-1476"><a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><span class="sd">    This method checks the matrix to determine the positions of the pivots</span>
</span><span id="__span-0-1477"><a id="__codelineno-0-1477" name="__codelineno-0-1477"></a><span class="sd">    (the first non-zero entry in each row) by examining each column one-by-one.</span>
</span><span id="__span-0-1478"><a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><span class="sd">    It assumes that the matrix is in Row Echelon Form (REF), as checked by the</span>
</span><span id="__span-0-1479"><a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><span class="sd">    [`is_echelon`][sympy.matrices.matrixbase.MatrixBase.is_echelon] property.</span>
</span><span id="__span-0-1480"><a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>
</span><span id="__span-0-1481"><a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><span class="sd">    It uses [`get_pivot_row`][..] to find the pivot row for each column.</span>
</span><span id="__span-0-1482"><a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><span class="sd">    For each pivot found, a tuple (row, column) is added to the result list.</span>
</span><span id="__span-0-1483"><a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>
</span><span id="__span-0-1484"><a id="__codelineno-0-1484" name="__codelineno-0-1484"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1485"><a id="__codelineno-0-1485" name="__codelineno-0-1485"></a><span class="sd">        (list[tuple[int, int]]): A list of lists, where each sublist contains a</span>
</span><span id="__span-0-1486"><a id="__codelineno-0-1486" name="__codelineno-0-1486"></a><span class="sd">            tuple representing the position (row, column) of a pivot.</span>
</span><span id="__span-0-1487"><a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>
</span><span id="__span-0-1488"><a id="__codelineno-0-1488" name="__codelineno-0-1488"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1489"><a id="__codelineno-0-1489" name="__codelineno-0-1489"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2, 3], [0, 0, 5], [0, 0, 0]])</span>
</span><span id="__span-0-1490"><a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><span class="sd">        &gt;&gt;&gt; mat.get_pivot_pos()</span>
</span><span id="__span-0-1491"><a id="__codelineno-0-1491" name="__codelineno-0-1491"></a><span class="sd">        [(0, 0), (1, 2)]</span>
</span><span id="__span-0-1492"><a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1493"><a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>
</span><span id="__span-0-1494"><a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_echelon</span>  <span class="c1"># check for REF</span>
</span><span id="__span-0-1495"><a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>
</span><span id="__span-0-1496"><a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>    <span class="n">pivot_pos</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-1497"><a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>    <span class="n">cur_row_pos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-1498"><a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>    <span class="k">for</span> <span class="n">cur_col_pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
</span><span id="__span-0-1499"><a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>        <span class="n">pivot_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pivot_row</span><span class="p">(</span><span class="n">cur_col_pos</span><span class="p">,</span> <span class="n">cur_row_pos</span><span class="p">,</span> <span class="n">follow_GE</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-1500"><a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>
</span><span id="__span-0-1501"><a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>        <span class="k">if</span> <span class="n">pivot_row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1502"><a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>            <span class="n">pivot_pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pivot_row</span><span class="p">,</span> <span class="n">cur_col_pos</span><span class="p">))</span>
</span><span id="__span-0-1503"><a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>            <span class="n">cur_row_pos</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-1504"><a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>
</span><span id="__span-0-1505"><a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>    <span class="k">return</span> <span class="n">pivot_pos</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.get_pivot_elements" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_pivot_elements</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Expr</span><span class="p">]</span></code>

<a href="#ma1522.symbolic.Matrix.get_pivot_elements" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieves the pivot elements from the matrix.</p>
<p>This method identifies the pivot positions (row, column) using the
<a class="autorefs autorefs-internal" title="            get_pivot_pos() -> list[tuple[int, int]]" href="#ma1522.symbolic.Matrix.get_pivot_pos"><code>get_pivot_pos</code></a> method and
then extracts the elements at those positions in the matrix.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" title="sympy.core.expr.Expr" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.expr.Expr">Expr</a>]</code>
          –
          <div class="doc-md-description">
            <p>A list of pivot elements corresponding
to the positions identified by <a class="autorefs autorefs-internal" title="            get_pivot_pos() -> list[tuple[int, int]]" href="#ma1522.symbolic.Matrix.get_pivot_pos"><code>get_pivot_pos</code></a>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">get_pivot_elements</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[1, 5]</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1507"><a id="__codelineno-0-1507" name="__codelineno-0-1507"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_pivot_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Expr</span><span class="p">]:</span>
</span><span id="__span-0-1508"><a id="__codelineno-0-1508" name="__codelineno-0-1508"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves the pivot elements from the matrix.</span>
</span><span id="__span-0-1509"><a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>
</span><span id="__span-0-1510"><a id="__codelineno-0-1510" name="__codelineno-0-1510"></a><span class="sd">    This method identifies the pivot positions (row, column) using the</span>
</span><span id="__span-0-1511"><a id="__codelineno-0-1511" name="__codelineno-0-1511"></a><span class="sd">    [`get_pivot_pos`][..] method and</span>
</span><span id="__span-0-1512"><a id="__codelineno-0-1512" name="__codelineno-0-1512"></a><span class="sd">    then extracts the elements at those positions in the matrix.</span>
</span><span id="__span-0-1513"><a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>
</span><span id="__span-0-1514"><a id="__codelineno-0-1514" name="__codelineno-0-1514"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1515"><a id="__codelineno-0-1515" name="__codelineno-0-1515"></a><span class="sd">        (list[Expr]): A list of pivot elements corresponding</span>
</span><span id="__span-0-1516"><a id="__codelineno-0-1516" name="__codelineno-0-1516"></a><span class="sd">            to the positions identified by [`get_pivot_pos`][..].</span>
</span><span id="__span-0-1517"><a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>
</span><span id="__span-0-1518"><a id="__codelineno-0-1518" name="__codelineno-0-1518"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1519"><a id="__codelineno-0-1519" name="__codelineno-0-1519"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2, 3], [0, 0, 5], [0, 0, 0]])</span>
</span><span id="__span-0-1520"><a id="__codelineno-0-1520" name="__codelineno-0-1520"></a><span class="sd">        &gt;&gt;&gt; mat.get_pivot_elements()</span>
</span><span id="__span-0-1521"><a id="__codelineno-0-1521" name="__codelineno-0-1521"></a><span class="sd">        [1, 5]</span>
</span><span id="__span-0-1522"><a id="__codelineno-0-1522" name="__codelineno-0-1522"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1523"><a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>
</span><span id="__span-0-1524"><a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>    <span class="n">pivot_elements</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Expr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-1525"><a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>
</span><span id="__span-0-1526"><a id="__codelineno-0-1526" name="__codelineno-0-1526"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pivot_pos</span><span class="p">():</span>
</span><span id="__span-0-1527"><a id="__codelineno-0-1527" name="__codelineno-0-1527"></a>        <span class="n">pivot_elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1528"><a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>
</span><span id="__span-0-1529"><a id="__codelineno-0-1529" name="__codelineno-0-1529"></a>    <span class="k">return</span> <span class="n">pivot_elements</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.ref" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">ref</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_tries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">follow_GE</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PLU</span></code>

<a href="#ma1522.symbolic.Matrix.ref" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Find the Row Echelon Form (REF) of the matrix.</p>
<p>This method applies Gaussian elimination (or a similar approach) to bring
the matrix to row echelon form.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>PLU decomposition is the generalisation of the LU decomposition. Unlike
    LU decomposition, PLU works for any matrix.</li>
<li>The REF is obtained from <code>PLU.U</code> and the matrix is LU factorisable if <code>PLU.P</code>
    is the identity matrix.
-</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for the output.</p>
<ul>
<li>0: No output.</li>
<li>1: Output basic information (e.g., row operations).</li>
<li>2: Output detailed information (e.g., matrix states after each operation).</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_tries</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum number of tries to reduce a row in case of symbolic denominators.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>follow_GE</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to strictly follow Gaussian elimination rules.</p>
<ul>
<li><code>True</code>: Always return the first non-zero element, even if it is symbolic.</li>
<li><code>False</code>: First look for non-zero constants that are not symbolic expressions.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              PLU(P: Matrix, L: Matrix, U: Matrix)

  
      dataclass
   (ma1522.custom_types.PLU)" href="../custom_types/#ma1522.custom_types.PLU">PLU</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing the following matrices:</p>
<ul>
<li><code>P</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The permutation matrix used during the transformation.</li>
<li><code>L</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The lower triangular matrix representing the multipliers used in the elimination process.</li>
<li><code>U</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The upper triangular matrix in row echelon form.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">PLU(P=Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 0, 0]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0, 1, 0]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[0, 0, 1]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">]), L=Matrix([</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[1, 0, 0]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">[4, 1, 0]</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="go">[7, 2, 1]</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="go">]), U=Matrix([</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="go">[1,  2,  3]</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="go">[0, -3, -6]</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="go">[0,  0,  0]</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            LUdecomposition(iszerofunc=_iszero, simpfunc=None, rankcheck=False)" href="../inherited/#ma1522.symbolic.Matrix.LUdecomposition"><code>Matrix.LUdecomposition</code></a></li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1531"><a id="__codelineno-0-1531" name="__codelineno-0-1531"></a><span class="k">def</span><span class="w"> </span><span class="nf">ref</span><span class="p">(</span>
</span><span id="__span-0-1532"><a id="__codelineno-0-1532" name="__codelineno-0-1532"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1533"><a id="__codelineno-0-1533" name="__codelineno-0-1533"></a>    <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-1534"><a id="__codelineno-0-1534" name="__codelineno-0-1534"></a>    <span class="n">max_tries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-1535"><a id="__codelineno-0-1535" name="__codelineno-0-1535"></a>    <span class="n">follow_GE</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-1536"><a id="__codelineno-0-1536" name="__codelineno-0-1536"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PLU</span><span class="p">:</span>
</span><span id="__span-0-1537"><a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the Row Echelon Form (REF) of the matrix.</span>
</span><span id="__span-0-1538"><a id="__codelineno-0-1538" name="__codelineno-0-1538"></a>
</span><span id="__span-0-1539"><a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><span class="sd">    This method applies Gaussian elimination (or a similar approach) to bring</span>
</span><span id="__span-0-1540"><a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="sd">    the matrix to row echelon form.</span>
</span><span id="__span-0-1541"><a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>
</span><span id="__span-0-1542"><a id="__codelineno-0-1542" name="__codelineno-0-1542"></a><span class="sd">    Note:</span>
</span><span id="__span-0-1543"><a id="__codelineno-0-1543" name="__codelineno-0-1543"></a><span class="sd">        - PLU decomposition is the generalisation of the LU decomposition. Unlike</span>
</span><span id="__span-0-1544"><a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><span class="sd">            LU decomposition, PLU works for any matrix.</span>
</span><span id="__span-0-1545"><a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><span class="sd">        - The REF is obtained from `PLU.U` and the matrix is LU factorisable if `PLU.P`</span>
</span><span id="__span-0-1546"><a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><span class="sd">            is the identity matrix.</span>
</span><span id="__span-0-1547"><a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">        -</span>
</span><span id="__span-0-1548"><a id="__codelineno-0-1548" name="__codelineno-0-1548"></a>
</span><span id="__span-0-1549"><a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1550"><a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">        verbosity (int, optional): Level of verbosity for the output.</span>
</span><span id="__span-0-1551"><a id="__codelineno-0-1551" name="__codelineno-0-1551"></a>
</span><span id="__span-0-1552"><a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-1553"><a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="sd">            - 1: Output basic information (e.g., row operations).</span>
</span><span id="__span-0-1554"><a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">            - 2: Output detailed information (e.g., matrix states after each operation).</span>
</span><span id="__span-0-1555"><a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">        max_tries (int, optional): Maximum number of tries to reduce a row in case of symbolic denominators.</span>
</span><span id="__span-0-1556"><a id="__codelineno-0-1556" name="__codelineno-0-1556"></a><span class="sd">        follow_GE (bool, optional): Whether to strictly follow Gaussian elimination rules.</span>
</span><span id="__span-0-1557"><a id="__codelineno-0-1557" name="__codelineno-0-1557"></a>
</span><span id="__span-0-1558"><a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">            - `True`: Always return the first non-zero element, even if it is symbolic.</span>
</span><span id="__span-0-1559"><a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">            - `False`: First look for non-zero constants that are not symbolic expressions.</span>
</span><span id="__span-0-1560"><a id="__codelineno-0-1560" name="__codelineno-0-1560"></a>
</span><span id="__span-0-1561"><a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1562"><a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><span class="sd">        (PLU): A dataclass containing the following matrices:</span>
</span><span id="__span-0-1563"><a id="__codelineno-0-1563" name="__codelineno-0-1563"></a>
</span><span id="__span-0-1564"><a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">            - `P` ([`Matrix`][...]): The permutation matrix used during the transformation.</span>
</span><span id="__span-0-1565"><a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">            - `L` ([`Matrix`][...]): The lower triangular matrix representing the multipliers used in the elimination process.</span>
</span><span id="__span-0-1566"><a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><span class="sd">            - `U` ([`Matrix`][...]): The upper triangular matrix in row echelon form.</span>
</span><span id="__span-0-1567"><a id="__codelineno-0-1567" name="__codelineno-0-1567"></a>
</span><span id="__span-0-1568"><a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1569"><a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
</span><span id="__span-0-1570"><a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">        &gt;&gt;&gt; mat.ref(verbosity=0)</span>
</span><span id="__span-0-1571"><a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">        PLU(P=Matrix([</span>
</span><span id="__span-0-1572"><a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="sd">        [1, 0, 0]</span>
</span><span id="__span-0-1573"><a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">        [0, 1, 0]</span>
</span><span id="__span-0-1574"><a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">        [0, 0, 1]</span>
</span><span id="__span-0-1575"><a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">        ]), L=Matrix([</span>
</span><span id="__span-0-1576"><a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">        [1, 0, 0]</span>
</span><span id="__span-0-1577"><a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">        [4, 1, 0]</span>
</span><span id="__span-0-1578"><a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">        [7, 2, 1]</span>
</span><span id="__span-0-1579"><a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">        ]), U=Matrix([</span>
</span><span id="__span-0-1580"><a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">        [1,  2,  3]</span>
</span><span id="__span-0-1581"><a id="__codelineno-0-1581" name="__codelineno-0-1581"></a><span class="sd">        [0, -3, -6]</span>
</span><span id="__span-0-1582"><a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><span class="sd">        [0,  0,  0]</span>
</span><span id="__span-0-1583"><a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><span class="sd">        ]))</span>
</span><span id="__span-0-1584"><a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>
</span><span id="__span-0-1585"><a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-1586"><a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><span class="sd">        - [`Matrix.LUdecomposition`][sympy.matrices.matrixbase.MatrixBase.LUdecomposition]</span>
</span><span id="__span-0-1587"><a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1588"><a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>
</span><span id="__span-0-1589"><a id="__codelineno-0-1589" name="__codelineno-0-1589"></a>    <span class="n">U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-0-1590"><a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>
</span><span id="__span-0-1591"><a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>    <span class="n">I</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span>
</span><span id="__span-0-1592"><a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>    <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span>
</span><span id="__span-0-1593"><a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>    <span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span>
</span><span id="__span-0-1594"><a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>
</span><span id="__span-0-1595"><a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>    <span class="c1"># Loop over each column</span>
</span><span id="__span-0-1596"><a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>    <span class="n">cur_row_pos</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-1597"><a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>
</span><span id="__span-0-1598"><a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>    <span class="k">for</span> <span class="n">cur_col_pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
</span><span id="__span-0-1599"><a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>        <span class="c1"># Find the first non-zero row in the current column</span>
</span><span id="__span-0-1600"><a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>        <span class="n">pivot_row</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">get_pivot_row</span><span class="p">(</span><span class="n">cur_col_pos</span><span class="p">,</span> <span class="n">cur_row_pos</span><span class="p">,</span> <span class="n">follow_GE</span><span class="p">)</span>
</span><span id="__span-0-1601"><a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>
</span><span id="__span-0-1602"><a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>        <span class="k">if</span> <span class="n">pivot_row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1603"><a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>            <span class="c1"># If no non-zero pivot is found, continue to the next column</span>
</span><span id="__span-0-1604"><a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>            <span class="k">continue</span>
</span><span id="__span-0-1605"><a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>
</span><span id="__span-0-1606"><a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>        <span class="c1"># Swap the current row with the pivot row if necessary</span>
</span><span id="__span-0-1607"><a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>        <span class="k">if</span> <span class="n">pivot_row</span> <span class="o">!=</span> <span class="n">cur_row_pos</span><span class="p">:</span>
</span><span id="__span-0-1608"><a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>            <span class="n">U</span><span class="o">.</span><span class="n">swap_row</span><span class="p">(</span><span class="n">cur_row_pos</span><span class="p">,</span> <span class="n">pivot_row</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</span><span id="__span-0-1609"><a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>            <span class="n">P_elem</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">swap_row</span><span class="p">(</span><span class="n">cur_row_pos</span><span class="p">,</span> <span class="n">pivot_row</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-1610"><a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>            <span class="n">P</span> <span class="o">=</span> <span class="n">P</span> <span class="o">@</span> <span class="n">P_elem</span>
</span><span id="__span-0-1611"><a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>            <span class="n">L</span> <span class="o">=</span> <span class="n">P_elem</span> <span class="o">@</span> <span class="n">L</span> <span class="o">@</span> <span class="n">P_elem</span>
</span><span id="__span-0-1612"><a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>
</span><span id="__span-0-1613"><a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>        <span class="c1"># Eliminate the current column in rest of the rows below</span>
</span><span id="__span-0-1614"><a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>        <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cur_row_pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
</span><span id="__span-0-1615"><a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>            <span class="c1"># reduce the row_idx iteratively via partial fractions to</span>
</span><span id="__span-0-1616"><a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>            <span class="c1"># prevent division by a possible 0 term</span>
</span><span id="__span-0-1617"><a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>            <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-0-1618"><a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>            <span class="k">while</span> <span class="n">U</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">cur_col_pos</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1619"><a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>                <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-1620"><a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>                <span class="k">if</span> <span class="n">tries</span> <span class="o">&gt;</span> <span class="n">max_tries</span><span class="p">:</span>
</span><span id="__span-0-1621"><a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>                    <span class="n">warn</span><span class="p">(</span>
</span><span id="__span-0-1622"><a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>                        <span class="sa">f</span><span class="s2">&quot;ERROR: Max tries exceeded to reduce row </span><span class="si">{</span><span class="n">row_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> with row </span><span class="si">{</span><span class="n">cur_row_pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-1623"><a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>                        <span class="ne">RuntimeWarning</span><span class="p">,</span>
</span><span id="__span-0-1624"><a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>                        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-1625"><a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>                    <span class="p">)</span>
</span><span id="__span-0-1626"><a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>                    <span class="k">break</span>
</span><span id="__span-0-1627"><a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1628"><a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>                    <span class="n">scalar</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">cur_col_pos</span><span class="p">]</span> <span class="o">/</span> <span class="n">U</span><span class="p">[</span><span class="n">cur_row_pos</span><span class="p">,</span> <span class="n">cur_col_pos</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1629"><a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>                    <span class="n">scalar</span> <span class="o">=</span> <span class="n">scalar</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</span><span id="__span-0-1630"><a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>
</span><span id="__span-0-1631"><a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-1632"><a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>                        <span class="n">decomp</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">apart</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span>  <span class="c1"># partial fractions</span>
</span><span id="__span-0-1633"><a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-1634"><a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>                        <span class="n">decomp</span> <span class="o">=</span> <span class="n">scalar</span>
</span><span id="__span-0-1635"><a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decomp</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">Add</span><span class="p">):</span>
</span><span id="__span-0-1636"><a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>                        <span class="n">terms</span> <span class="o">=</span> <span class="n">decomp</span><span class="o">.</span><span class="n">args</span>
</span><span id="__span-0-1637"><a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1638"><a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>                        <span class="c1"># there is only 1 term (could be integer or proper fraction)</span>
</span><span id="__span-0-1639"><a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>                        <span class="n">terms</span> <span class="o">=</span> <span class="p">[</span><span class="n">decomp</span><span class="p">]</span>
</span><span id="__span-0-1640"><a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>
</span><span id="__span-0-1641"><a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>                    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="__span-0-1642"><a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>                        <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">fraction</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
</span><span id="__span-0-1643"><a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>
</span><span id="__span-0-1644"><a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>                        <span class="c1"># ensure denominator is non-zero so that reduction is valid</span>
</span><span id="__span-0-1645"><a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_zero</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
</span><span id="__span-0-1646"><a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>                            <span class="n">U</span><span class="o">.</span><span class="n">reduce_row</span><span class="p">(</span>
</span><span id="__span-0-1647"><a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>                                <span class="n">row_idx</span><span class="p">,</span>
</span><span id="__span-0-1648"><a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>                                <span class="n">term</span><span class="p">,</span>
</span><span id="__span-0-1649"><a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>                                <span class="n">cur_row_pos</span><span class="p">,</span>
</span><span id="__span-0-1650"><a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>                                <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1651"><a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>                            <span class="p">)</span>
</span><span id="__span-0-1652"><a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>                            <span class="n">elem</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_row</span><span class="p">(</span>
</span><span id="__span-0-1653"><a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>                                <span class="n">row_idx</span><span class="p">,</span> <span class="o">-</span><span class="n">term</span><span class="p">,</span> <span class="n">cur_row_pos</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span>
</span><span id="__span-0-1654"><a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>                            <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1655"><a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>                            <span class="n">L</span> <span class="o">=</span> <span class="n">L</span> <span class="o">@</span> <span class="n">elem</span>
</span><span id="__span-0-1656"><a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>
</span><span id="__span-0-1657"><a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>                    <span class="c1"># Cases where pivot row contains symbols such that scalar is a</span>
</span><span id="__span-0-1658"><a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>                    <span class="c1"># fraction with symbolic denominator.</span>
</span><span id="__span-0-1659"><a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>                    <span class="c1"># To reduce further, can only scale row_idx accordingly</span>
</span><span id="__span-0-1660"><a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>                    <span class="k">if</span> <span class="n">U</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">cur_col_pos</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1661"><a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>                        <span class="n">scalar</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-1662"><a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>                            <span class="n">U</span><span class="p">[</span><span class="n">cur_row_pos</span><span class="p">,</span> <span class="n">cur_col_pos</span><span class="p">]</span> <span class="o">/</span> <span class="n">U</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">cur_col_pos</span><span class="p">]</span>
</span><span id="__span-0-1663"><a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>                        <span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1664"><a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>                        <span class="n">tmp</span> <span class="o">=</span> <span class="n">scalar</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</span><span id="__span-0-1665"><a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>                        <span class="k">if</span> <span class="n">tmp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1666"><a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>                            <span class="n">scalar</span> <span class="o">=</span> <span class="n">tmp</span>
</span><span id="__span-0-1667"><a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>                        <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">fraction</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span>
</span><span id="__span-0-1668"><a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>                        <span class="c1"># to scale by n, n cannot be 0 both numerically or symbolically</span>
</span><span id="__span-0-1669"><a id="__codelineno-0-1669" name="__codelineno-0-1669"></a>                        <span class="c1"># to scale by 1/d, d cannot be 0, same argument as n</span>
</span><span id="__span-0-1670"><a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>                        <span class="c1"># if (n != 0) and (not _is_zero(d)):</span>
</span><span id="__span-0-1671"><a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>                        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">_is_zero</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">_is_zero</span><span class="p">(</span><span class="n">d</span><span class="p">)):</span>
</span><span id="__span-0-1672"><a id="__codelineno-0-1672" name="__codelineno-0-1672"></a>                            <span class="n">U</span><span class="o">.</span><span class="n">scale_row</span><span class="p">(</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">scalar</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</span><span id="__span-0-1673"><a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>                            <span class="n">elem</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">scale_row</span><span class="p">(</span>
</span><span id="__span-0-1674"><a id="__codelineno-0-1674" name="__codelineno-0-1674"></a>                                <span class="n">row_idx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">scalar</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span>
</span><span id="__span-0-1675"><a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>                            <span class="p">)</span>
</span><span id="__span-0-1676"><a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>                            <span class="n">L</span> <span class="o">=</span> <span class="n">L</span> <span class="o">@</span> <span class="n">elem</span>
</span><span id="__span-0-1677"><a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>
</span><span id="__span-0-1678"><a id="__codelineno-0-1678" name="__codelineno-0-1678"></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
</span><span id="__span-0-1679"><a id="__codelineno-0-1679" name="__codelineno-0-1679"></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception encountered: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-1680"><a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>                    <span class="k">return</span> <span class="n">PLU</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span>
</span><span id="__span-0-1681"><a id="__codelineno-0-1681" name="__codelineno-0-1681"></a>        <span class="n">cur_row_pos</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-0-1682"><a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>
</span><span id="__span-0-1683"><a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>    <span class="c1"># Return the appropriate number of matrices based on the `matrices` parameter</span>
</span><span id="__span-0-1684"><a id="__codelineno-0-1684" name="__codelineno-0-1684"></a>    <span class="k">return</span> <span class="n">PLU</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.evaluate_cases" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">evaluate_cases</span><span class="p">(</span><span class="n">rhs</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">use_ref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

<a href="#ma1522.symbolic.Matrix.evaluate_cases" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Evaluates and displays all possible cases for solutions to a linear system involving the matrix.</p>
<p>This method analyzes the determinant of the matrix (or its Gram matrix if not square) to identify
all possible cases for the values of free variables that affect the existence or uniqueness of solutions.
For each case, it substitutes the corresponding values into the system and displays the resulting solution(s).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rhs</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The right-hand side matrix of the system. If not provided, it treats the system
as homogeneous (i.e., <code>Ax = 0</code>).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>use_ref</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to use the row echelon form (REF) for case analysis. Defaults to True.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>None</code>
          –
          <div class="doc-md-description">
            <p>None</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span>
<span class="normal"><a href="#__codelineno-0-8">8</a></span>
<span class="normal"><a href="#__codelineno-0-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">evaluate_cases</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Case 1: {}, not including [{x: 0}]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">Unique solution</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">RREF(rref=Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">    [x, 1 | 2]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">    [0, 1 | 3]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">]), pivots=(0, 1))</span>
</span></code></pre></div></td></tr></table></div>
    <p>Case 2: {x: 0}, not including []
No solution
RREF(rref=Matrix([
    [0, 1 | 2]
    [0, 0 | 1]
]), pivots=(1, 2))</p>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1711"><a id="__codelineno-0-1711" name="__codelineno-0-1711"></a><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">use_ref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1712"><a id="__codelineno-0-1712" name="__codelineno-0-1712"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-1713"><a id="__codelineno-0-1713" name="__codelineno-0-1713"></a><span class="sd">    Evaluates and displays all possible cases for solutions to a linear system involving the matrix.</span>
</span><span id="__span-0-1714"><a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>
</span><span id="__span-0-1715"><a id="__codelineno-0-1715" name="__codelineno-0-1715"></a><span class="sd">    This method analyzes the determinant of the matrix (or its Gram matrix if not square) to identify</span>
</span><span id="__span-0-1716"><a id="__codelineno-0-1716" name="__codelineno-0-1716"></a><span class="sd">    all possible cases for the values of free variables that affect the existence or uniqueness of solutions.</span>
</span><span id="__span-0-1717"><a id="__codelineno-0-1717" name="__codelineno-0-1717"></a><span class="sd">    For each case, it substitutes the corresponding values into the system and displays the resulting solution(s).</span>
</span><span id="__span-0-1718"><a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>
</span><span id="__span-0-1719"><a id="__codelineno-0-1719" name="__codelineno-0-1719"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1720"><a id="__codelineno-0-1720" name="__codelineno-0-1720"></a><span class="sd">        rhs (Matrix, optional): The right-hand side matrix of the system. If not provided, it treats the system</span>
</span><span id="__span-0-1721"><a id="__codelineno-0-1721" name="__codelineno-0-1721"></a><span class="sd">            as homogeneous (i.e., `Ax = 0`).</span>
</span><span id="__span-0-1722"><a id="__codelineno-0-1722" name="__codelineno-0-1722"></a><span class="sd">        use_ref (bool, optional): Whether to use the row echelon form (REF) for case analysis. Defaults to True.</span>
</span><span id="__span-0-1723"><a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>
</span><span id="__span-0-1724"><a id="__codelineno-0-1724" name="__codelineno-0-1724"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1725"><a id="__codelineno-0-1725" name="__codelineno-0-1725"></a><span class="sd">        None</span>
</span><span id="__span-0-1726"><a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>
</span><span id="__span-0-1727"><a id="__codelineno-0-1727" name="__codelineno-0-1727"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1728"><a id="__codelineno-0-1728" name="__codelineno-0-1728"></a><span class="sd">        &gt;&gt;&gt; A = Matrix([[x, 1], [0, 1]])</span>
</span><span id="__span-0-1729"><a id="__codelineno-0-1729" name="__codelineno-0-1729"></a><span class="sd">        &gt;&gt;&gt; b = Matrix([[2], [3]])</span>
</span><span id="__span-0-1730"><a id="__codelineno-0-1730" name="__codelineno-0-1730"></a><span class="sd">        &gt;&gt;&gt; A.evaluate_cases(b)</span>
</span><span id="__span-0-1731"><a id="__codelineno-0-1731" name="__codelineno-0-1731"></a><span class="sd">        Case 1: {}, not including [{x: 0}]</span>
</span><span id="__span-0-1732"><a id="__codelineno-0-1732" name="__codelineno-0-1732"></a><span class="sd">        Unique solution</span>
</span><span id="__span-0-1733"><a id="__codelineno-0-1733" name="__codelineno-0-1733"></a><span class="sd">        RREF(rref=Matrix([</span>
</span><span id="__span-0-1734"><a id="__codelineno-0-1734" name="__codelineno-0-1734"></a><span class="sd">            [x, 1 | 2]</span>
</span><span id="__span-0-1735"><a id="__codelineno-0-1735" name="__codelineno-0-1735"></a><span class="sd">            [0, 1 | 3]</span>
</span><span id="__span-0-1736"><a id="__codelineno-0-1736" name="__codelineno-0-1736"></a><span class="sd">        ]), pivots=(0, 1))</span>
</span><span id="__span-0-1737"><a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>
</span><span id="__span-0-1738"><a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>
</span><span id="__span-0-1739"><a id="__codelineno-0-1739" name="__codelineno-0-1739"></a><span class="sd">        Case 2: {x: 0}, not including []</span>
</span><span id="__span-0-1740"><a id="__codelineno-0-1740" name="__codelineno-0-1740"></a><span class="sd">        No solution</span>
</span><span id="__span-0-1741"><a id="__codelineno-0-1741" name="__codelineno-0-1741"></a><span class="sd">        RREF(rref=Matrix([</span>
</span><span id="__span-0-1742"><a id="__codelineno-0-1742" name="__codelineno-0-1742"></a><span class="sd">            [0, 1 | 2]</span>
</span><span id="__span-0-1743"><a id="__codelineno-0-1743" name="__codelineno-0-1743"></a><span class="sd">            [0, 0 | 1]</span>
</span><span id="__span-0-1744"><a id="__codelineno-0-1744" name="__codelineno-0-1744"></a><span class="sd">        ]), pivots=(1, 2))</span>
</span><span id="__span-0-1745"><a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>
</span><span id="__span-0-1746"><a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>
</span><span id="__span-0-1747"><a id="__codelineno-0-1747" name="__codelineno-0-1747"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1748"><a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>    <span class="k">if</span> <span class="n">rhs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1749"><a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>        <span class="n">rhs</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1750"><a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>    <span class="n">cases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_all_cases</span><span class="p">()</span>
</span><span id="__span-0-1751"><a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>    <span class="n">all_possible_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="__span-0-1752"><a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>        <span class="n">possible_val</span> <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">cases</span> <span class="k">for</span> <span class="n">possible_val</span> <span class="ow">in</span> <span class="n">case</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="__span-0-1753"><a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>    <span class="p">)</span>
</span><span id="__span-0-1754"><a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>
</span><span id="__span-0-1755"><a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">case</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cases</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-1756"><a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-0-1757"><a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>            <span class="sa">f</span><span class="s2">&quot;Case </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s2">, not including </span><span class="si">{</span><span class="p">[</span><span class="nb">dict</span><span class="p">([</span><span class="n">val</span><span class="p">])</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">all_possible_values</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">items</span><span class="p">()))]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-1758"><a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>        <span class="p">)</span>
</span><span id="__span-0-1759"><a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>        <span class="n">U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
</span><span id="__span-0-1760"><a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>        <span class="k">if</span> <span class="n">use_ref</span><span class="p">:</span>
</span><span id="__span-0-1761"><a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>            <span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">follow_GE</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">U</span>
</span><span id="__span-0-1762"><a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>            <span class="n">pivots</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">U</span><span class="o">.</span><span class="n">get_pivot_pos</span><span class="p">()]</span>
</span><span id="__span-0-1763"><a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1764"><a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>            <span class="n">U</span><span class="p">,</span> <span class="n">pivots</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1765"><a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="ow">in</span> <span class="n">pivots</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1766"><a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No solution&quot;</span><span class="p">)</span>
</span><span id="__span-0-1767"><a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1768"><a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>            <span class="n">free_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">pivots</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1769"><a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>            <span class="k">if</span> <span class="n">free_params</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1770"><a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unique solution&quot;</span><span class="p">)</span>
</span><span id="__span-0-1771"><a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1772"><a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution with </span><span class="si">{</span><span class="n">free_params</span><span class="si">}</span><span class="s2"> free parameters&quot;</span><span class="p">)</span>
</span><span id="__span-0-1773"><a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>
</span><span id="__span-0-1774"><a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>        <span class="n">display</span><span class="p">(</span><span class="n">RREF</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">pivots</span><span class="p">)))</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1775"><a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.rref" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">rref</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">pivots</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RREF</span> <span class="o">|</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.rref" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the Reduced Row Echelon Form (RREF) of the matrix.</p>
<p>This method is a wrapper for <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.rref"><code>rref</code></a> method
and returns the matrix in Reduced Row Echelon Form (RREF) along with the pivot positions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pivots</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, returns a tuple containing the RREF matrix and a list of pivot columns</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Positional arguments passed to SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.rref"><code>rref</code></a> method.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments passed to SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.rref"><code>rref</code></a> method.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              RREF(rref: Matrix, pivots: tuple[int, ...])

  
      dataclass
   (ma1522.custom_types.RREF)" href="../custom_types/#ma1522.custom_types.RREF">RREF</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing the following:</p>
<ul>
<li><code>rref</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The matrix in Reduced Row Echelon Form.</li>
<li><code>pivots</code> (<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list"><code>list</code></a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int"><code>int</code></a>]): A list of integers representing the indices of the pivot columns.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>If <code>pivots</code> is <code>False</code>, only the <code>rref</code> will be returned.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">RREF(rref=Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 0, -1]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0, 1,  2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[0, 0,  0]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">]), pivots=(0, 1))</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1778"><a id="__codelineno-0-1778" name="__codelineno-0-1778"></a><span class="k">def</span><span class="w"> </span><span class="nf">rref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">pivots</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RREF</span> <span class="o">|</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1779"><a id="__codelineno-0-1779" name="__codelineno-0-1779"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the Reduced Row Echelon Form (RREF) of the matrix.</span>
</span><span id="__span-0-1780"><a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>
</span><span id="__span-0-1781"><a id="__codelineno-0-1781" name="__codelineno-0-1781"></a><span class="sd">    This method is a wrapper for [`rref`][sympy.matrices.matrixbase.MatrixBase.rref] method</span>
</span><span id="__span-0-1782"><a id="__codelineno-0-1782" name="__codelineno-0-1782"></a><span class="sd">    and returns the matrix in Reduced Row Echelon Form (RREF) along with the pivot positions.</span>
</span><span id="__span-0-1783"><a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>
</span><span id="__span-0-1784"><a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1785"><a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><span class="sd">        pivots (bool, optional):</span>
</span><span id="__span-0-1786"><a id="__codelineno-0-1786" name="__codelineno-0-1786"></a><span class="sd">            If `True`, returns a tuple containing the RREF matrix and a list of pivot columns</span>
</span><span id="__span-0-1787"><a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><span class="sd">        *args: Positional arguments passed to SymPy&#39;s [`rref`][sympy.matrices.matrixbase.MatrixBase.rref] method.</span>
</span><span id="__span-0-1788"><a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><span class="sd">        **kwargs: Keyword arguments passed to SymPy&#39;s [`rref`][sympy.matrices.matrixbase.MatrixBase.rref] method.</span>
</span><span id="__span-0-1789"><a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>
</span><span id="__span-0-1790"><a id="__codelineno-0-1790" name="__codelineno-0-1790"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1791"><a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><span class="sd">        (RREF): A dataclass containing the following:</span>
</span><span id="__span-0-1792"><a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>
</span><span id="__span-0-1793"><a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="sd">            - `rref` ([`Matrix`][...]): The matrix in Reduced Row Echelon Form.</span>
</span><span id="__span-0-1794"><a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><span class="sd">            - `pivots` ([`list`][list][[`int`][int]]): A list of integers representing the indices of the pivot columns.</span>
</span><span id="__span-0-1795"><a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">        (Matrix): If `pivots` is `False`, only the `rref` will be returned.</span>
</span><span id="__span-0-1796"><a id="__codelineno-0-1796" name="__codelineno-0-1796"></a>
</span><span id="__span-0-1797"><a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1798"><a id="__codelineno-0-1798" name="__codelineno-0-1798"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
</span><span id="__span-0-1799"><a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">        &gt;&gt;&gt; mat.rref()</span>
</span><span id="__span-0-1800"><a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><span class="sd">        RREF(rref=Matrix([</span>
</span><span id="__span-0-1801"><a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><span class="sd">        [1, 0, -1]</span>
</span><span id="__span-0-1802"><a id="__codelineno-0-1802" name="__codelineno-0-1802"></a><span class="sd">        [0, 1,  2]</span>
</span><span id="__span-0-1803"><a id="__codelineno-0-1803" name="__codelineno-0-1803"></a><span class="sd">        [0, 0,  0]</span>
</span><span id="__span-0-1804"><a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="sd">        ]), pivots=(0, 1))</span>
</span><span id="__span-0-1805"><a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1806"><a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>    <span class="k">if</span> <span class="n">pivots</span><span class="p">:</span>
</span><span id="__span-0-1807"><a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>        <span class="n">rref_mat</span><span class="p">,</span> <span class="n">pivot_pos</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-1808"><a id="__codelineno-0-1808" name="__codelineno-0-1808"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1809"><a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>        <span class="n">rref_mat</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">pivots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-1810"><a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>
</span><span id="__span-0-1811"><a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>    <span class="n">aug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aug_pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_aug_pos&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="__span-0-1812"><a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>    <span class="n">rref_mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">rref_mat</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="n">aug</span><span class="p">)</span>
</span><span id="__span-0-1813"><a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>
</span><span id="__span-0-1814"><a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>    <span class="k">if</span> <span class="n">pivots</span><span class="p">:</span>
</span><span id="__span-0-1815"><a id="__codelineno-0-1815" name="__codelineno-0-1815"></a>        <span class="k">return</span> <span class="n">RREF</span><span class="p">(</span><span class="n">rref_mat</span><span class="p">,</span> <span class="n">pivot_pos</span><span class="p">)</span>
</span><span id="__span-0-1816"><a id="__codelineno-0-1816" name="__codelineno-0-1816"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1817"><a id="__codelineno-0-1817" name="__codelineno-0-1817"></a>        <span class="k">return</span> <span class="n">rref_mat</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.solve" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">solve</span><span class="p">(</span><span class="n">rhs</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span></code>

<a href="#ma1522.symbolic.Matrix.solve" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Solves the linear system <code>Ax = rhs</code> for <code>x</code>.</p>
<p>This method uses SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/solvers/solvers.html#sympy.solvers.solvers.solve"><code>solve</code></a> method to find a solution vector <code>x</code> such that <code>self @ x = rhs</code>.
A list of solution matrices is returned.
If no solution exists (e.g., the system is inconsistent), a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a> is raised.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rhs</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The right-hand side matrix or vector in the equation <code>Ax = rhs</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a>]</code>
          –
          <div class="doc-md-description">
            <p>A list of the solution vectors or matrices <code>x</code> that satisfies <code>Ax = rhs</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>If no solution is found for the linear system, an exception is raised.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[2]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])]</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/solvers/solvers.html#sympy.solvers.solvers.solve"><code>sympy.solve</code></a>: For solving equations in general.</li>
<li><a class="autorefs autorefs-internal" title="            rref(*args, pivots: bool = True, **kwargs) -> RREF | Matrix" href="#ma1522.symbolic.Matrix.rref"><code>rref</code></a>: For finding the reduced row echelon form of the matrix.</li>
<li><a class="autorefs autorefs-internal" title="            solve_least_squares(rhs: Matrix, verbosity: int = 1, matrices: int = 1, *args, **kwargs) -> Matrix | PartGen" href="#ma1522.symbolic.Matrix.solve_least_squares"><code>solve_least_squares</code></a>: For solving least squares problems.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1820"><a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]:</span>
</span><span id="__span-0-1821"><a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solves the linear system `Ax = rhs` for `x`.</span>
</span><span id="__span-0-1822"><a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>
</span><span id="__span-0-1823"><a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">    This method uses SymPy&#39;s [`solve`][sympy.solvers.solvers.solve] method to find a solution vector `x` such that `self @ x = rhs`.</span>
</span><span id="__span-0-1824"><a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><span class="sd">    A list of solution matrices is returned.</span>
</span><span id="__span-0-1825"><a id="__codelineno-0-1825" name="__codelineno-0-1825"></a><span class="sd">    If no solution exists (e.g., the system is inconsistent), a [ValueError][] is raised.</span>
</span><span id="__span-0-1826"><a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>
</span><span id="__span-0-1827"><a id="__codelineno-0-1827" name="__codelineno-0-1827"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1828"><a id="__codelineno-0-1828" name="__codelineno-0-1828"></a><span class="sd">        rhs (Matrix): The right-hand side matrix or vector in the equation `Ax = rhs`.</span>
</span><span id="__span-0-1829"><a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>
</span><span id="__span-0-1830"><a id="__codelineno-0-1830" name="__codelineno-0-1830"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1831"><a id="__codelineno-0-1831" name="__codelineno-0-1831"></a><span class="sd">        (list[Matrix]): A list of the solution vectors or matrices `x` that satisfies `Ax = rhs`.</span>
</span><span id="__span-0-1832"><a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
</span><span id="__span-0-1833"><a id="__codelineno-0-1833" name="__codelineno-0-1833"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1834"><a id="__codelineno-0-1834" name="__codelineno-0-1834"></a><span class="sd">        ValueError: If no solution is found for the linear system, an exception is raised.</span>
</span><span id="__span-0-1835"><a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>
</span><span id="__span-0-1836"><a id="__codelineno-0-1836" name="__codelineno-0-1836"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1837"><a id="__codelineno-0-1837" name="__codelineno-0-1837"></a><span class="sd">        &gt;&gt;&gt; A = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-1838"><a id="__codelineno-0-1838" name="__codelineno-0-1838"></a><span class="sd">        &gt;&gt;&gt; b = Matrix([[5], [11]])</span>
</span><span id="__span-0-1839"><a id="__codelineno-0-1839" name="__codelineno-0-1839"></a><span class="sd">        &gt;&gt;&gt; A.solve(b)</span>
</span><span id="__span-0-1840"><a id="__codelineno-0-1840" name="__codelineno-0-1840"></a><span class="sd">        [Matrix([</span>
</span><span id="__span-0-1841"><a id="__codelineno-0-1841" name="__codelineno-0-1841"></a><span class="sd">        [1]</span>
</span><span id="__span-0-1842"><a id="__codelineno-0-1842" name="__codelineno-0-1842"></a><span class="sd">        [2]</span>
</span><span id="__span-0-1843"><a id="__codelineno-0-1843" name="__codelineno-0-1843"></a><span class="sd">        ])]</span>
</span><span id="__span-0-1844"><a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>
</span><span id="__span-0-1845"><a id="__codelineno-0-1845" name="__codelineno-0-1845"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-1846"><a id="__codelineno-0-1846" name="__codelineno-0-1846"></a><span class="sd">        - [`sympy.solve`][sympy.solvers.solvers.solve]: For solving equations in general.</span>
</span><span id="__span-0-1847"><a id="__codelineno-0-1847" name="__codelineno-0-1847"></a><span class="sd">        - [`rref`][..]: For finding the reduced row echelon form of the matrix.</span>
</span><span id="__span-0-1848"><a id="__codelineno-0-1848" name="__codelineno-0-1848"></a><span class="sd">        - [`solve_least_squares`][..]: For solving least squares problems.</span>
</span><span id="__span-0-1849"><a id="__codelineno-0-1849" name="__codelineno-0-1849"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1850"><a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>    <span class="c1"># Use sympy&#39;s solve function directly</span>
</span><span id="__span-0-1851"><a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">create_unk_matrix</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1852"><a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span> <span class="o">@</span> <span class="n">x</span> <span class="o">-</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">,</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1853"><a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>
</span><span id="__span-0-1854"><a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1855"><a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>        <span class="c1"># If no solution is found (e.g., inconsistent system or empty list), raise an error</span>
</span><span id="__span-0-1856"><a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">rref</span><span class="p">())</span>
</span><span id="__span-0-1857"><a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-1858"><a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>            <span class="s2">&quot;No solution found for the linear system. The system may be inconsistent.&quot;</span>
</span><span id="__span-0-1859"><a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>        <span class="p">)</span>
</span><span id="__span-0-1860"><a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1861"><a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span> <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.inverse" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">inverse</span><span class="p">(</span><span class="n">option</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">matrices</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="n">PartGen</span> <span class="o">|</span> <span class="kc">None</span></code>

<a href="#ma1522.symbolic.Matrix.inverse" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the left or right inverse of a matrix, depending on its rank and the specified option.</p>


<details class="the-method-checks-whether-the-matrix-has-full-row-rank-or-full-column-rank-and-computes-either" open>
  <summary>The method checks whether the matrix has full row rank or full column rank and computes either</summary>
  <ul>
<li>The <strong>left inverse</strong> (if the matrix has full column rank).</li>
<li>The <strong>right inverse</strong> (if the matrix has full row rank).</li>
</ul>
</details>        <p>If neither option is provided, the method automatically determines which inverse to compute based on the matrix's rank.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>option</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Specifies which inverse to compute:</p>
<ul>
<li><code>'left'</code> for the left inverse (requires the matrix to have full column rank).</li>
<li><code>'right'</code> for the right inverse (requires the matrix to have full row rank).</li>
<li><code>'both'</code> for the inverse of a square matrix (works on both sides).</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>matrices</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Specifies the number of matrices to return:</p>
<ul>
<li>1: Returns only the inverse matrix.</li>
<li>2: Returns the particular and general solutions of the inverse.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate steps:</p>
<ul>
<li>0: No output.</li>
<li>1: Display matrices before and after RREF.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>If <code>matrices = 1</code>, returns the inverse matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              PartGen(part_sol: Matrix, gen_sol: Matrix)

  
      dataclass
   (ma1522.custom_types.PartGen)" href="../custom_types/#ma1522.custom_types.PartGen">PartGen</a></code>
          –
          <div class="doc-md-description">
            <p>If <code>matrices = 2</code>, returns a dataclass containing the particular and general solutions of the inverse.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>If no valid inverse (left or right or both) is found, an exception is raised.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[ -2,    1]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3/2, -1/2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1867"><a id="__codelineno-0-1867" name="__codelineno-0-1867"></a><span class="k">def</span><span class="w"> </span><span class="nf">inverse</span><span class="p">(</span>
</span><span id="__span-0-1868"><a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-1869"><a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>    <span class="n">option</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-1870"><a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>    <span class="n">matrices</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-1871"><a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>    <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-1872"><a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="n">PartGen</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1873"><a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the left or right inverse of a matrix, depending on its rank and the specified option.</span>
</span><span id="__span-0-1874"><a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>
</span><span id="__span-0-1875"><a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><span class="sd">    The method checks whether the matrix has full row rank or full column rank and computes either:</span>
</span><span id="__span-0-1876"><a id="__codelineno-0-1876" name="__codelineno-0-1876"></a><span class="sd">        - The **left inverse** (if the matrix has full column rank).</span>
</span><span id="__span-0-1877"><a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">        - The **right inverse** (if the matrix has full row rank).</span>
</span><span id="__span-0-1878"><a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>
</span><span id="__span-0-1879"><a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">    If neither option is provided, the method automatically determines which inverse to compute based on the matrix&#39;s rank.</span>
</span><span id="__span-0-1880"><a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>
</span><span id="__span-0-1881"><a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1882"><a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><span class="sd">        option (str, optional): Specifies which inverse to compute:</span>
</span><span id="__span-0-1883"><a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>
</span><span id="__span-0-1884"><a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><span class="sd">            - `&#39;left&#39;` for the left inverse (requires the matrix to have full column rank).</span>
</span><span id="__span-0-1885"><a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="sd">            - `&#39;right&#39;` for the right inverse (requires the matrix to have full row rank).</span>
</span><span id="__span-0-1886"><a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="sd">            - `&#39;both&#39;` for the inverse of a square matrix (works on both sides).</span>
</span><span id="__span-0-1887"><a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>
</span><span id="__span-0-1888"><a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">        matrices (int, optional): Specifies the number of matrices to return:</span>
</span><span id="__span-0-1889"><a id="__codelineno-0-1889" name="__codelineno-0-1889"></a>
</span><span id="__span-0-1890"><a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">            - 1: Returns only the inverse matrix.</span>
</span><span id="__span-0-1891"><a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">            - 2: Returns the particular and general solutions of the inverse.</span>
</span><span id="__span-0-1892"><a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>
</span><span id="__span-0-1893"><a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate steps:</span>
</span><span id="__span-0-1894"><a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>
</span><span id="__span-0-1895"><a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-1896"><a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">            - 1: Display matrices before and after RREF.</span>
</span><span id="__span-0-1897"><a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>
</span><span id="__span-0-1898"><a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1899"><a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><span class="sd">        (Matrix): If `matrices = 1`, returns the inverse matrix.</span>
</span><span id="__span-0-1900"><a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><span class="sd">        (PartGen): If `matrices = 2`, returns a dataclass containing the particular and general solutions of the inverse.</span>
</span><span id="__span-0-1901"><a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>
</span><span id="__span-0-1902"><a id="__codelineno-0-1902" name="__codelineno-0-1902"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1903"><a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">        ValueError: If no valid inverse (left or right or both) is found, an exception is raised.</span>
</span><span id="__span-0-1904"><a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>
</span><span id="__span-0-1905"><a id="__codelineno-0-1905" name="__codelineno-0-1905"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1906"><a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-1907"><a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><span class="sd">        &gt;&gt;&gt; mat.inverse()</span>
</span><span id="__span-0-1908"><a id="__codelineno-0-1908" name="__codelineno-0-1908"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1909"><a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><span class="sd">        [ -2,    1]</span>
</span><span id="__span-0-1910"><a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><span class="sd">        [3/2, -1/2]</span>
</span><span id="__span-0-1911"><a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">        ])</span>
</span><span id="__span-0-1912"><a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1913"><a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>
</span><span id="__span-0-1914"><a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>    <span class="k">if</span> <span class="n">option</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1915"><a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>        <span class="n">rank</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
</span><span id="__span-0-1916"><a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>        <span class="k">if</span> <span class="n">rank</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
</span><span id="__span-0-1917"><a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>            <span class="k">if</span> <span class="n">verbosity</span><span class="p">:</span>
</span><span id="__span-0-1918"><a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Left inverse found!&quot;</span><span class="p">)</span>
</span><span id="__span-0-1919"><a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>            <span class="n">option</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
</span><span id="__span-0-1920"><a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>        <span class="k">if</span> <span class="n">rank</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-1921"><a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>            <span class="k">if</span> <span class="n">verbosity</span><span class="p">:</span>
</span><span id="__span-0-1922"><a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Right inverse found!&quot;</span><span class="p">)</span>
</span><span id="__span-0-1923"><a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>            <span class="n">option</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
</span><span id="__span-0-1924"><a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
</span><span id="__span-0-1925"><a id="__codelineno-0-1925" name="__codelineno-0-1925"></a>                <span class="c1"># square matrix inverse works on both sides</span>
</span><span id="__span-0-1926"><a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>                <span class="n">option</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span>
</span><span id="__span-0-1927"><a id="__codelineno-0-1927" name="__codelineno-0-1927"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1928"><a id="__codelineno-0-1928" name="__codelineno-0-1928"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-1929"><a id="__codelineno-0-1929" name="__codelineno-0-1929"></a>                <span class="sa">f</span><span class="s2">&quot;No inverse found! Rank: </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">, Rows: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">, Columns: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="si">}</span><span class="s2">. Try pseudo-inverse: .pinv()&quot;</span>
</span><span id="__span-0-1930"><a id="__codelineno-0-1930" name="__codelineno-0-1930"></a>            <span class="p">)</span>
</span><span id="__span-0-1931"><a id="__codelineno-0-1931" name="__codelineno-0-1931"></a>
</span><span id="__span-0-1932"><a id="__codelineno-0-1932" name="__codelineno-0-1932"></a>    <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
</span><span id="__span-0-1933"><a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-1934"><a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>            <span class="s2">&quot;Cannot compute both left and right inverse for non-square matrices!&quot;</span>
</span><span id="__span-0-1935"><a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>        <span class="p">)</span>
</span><span id="__span-0-1936"><a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>
</span><span id="__span-0-1937"><a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">option</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-1938"><a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>        <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
</span><span id="__span-0-1939"><a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>            <span class="n">aug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span>
</span><span id="__span-0-1940"><a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>                <span class="n">Matrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">))</span>
</span><span id="__span-0-1941"><a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>            <span class="p">)</span>
</span><span id="__span-0-1942"><a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [self^T | eye]&quot;</span><span class="p">)</span>
</span><span id="__span-0-1943"><a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>            <span class="n">display</span><span class="p">(</span><span class="n">aug</span><span class="p">)</span>
</span><span id="__span-0-1944"><a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-1945"><a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>            <span class="n">display</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">rref</span><span class="p">())</span>
</span><span id="__span-0-1946"><a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1947"><a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>            <span class="n">aug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span>
</span><span id="__span-0-1948"><a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>                <span class="n">Matrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">aug_pos</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">))</span>
</span><span id="__span-0-1949"><a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>            <span class="p">)</span>
</span><span id="__span-0-1950"><a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [self | eye]&quot;</span><span class="p">)</span>
</span><span id="__span-0-1951"><a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>            <span class="n">display</span><span class="p">(</span><span class="n">aug</span><span class="p">)</span>
</span><span id="__span-0-1952"><a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-1953"><a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>            <span class="n">display</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">rref</span><span class="p">())</span>
</span><span id="__span-0-1954"><a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>
</span><span id="__span-0-1955"><a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>    <span class="k">if</span> <span class="n">option</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-1956"><a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">create_unk_matrix</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-1957"><a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>        <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
</span><span id="__span-0-1958"><a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>            <span class="n">eqn</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">sym</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)</span>
</span><span id="__span-0-1959"><a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1960"><a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>            <span class="n">eqn</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">@</span> <span class="n">X</span> <span class="o">-</span> <span class="n">sym</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
</span><span id="__span-0-1961"><a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>
</span><span id="__span-0-1962"><a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>        <span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span>
</span><span id="__span-0-1963"><a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-1964"><a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>            <span class="c1"># Multiple sets of solutions found, picks the first 1</span>
</span><span id="__span-0-1965"><a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-0-1966"><a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-0-1967"><a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</span><span id="__span-0-1968"><a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1969"><a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-1970"><a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>                <span class="sa">f</span><span class="s2">&quot;No </span><span class="si">{</span><span class="n">option</span><span class="si">}</span><span class="s2"> inverse found! Try pseudo-inverse: .pinv()&quot;</span>
</span><span id="__span-0-1971"><a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>            <span class="p">)</span>
</span><span id="__span-0-1972"><a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>
</span><span id="__span-0-1973"><a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>        <span class="k">if</span> <span class="n">matrices</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-1974"><a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>            <span class="k">return</span> <span class="n">X</span>
</span><span id="__span-0-1975"><a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>        <span class="k">elif</span> <span class="n">matrices</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-1976"><a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>            <span class="k">return</span> <span class="n">X</span><span class="o">.</span><span class="n">sep_part_gen</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.elem" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">elem</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.elem" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the identity matrix with the same number of rows as the current matrix.</p>
<p>This method creates an identity matrix to be used for elementary row operations,
i.e., <code>A = I A</code> where <code>I</code> is the identity matrix.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>An identity matrix with the same number of rows as the current matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 0, 0]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0, 1, 0]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[0, 0, 1]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1978"><a id="__codelineno-0-1978" name="__codelineno-0-1978"></a><span class="k">def</span><span class="w"> </span><span class="nf">elem</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-1979"><a id="__codelineno-0-1979" name="__codelineno-0-1979"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the identity matrix with the same number of rows as the current matrix.</span>
</span><span id="__span-0-1980"><a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>
</span><span id="__span-0-1981"><a id="__codelineno-0-1981" name="__codelineno-0-1981"></a><span class="sd">    This method creates an identity matrix to be used for elementary row operations,</span>
</span><span id="__span-0-1982"><a id="__codelineno-0-1982" name="__codelineno-0-1982"></a><span class="sd">    i.e., `A = I A` where `I` is the identity matrix.</span>
</span><span id="__span-0-1983"><a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>
</span><span id="__span-0-1984"><a id="__codelineno-0-1984" name="__codelineno-0-1984"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1985"><a id="__codelineno-0-1985" name="__codelineno-0-1985"></a><span class="sd">        (Matrix): An identity matrix with the same number of rows as the current matrix.</span>
</span><span id="__span-0-1986"><a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>
</span><span id="__span-0-1987"><a id="__codelineno-0-1987" name="__codelineno-0-1987"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-1988"><a id="__codelineno-0-1988" name="__codelineno-0-1988"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4], [5, 6]])</span>
</span><span id="__span-0-1989"><a id="__codelineno-0-1989" name="__codelineno-0-1989"></a><span class="sd">        &gt;&gt;&gt; mat.elem()</span>
</span><span id="__span-0-1990"><a id="__codelineno-0-1990" name="__codelineno-0-1990"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-1991"><a id="__codelineno-0-1991" name="__codelineno-0-1991"></a><span class="sd">        [1, 0, 0]</span>
</span><span id="__span-0-1992"><a id="__codelineno-0-1992" name="__codelineno-0-1992"></a><span class="sd">        [0, 1, 0]</span>
</span><span id="__span-0-1993"><a id="__codelineno-0-1993" name="__codelineno-0-1993"></a><span class="sd">        [0, 0, 1]</span>
</span><span id="__span-0-1994"><a id="__codelineno-0-1994" name="__codelineno-0-1994"></a><span class="sd">        ])</span>
</span><span id="__span-0-1995"><a id="__codelineno-0-1995" name="__codelineno-0-1995"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1996"><a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.adjoint" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">adjoint</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.adjoint" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the adjugate (classical adjoint) of the matrix.</p>
<p>This method calculates the classical adjoint (also known as the <a href="https://en.wikipedia.org/wiki/Adjugate_matrix">adjugate</a>
in literature) of the matrix. The adjoint of a matrix (as defined in MA1522 syllabus) is the transpose of its cofactor matrix.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>If you wish to compute the conjugate transpose of the matrix (SymPy's definition for adjoint),
use <code>self.H</code> directly or <code>super(symbolic.Matrix, self).adjoint()</code> to call the parent method.</p>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The classical adjoint (or adjugate) matrix of the current matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[ 4, -2],</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[-3,  1]])</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>SymPy's <a class="autorefs autorefs-internal" title="            adjugate(method='berkowitz')" href="../inherited/#ma1522.symbolic.Matrix.adjugate"><code>Matrix.adjugate</code></a></li>
<li>SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.adjoint"><code>Matrix.adjoint</code></a> for conjugate transpose.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1999"><a id="__codelineno-0-1999" name="__codelineno-0-1999"></a><span class="k">def</span><span class="w"> </span><span class="nf">adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2000"><a id="__codelineno-0-2000" name="__codelineno-0-2000"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the adjugate (classical adjoint) of the matrix.</span>
</span><span id="__span-0-2001"><a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>
</span><span id="__span-0-2002"><a id="__codelineno-0-2002" name="__codelineno-0-2002"></a><span class="sd">    This method calculates the classical adjoint (also known as the [adjugate](https://en.wikipedia.org/wiki/Adjugate_matrix)</span>
</span><span id="__span-0-2003"><a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><span class="sd">    in literature) of the matrix. The adjoint of a matrix (as defined in MA1522 syllabus) is the transpose of its cofactor matrix.</span>
</span><span id="__span-0-2004"><a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>
</span><span id="__span-0-2005"><a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><span class="sd">    Note:</span>
</span><span id="__span-0-2006"><a id="__codelineno-0-2006" name="__codelineno-0-2006"></a><span class="sd">        If you wish to compute the conjugate transpose of the matrix (SymPy&#39;s definition for adjoint),</span>
</span><span id="__span-0-2007"><a id="__codelineno-0-2007" name="__codelineno-0-2007"></a><span class="sd">        use `self.H` directly or `super(symbolic.Matrix, self).adjoint()` to call the parent method.</span>
</span><span id="__span-0-2008"><a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>
</span><span id="__span-0-2009"><a id="__codelineno-0-2009" name="__codelineno-0-2009"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2010"><a id="__codelineno-0-2010" name="__codelineno-0-2010"></a><span class="sd">        (Matrix): The classical adjoint (or adjugate) matrix of the current matrix.</span>
</span><span id="__span-0-2011"><a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>
</span><span id="__span-0-2012"><a id="__codelineno-0-2012" name="__codelineno-0-2012"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2013"><a id="__codelineno-0-2013" name="__codelineno-0-2013"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-2014"><a id="__codelineno-0-2014" name="__codelineno-0-2014"></a><span class="sd">        &gt;&gt;&gt; mat.adjoint()</span>
</span><span id="__span-0-2015"><a id="__codelineno-0-2015" name="__codelineno-0-2015"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2016"><a id="__codelineno-0-2016" name="__codelineno-0-2016"></a><span class="sd">        [ 4, -2],</span>
</span><span id="__span-0-2017"><a id="__codelineno-0-2017" name="__codelineno-0-2017"></a><span class="sd">        [-3,  1]])</span>
</span><span id="__span-0-2018"><a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>
</span><span id="__span-0-2019"><a id="__codelineno-0-2019" name="__codelineno-0-2019"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-2020"><a id="__codelineno-0-2020" name="__codelineno-0-2020"></a><span class="sd">        - SymPy&#39;s [`Matrix.adjugate`][sympy.matrices.matrixbase.MatrixBase.adjugate]</span>
</span><span id="__span-0-2021"><a id="__codelineno-0-2021" name="__codelineno-0-2021"></a><span class="sd">        - SymPy&#39;s [`Matrix.adjoint`][sympy.matrices.matrixbase.MatrixBase.adjoint] for conjugate transpose.</span>
</span><span id="__span-0-2022"><a id="__codelineno-0-2022" name="__codelineno-0-2022"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2023"><a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>    <span class="n">warn</span><span class="p">(</span>
</span><span id="__span-0-2024"><a id="__codelineno-0-2024" name="__codelineno-0-2024"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The classical adjoint of the matrix is computed rather than the conjugate transpose.</span>
</span><span id="__span-0-2025"><a id="__codelineno-0-2025" name="__codelineno-0-2025"></a><span class="sd">        Please use self.adj() instead to remove ambiguity.&quot;&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-2026"><a id="__codelineno-0-2026" name="__codelineno-0-2026"></a>        <span class="ne">DeprecationWarning</span><span class="p">,</span>
</span><span id="__span-0-2027"><a id="__codelineno-0-2027" name="__codelineno-0-2027"></a>        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-2028"><a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>    <span class="p">)</span>
</span><span id="__span-0-2029"><a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjugate</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.adj" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">adj</span><span class="p">(</span><span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;bareiss&#39;</span><span class="p">,</span> <span class="s1">&#39;berkowitz&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;laplace&#39;</span><span class="p">,</span> <span class="s1">&#39;lu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;berkowitz&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.adj" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Alias for the <a class="autorefs autorefs-internal" title="            adjoint() -> Matrix" href="#ma1522.symbolic.Matrix.adjoint"><code>adjoint</code></a> method.</p>
<p>It returns the classical adjoint (or <a href="https://en.wikipedia.org/wiki/Adjugate_matrix">adjugate</a>) of the matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>method</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                  <code>&#39;berkowitz&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Method to use to find the cofactors, can be "bareiss", "berkowitz",
"bird", "laplace" or "lu".</p>
          </div>
        </li>
    </ul>
        <p>Returns:
    (Matrix): The classical adjoint of the current matrix.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">adj</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[ 4, -2],</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[-3,  1]])</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>SymPy's <a class="autorefs autorefs-internal" title="            adjugate(method='berkowitz')" href="../inherited/#ma1522.symbolic.Matrix.adjugate"><code>adjugate</code></a></li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2031"><a id="__codelineno-0-2031" name="__codelineno-0-2031"></a><span class="k">def</span><span class="w"> </span><span class="nf">adj</span><span class="p">(</span>
</span><span id="__span-0-2032"><a id="__codelineno-0-2032" name="__codelineno-0-2032"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2033"><a id="__codelineno-0-2033" name="__codelineno-0-2033"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;bareiss&quot;</span><span class="p">,</span> <span class="s2">&quot;berkowitz&quot;</span><span class="p">,</span> <span class="s2">&quot;bird&quot;</span><span class="p">,</span> <span class="s2">&quot;laplace&quot;</span><span class="p">,</span> <span class="s2">&quot;lu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;berkowitz&quot;</span><span class="p">,</span>
</span><span id="__span-0-2034"><a id="__codelineno-0-2034" name="__codelineno-0-2034"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2035"><a id="__codelineno-0-2035" name="__codelineno-0-2035"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Alias for the [`adjoint`][..] method.</span>
</span><span id="__span-0-2036"><a id="__codelineno-0-2036" name="__codelineno-0-2036"></a>
</span><span id="__span-0-2037"><a id="__codelineno-0-2037" name="__codelineno-0-2037"></a><span class="sd">    It returns the classical adjoint (or [adjugate](https://en.wikipedia.org/wiki/Adjugate_matrix)) of the matrix.</span>
</span><span id="__span-0-2038"><a id="__codelineno-0-2038" name="__codelineno-0-2038"></a>
</span><span id="__span-0-2039"><a id="__codelineno-0-2039" name="__codelineno-0-2039"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2040"><a id="__codelineno-0-2040" name="__codelineno-0-2040"></a><span class="sd">        method (str, optional): Method to use to find the cofactors, can be &quot;bareiss&quot;, &quot;berkowitz&quot;,</span>
</span><span id="__span-0-2041"><a id="__codelineno-0-2041" name="__codelineno-0-2041"></a><span class="sd">            &quot;bird&quot;, &quot;laplace&quot; or &quot;lu&quot;.</span>
</span><span id="__span-0-2042"><a id="__codelineno-0-2042" name="__codelineno-0-2042"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2043"><a id="__codelineno-0-2043" name="__codelineno-0-2043"></a><span class="sd">        (Matrix): The classical adjoint of the current matrix.</span>
</span><span id="__span-0-2044"><a id="__codelineno-0-2044" name="__codelineno-0-2044"></a>
</span><span id="__span-0-2045"><a id="__codelineno-0-2045" name="__codelineno-0-2045"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2046"><a id="__codelineno-0-2046" name="__codelineno-0-2046"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-2047"><a id="__codelineno-0-2047" name="__codelineno-0-2047"></a><span class="sd">        &gt;&gt;&gt; mat.adj()</span>
</span><span id="__span-0-2048"><a id="__codelineno-0-2048" name="__codelineno-0-2048"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2049"><a id="__codelineno-0-2049" name="__codelineno-0-2049"></a><span class="sd">        [ 4, -2],</span>
</span><span id="__span-0-2050"><a id="__codelineno-0-2050" name="__codelineno-0-2050"></a><span class="sd">        [-3,  1]])</span>
</span><span id="__span-0-2051"><a id="__codelineno-0-2051" name="__codelineno-0-2051"></a>
</span><span id="__span-0-2052"><a id="__codelineno-0-2052" name="__codelineno-0-2052"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-2053"><a id="__codelineno-0-2053" name="__codelineno-0-2053"></a><span class="sd">        - SymPy&#39;s [`adjugate`][sympy.matrices.matrixbase.MatrixBase.adjugate]</span>
</span><span id="__span-0-2054"><a id="__codelineno-0-2054" name="__codelineno-0-2054"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2055"><a id="__codelineno-0-2055" name="__codelineno-0-2055"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjugate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.cramer_solve" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">cramer_solve</span><span class="p">(</span><span class="n">rhs</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">det_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;laplace&#39;</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.cramer_solve" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Solves the linear system using Cramer's Rule.</p>
<p>This method applies Cramer's Rule to solve the linear system represented by the matrix and the right-hand side vector.
It computes the determinant of the matrix and uses it to find the solution vector.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rhs</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The right-hand side vector in the equation <code>Ax = rhs</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>det_method</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                  <code>&#39;laplace&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>The method to use for computing the determinant. Options include:</p>
<ul>
<li><code>'laplace'</code>: Uses the Laplace expansion method.</li>
<li><code>'berkowitz'</code>: Uses the Berkowitz algorithm.</li>
<li><code>'bird'</code>: Uses the Bird's algorithm.</li>
<li><code>'bareiss'</code>: Uses the Bareiss algorithm.</li>
<li><code>'lu'</code>: Uses LU decomposition.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate steps:</p>
<ul>
<li>0: No output.</li>
<li>1: Display basic information.</li>
<li>2: Display detailed information.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The solution vector <code>x</code> that satisfies <code>self @ x = rhs</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.NonSquareMatrixError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.NonSquareMatrixError">NonSquareMatrixError</a></code>
            –
          <div class="doc-md-description">
            <p>If the matrix is not square.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.ShapeError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.ShapeError">ShapeError</a></code>
            –
          <div class="doc-md-description">
            <p>If the matrix and the right-hand side vector have incompatible dimensions.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>If the determinant is zero, indicating that the system has no unique solution.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">cramer_solve</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[2]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            solve(rhs: Matrix) -> list[Matrix]" href="#ma1522.symbolic.Matrix.solve"><code>solve</code></a>: For solving linear systems using other methods.</li>
<li>SymPy's <a class="autorefs autorefs-internal" title="            det(method='bareiss', iszerofunc=None)" href="../inherited/#ma1522.symbolic.Matrix.det"><code>Matrix.det</code></a> for computing the determinant.</li>
<li>SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.cramer_solve"><code>Matrix.cramer_solve</code></a></li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2058"><a id="__codelineno-0-2058" name="__codelineno-0-2058"></a><span class="k">def</span><span class="w"> </span><span class="nf">cramer_solve</span><span class="p">(</span>
</span><span id="__span-0-2059"><a id="__codelineno-0-2059" name="__codelineno-0-2059"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">det_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;laplace&quot;</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-0-2060"><a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2061"><a id="__codelineno-0-2061" name="__codelineno-0-2061"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solves the linear system using Cramer&#39;s Rule.</span>
</span><span id="__span-0-2062"><a id="__codelineno-0-2062" name="__codelineno-0-2062"></a>
</span><span id="__span-0-2063"><a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><span class="sd">    This method applies Cramer&#39;s Rule to solve the linear system represented by the matrix and the right-hand side vector.</span>
</span><span id="__span-0-2064"><a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><span class="sd">    It computes the determinant of the matrix and uses it to find the solution vector.</span>
</span><span id="__span-0-2065"><a id="__codelineno-0-2065" name="__codelineno-0-2065"></a>
</span><span id="__span-0-2066"><a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2067"><a id="__codelineno-0-2067" name="__codelineno-0-2067"></a><span class="sd">        rhs (Matrix): The right-hand side vector in the equation `Ax = rhs`.</span>
</span><span id="__span-0-2068"><a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><span class="sd">        det_method (str, optional): The method to use for computing the determinant. Options include:</span>
</span><span id="__span-0-2069"><a id="__codelineno-0-2069" name="__codelineno-0-2069"></a>
</span><span id="__span-0-2070"><a id="__codelineno-0-2070" name="__codelineno-0-2070"></a><span class="sd">            - `&#39;laplace&#39;`: Uses the Laplace expansion method.</span>
</span><span id="__span-0-2071"><a id="__codelineno-0-2071" name="__codelineno-0-2071"></a><span class="sd">            - `&#39;berkowitz&#39;`: Uses the Berkowitz algorithm.</span>
</span><span id="__span-0-2072"><a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="sd">            - `&#39;bird&#39;`: Uses the Bird&#39;s algorithm.</span>
</span><span id="__span-0-2073"><a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="sd">            - `&#39;bareiss&#39;`: Uses the Bareiss algorithm.</span>
</span><span id="__span-0-2074"><a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="sd">            - `&#39;lu&#39;`: Uses LU decomposition.</span>
</span><span id="__span-0-2075"><a id="__codelineno-0-2075" name="__codelineno-0-2075"></a>
</span><span id="__span-0-2076"><a id="__codelineno-0-2076" name="__codelineno-0-2076"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate steps:</span>
</span><span id="__span-0-2077"><a id="__codelineno-0-2077" name="__codelineno-0-2077"></a>
</span><span id="__span-0-2078"><a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2079"><a id="__codelineno-0-2079" name="__codelineno-0-2079"></a><span class="sd">            - 1: Display basic information.</span>
</span><span id="__span-0-2080"><a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">            - 2: Display detailed information.</span>
</span><span id="__span-0-2081"><a id="__codelineno-0-2081" name="__codelineno-0-2081"></a>
</span><span id="__span-0-2082"><a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2083"><a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">        (Matrix): The solution vector `x` that satisfies `self @ x = rhs`.</span>
</span><span id="__span-0-2084"><a id="__codelineno-0-2084" name="__codelineno-0-2084"></a>
</span><span id="__span-0-2085"><a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-2086"><a id="__codelineno-0-2086" name="__codelineno-0-2086"></a><span class="sd">        sympy.matrices.exceptions.NonSquareMatrixError: If the matrix is not square.</span>
</span><span id="__span-0-2087"><a id="__codelineno-0-2087" name="__codelineno-0-2087"></a><span class="sd">        sympy.matrices.exceptions.ShapeError: If the matrix and the right-hand side vector have incompatible dimensions.</span>
</span><span id="__span-0-2088"><a id="__codelineno-0-2088" name="__codelineno-0-2088"></a><span class="sd">        ValueError: If the determinant is zero, indicating that the system has no unique solution.</span>
</span><span id="__span-0-2089"><a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>
</span><span id="__span-0-2090"><a id="__codelineno-0-2090" name="__codelineno-0-2090"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2091"><a id="__codelineno-0-2091" name="__codelineno-0-2091"></a><span class="sd">        &gt;&gt;&gt; A = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-2092"><a id="__codelineno-0-2092" name="__codelineno-0-2092"></a><span class="sd">        &gt;&gt;&gt; b = Matrix([[5], [11]])</span>
</span><span id="__span-0-2093"><a id="__codelineno-0-2093" name="__codelineno-0-2093"></a><span class="sd">        &gt;&gt;&gt; A.cramer_solve(b, verbosity=0)</span>
</span><span id="__span-0-2094"><a id="__codelineno-0-2094" name="__codelineno-0-2094"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2095"><a id="__codelineno-0-2095" name="__codelineno-0-2095"></a><span class="sd">        [1]</span>
</span><span id="__span-0-2096"><a id="__codelineno-0-2096" name="__codelineno-0-2096"></a><span class="sd">        [2]</span>
</span><span id="__span-0-2097"><a id="__codelineno-0-2097" name="__codelineno-0-2097"></a><span class="sd">        ])</span>
</span><span id="__span-0-2098"><a id="__codelineno-0-2098" name="__codelineno-0-2098"></a>
</span><span id="__span-0-2099"><a id="__codelineno-0-2099" name="__codelineno-0-2099"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-2100"><a id="__codelineno-0-2100" name="__codelineno-0-2100"></a><span class="sd">        - [`solve`][..]: For solving linear systems using other methods.</span>
</span><span id="__span-0-2101"><a id="__codelineno-0-2101" name="__codelineno-0-2101"></a><span class="sd">        - SymPy&#39;s [`Matrix.det`][sympy.matrices.matrixbase.MatrixBase.det] for computing the determinant.</span>
</span><span id="__span-0-2102"><a id="__codelineno-0-2102" name="__codelineno-0-2102"></a><span class="sd">        - SymPy&#39;s [`Matrix.cramer_solve`][sympy.matrices.matrixbase.MatrixBase.cramer_solve]</span>
</span><span id="__span-0-2103"><a id="__codelineno-0-2103" name="__codelineno-0-2103"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2104"><a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">!=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-2105"><a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">ShapeError</span><span class="p">(</span>
</span><span id="__span-0-2106"><a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>            <span class="s2">&quot;The right-hand side vector must have the same number of rows as the matrix.&quot;</span>
</span><span id="__span-0-2107"><a id="__codelineno-0-2107" name="__codelineno-0-2107"></a>        <span class="p">)</span>
</span><span id="__span-0-2108"><a id="__codelineno-0-2108" name="__codelineno-0-2108"></a>    <span class="k">if</span> <span class="n">rhs</span><span class="o">.</span><span class="n">cols</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2109"><a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">ShapeError</span><span class="p">(</span>
</span><span id="__span-0-2110"><a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>            <span class="s2">&quot;The right-hand side vector must be a column vector (1 column).&quot;</span>
</span><span id="__span-0-2111"><a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>        <span class="p">)</span>
</span><span id="__span-0-2112"><a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
</span><span id="__span-0-2113"><a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">NonSquareMatrixError</span><span class="p">(</span>
</span><span id="__span-0-2114"><a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>            <span class="s2">&quot;Cramer&#39;s Rule can only be applied to square matrices.&quot;</span>
</span><span id="__span-0-2115"><a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>        <span class="p">)</span>
</span><span id="__span-0-2116"><a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>    <span class="n">det</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">det_method</span><span class="p">)</span>
</span><span id="__span-0-2117"><a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>    <span class="k">if</span> <span class="n">det</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-2118"><a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Determinant is zero, no unique solution exists.&quot;</span><span class="p">)</span>
</span><span id="__span-0-2119"><a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>
</span><span id="__span-0-2120"><a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>    <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-2121"><a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
</span><span id="__span-0-2122"><a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>        <span class="c1"># Create a copy of the matrix and replace the i-th column with the rhs vector</span>
</span><span id="__span-0-2123"><a id="__codelineno-0-2123" name="__codelineno-0-2123"></a>        <span class="n">modified_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-0-2124"><a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>        <span class="n">modified_matrix</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-2125"><a id="__codelineno-0-2125" name="__codelineno-0-2125"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2126"><a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modified matrix for column </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2127"><a id="__codelineno-0-2127" name="__codelineno-0-2127"></a>            <span class="n">display</span><span class="p">(</span><span class="n">modified_matrix</span><span class="p">)</span>
</span><span id="__span-0-2128"><a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>        <span class="n">det_i</span> <span class="o">=</span> <span class="n">modified_matrix</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">det_method</span><span class="p">)</span> <span class="o">/</span> <span class="n">det</span>
</span><span id="__span-0-2129"><a id="__codelineno-0-2129" name="__codelineno-0-2129"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2130"><a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>            <span class="n">display</span><span class="p">(</span>
</span><span id="__span-0-2131"><a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>                <span class="n">_textify</span><span class="p">(</span><span class="s2">&quot;Determinant for column &quot;</span><span class="p">)</span>
</span><span id="__span-0-2132"><a id="__codelineno-0-2132" name="__codelineno-0-2132"></a>                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-2133"><a id="__codelineno-0-2133" name="__codelineno-0-2133"></a>                <span class="o">+</span> <span class="s2">&quot;: &quot;</span>
</span><span id="__span-0-2134"><a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>                <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">det_i</span><span class="p">),</span>
</span><span id="__span-0-2135"><a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>                <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">,</span>
</span><span id="__span-0-2136"><a id="__codelineno-0-2136" name="__codelineno-0-2136"></a>            <span class="p">)</span>
</span><span id="__span-0-2137"><a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>        <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">det_i</span><span class="p">)</span>
</span><span id="__span-0-2138"><a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.column_constraints" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">column_constraints</span><span class="p">(</span><span class="n">use_ref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.column_constraints" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the column constraints for the matrix by appending a symbolic vector.</p>
<p>This method creates a matrix where a random column vector <span class="arithmatex">\(\begin{pmatrix} x_1 \\ \vdots \\ x_m \end{pmatrix}\)</span>
is added to the matrix as an additional column. It then constructs a larger augmented matrix
and optionally computes its Row Echelon Form (REF) or Reduced Row Echelon Form (RREF).</p>
<p>The method modifies the matrix to ensure that the unknown vector is not reduced in RREF,
and the constraints for the matrix columns are calculated accordingly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>use_ref</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to use Row Echelon Form (REF) instead of Reduced Row Echelon Form (RREF).
If <code>False</code>, RREF will be used.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Verbosity level for displaying information.</p>
<ul>
<li>0: No output</li>
<li>1: Display all information</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new matrix containing the result after applying REF or RREF to the augmented matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span> <span class="c1"># linearly dependent columns</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">column_constraints</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 2 |       x_2/2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0, 0 | x_1 - x_2/2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span> <span class="c1"># linearly independent columns</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">column_constraints</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 0 |    -2*x_1 + x_2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0, 1 | 3*x_1/2 - x_2/2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2140"><a id="__codelineno-0-2140" name="__codelineno-0-2140"></a><span class="k">def</span><span class="w"> </span><span class="nf">column_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_ref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2141"><a id="__codelineno-0-2141" name="__codelineno-0-2141"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Computes the column constraints for the matrix by appending a symbolic vector.</span>
</span><span id="__span-0-2142"><a id="__codelineno-0-2142" name="__codelineno-0-2142"></a>
</span><span id="__span-0-2143"><a id="__codelineno-0-2143" name="__codelineno-0-2143"></a><span class="sd">    This method creates a matrix where a random column vector $\begin{pmatrix} x_1 \\ \vdots \\ x_m \end{pmatrix}$</span>
</span><span id="__span-0-2144"><a id="__codelineno-0-2144" name="__codelineno-0-2144"></a><span class="sd">    is added to the matrix as an additional column. It then constructs a larger augmented matrix</span>
</span><span id="__span-0-2145"><a id="__codelineno-0-2145" name="__codelineno-0-2145"></a><span class="sd">    and optionally computes its Row Echelon Form (REF) or Reduced Row Echelon Form (RREF).</span>
</span><span id="__span-0-2146"><a id="__codelineno-0-2146" name="__codelineno-0-2146"></a>
</span><span id="__span-0-2147"><a id="__codelineno-0-2147" name="__codelineno-0-2147"></a><span class="sd">    The method modifies the matrix to ensure that the unknown vector is not reduced in RREF,</span>
</span><span id="__span-0-2148"><a id="__codelineno-0-2148" name="__codelineno-0-2148"></a><span class="sd">    and the constraints for the matrix columns are calculated accordingly.</span>
</span><span id="__span-0-2149"><a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>
</span><span id="__span-0-2150"><a id="__codelineno-0-2150" name="__codelineno-0-2150"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2151"><a id="__codelineno-0-2151" name="__codelineno-0-2151"></a><span class="sd">        use_ref (bool, optional): Whether to use Row Echelon Form (REF) instead of Reduced Row Echelon Form (RREF).</span>
</span><span id="__span-0-2152"><a id="__codelineno-0-2152" name="__codelineno-0-2152"></a><span class="sd">            If `False`, RREF will be used.</span>
</span><span id="__span-0-2153"><a id="__codelineno-0-2153" name="__codelineno-0-2153"></a><span class="sd">        verbosity (int, optional): Verbosity level for displaying information.</span>
</span><span id="__span-0-2154"><a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>
</span><span id="__span-0-2155"><a id="__codelineno-0-2155" name="__codelineno-0-2155"></a><span class="sd">            - 0: No output</span>
</span><span id="__span-0-2156"><a id="__codelineno-0-2156" name="__codelineno-0-2156"></a><span class="sd">            - 1: Display all information</span>
</span><span id="__span-0-2157"><a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>
</span><span id="__span-0-2158"><a id="__codelineno-0-2158" name="__codelineno-0-2158"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2159"><a id="__codelineno-0-2159" name="__codelineno-0-2159"></a><span class="sd">        (Matrix): A new matrix containing the result after applying REF or RREF to the augmented matrix.</span>
</span><span id="__span-0-2160"><a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>
</span><span id="__span-0-2161"><a id="__codelineno-0-2161" name="__codelineno-0-2161"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2162"><a id="__codelineno-0-2162" name="__codelineno-0-2162"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [2, 4]]) # linearly dependent columns</span>
</span><span id="__span-0-2163"><a id="__codelineno-0-2163" name="__codelineno-0-2163"></a><span class="sd">        &gt;&gt;&gt; mat.column_constraints(verbosity=0)</span>
</span><span id="__span-0-2164"><a id="__codelineno-0-2164" name="__codelineno-0-2164"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2165"><a id="__codelineno-0-2165" name="__codelineno-0-2165"></a><span class="sd">        [1, 2 |       x_2/2]</span>
</span><span id="__span-0-2166"><a id="__codelineno-0-2166" name="__codelineno-0-2166"></a><span class="sd">        [0, 0 | x_1 - x_2/2]</span>
</span><span id="__span-0-2167"><a id="__codelineno-0-2167" name="__codelineno-0-2167"></a><span class="sd">        ])</span>
</span><span id="__span-0-2168"><a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>
</span><span id="__span-0-2169"><a id="__codelineno-0-2169" name="__codelineno-0-2169"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]]) # linearly independent columns</span>
</span><span id="__span-0-2170"><a id="__codelineno-0-2170" name="__codelineno-0-2170"></a><span class="sd">        &gt;&gt;&gt; mat.column_constraints(verbosity=0)</span>
</span><span id="__span-0-2171"><a id="__codelineno-0-2171" name="__codelineno-0-2171"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2172"><a id="__codelineno-0-2172" name="__codelineno-0-2172"></a><span class="sd">        [1, 0 |    -2*x_1 + x_2]</span>
</span><span id="__span-0-2173"><a id="__codelineno-0-2173" name="__codelineno-0-2173"></a><span class="sd">        [0, 1 | 3*x_1/2 - x_2/2]</span>
</span><span id="__span-0-2174"><a id="__codelineno-0-2174" name="__codelineno-0-2174"></a><span class="sd">        ])</span>
</span><span id="__span-0-2175"><a id="__codelineno-0-2175" name="__codelineno-0-2175"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2176"><a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>
</span><span id="__span-0-2177"><a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>    <span class="c1"># write a random vector as x_1, ..., x_m, given m rows</span>
</span><span id="__span-0-2178"><a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>    <span class="n">vector</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">create_unk_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-0-2179"><a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>
</span><span id="__span-0-2180"><a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>    <span class="c1"># insert hidden column vectors so that the unknown vector is not reduced in rref</span>
</span><span id="__span-0-2181"><a id="__codelineno-0-2181" name="__codelineno-0-2181"></a>    <span class="n">hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span>
</span><span id="__span-0-2182"><a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>
</span><span id="__span-0-2183"><a id="__codelineno-0-2183" name="__codelineno-0-2183"></a>    <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">hidden</span><span class="p">)</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</span><span id="__span-0-2184"><a id="__codelineno-0-2184" name="__codelineno-0-2184"></a>    <span class="k">if</span> <span class="n">use_ref</span><span class="p">:</span>
</span><span id="__span-0-2185"><a id="__codelineno-0-2185" name="__codelineno-0-2185"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span><span class="o">.</span><span class="n">U</span>
</span><span id="__span-0-2186"><a id="__codelineno-0-2186" name="__codelineno-0-2186"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2187"><a id="__codelineno-0-2187" name="__codelineno-0-2187"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-2188"><a id="__codelineno-0-2188" name="__codelineno-0-2188"></a>
</span><span id="__span-0-2189"><a id="__codelineno-0-2189" name="__codelineno-0-2189"></a>    <span class="n">visible_cols</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-2190"><a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>    <span class="n">res_matrix</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="o">*</span><span class="n">visible_cols</span><span class="p">)</span><span class="o">.</span><span class="n">aug_line</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-2191"><a id="__codelineno-0-2191" name="__codelineno-0-2191"></a>
</span><span id="__span-0-2192"><a id="__codelineno-0-2192" name="__codelineno-0-2192"></a>    <span class="k">if</span> <span class="n">verbosity</span><span class="p">:</span>
</span><span id="__span-0-2193"><a id="__codelineno-0-2193" name="__codelineno-0-2193"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [self | vec]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2194"><a id="__codelineno-0-2194" name="__codelineno-0-2194"></a>        <span class="n">display</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="o">*</span><span class="n">visible_cols</span><span class="p">)</span><span class="o">.</span><span class="n">aug_line</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="__span-0-2195"><a id="__codelineno-0-2195" name="__codelineno-0-2195"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After RREF&quot;</span><span class="p">)</span>
</span><span id="__span-0-2196"><a id="__codelineno-0-2196" name="__codelineno-0-2196"></a>        <span class="n">display</span><span class="p">(</span><span class="n">res_matrix</span><span class="p">)</span>
</span><span id="__span-0-2197"><a id="__codelineno-0-2197" name="__codelineno-0-2197"></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-0-2198"><a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>            <span class="s2">&quot;For the system to be consistent, the following constraints must be satisfied.&quot;</span>
</span><span id="__span-0-2199"><a id="__codelineno-0-2199" name="__codelineno-0-2199"></a>        <span class="p">)</span>
</span><span id="__span-0-2200"><a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">res_matrix</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
</span><span id="__span-0-2201"><a id="__codelineno-0-2201" name="__codelineno-0-2201"></a>            <span class="c1"># check for zero row</span>
</span><span id="__span-0-2202"><a id="__codelineno-0-2202" name="__codelineno-0-2202"></a>            <span class="k">if</span> <span class="n">res_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-2203"><a id="__codelineno-0-2203" name="__codelineno-0-2203"></a>                <span class="n">display</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">res_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="__span-0-2204"><a id="__codelineno-0-2204" name="__codelineno-0-2204"></a>    <span class="k">return</span> <span class="n">res_matrix</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.normalized" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">normalized</span><span class="p">(</span><span class="n">iszerofunc</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Expr</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">factor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="n">ScalarFactor</span></code>

<a href="#ma1522.symbolic.Matrix.normalized" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Normalizes the column vectors of the matrix (scaling each vector to have a unit norm).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>iszerofunc</code></b>
              (<code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<a class="autorefs autorefs-external" title="sympy.core.expr.Expr" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.expr.Expr">Expr</a>], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Function to determine if a value should be treated as zero</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>factor</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, returns the <a class="autorefs autorefs-internal" title="              ScalarFactor(diag: Matrix, full: Matrix, order: Literal['FD', 'DF'])

  
      dataclass
  " href="../custom_types/#ma1522.custom_types.ScalarFactor"><code>ScalarFactor</code></a> dataclass.
If <code>False</code>, only the normalized matrix is returned.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ScalarFactor(diag: Matrix, full: Matrix, order: Literal['FD', 'DF'])

  
      dataclass
   (ma1522.custom_types.ScalarFactor)" href="../custom_types/#ma1522.custom_types.ScalarFactor">ScalarFactor</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing the normalized matrix and the diagonal matrix of norms if <code>factor=True</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The normalized matrix if <code>factor=False</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[0, 3/5]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0, 4/5]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">normalized</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">ScalarFactor(diag=Matrix([[1/5]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">]), full=Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[4]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">]), order=&#39;FD&#39;)</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2210"><a id="__codelineno-0-2210" name="__codelineno-0-2210"></a><span class="k">def</span><span class="w"> </span><span class="nf">normalized</span><span class="p">(</span>
</span><span id="__span-0-2211"><a id="__codelineno-0-2211" name="__codelineno-0-2211"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2212"><a id="__codelineno-0-2212" name="__codelineno-0-2212"></a>    <span class="n">iszerofunc</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Expr</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-2213"><a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>    <span class="n">factor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-2214"><a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="n">ScalarFactor</span><span class="p">:</span>
</span><span id="__span-0-2215"><a id="__codelineno-0-2215" name="__codelineno-0-2215"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalizes the column vectors of the matrix (scaling each vector to have a unit norm).</span>
</span><span id="__span-0-2216"><a id="__codelineno-0-2216" name="__codelineno-0-2216"></a>
</span><span id="__span-0-2217"><a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2218"><a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">        iszerofunc (Callable[[Expr], int], optional): Function to determine if a value should be treated as zero</span>
</span><span id="__span-0-2219"><a id="__codelineno-0-2219" name="__codelineno-0-2219"></a><span class="sd">        factor (bool, optional): If `True`, returns the [`ScalarFactor`][(p).] dataclass.</span>
</span><span id="__span-0-2220"><a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">            If `False`, only the normalized matrix is returned.</span>
</span><span id="__span-0-2221"><a id="__codelineno-0-2221" name="__codelineno-0-2221"></a>
</span><span id="__span-0-2222"><a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2223"><a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">        (ScalarFactor): A dataclass containing the normalized matrix and the diagonal matrix of norms if `factor=True`.</span>
</span><span id="__span-0-2224"><a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">        (Matrix): The normalized matrix if `factor=False`.</span>
</span><span id="__span-0-2225"><a id="__codelineno-0-2225" name="__codelineno-0-2225"></a>
</span><span id="__span-0-2226"><a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2227"><a id="__codelineno-0-2227" name="__codelineno-0-2227"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[0, 3], [0, 4]])</span>
</span><span id="__span-0-2228"><a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">        &gt;&gt;&gt; mat.normalized()</span>
</span><span id="__span-0-2229"><a id="__codelineno-0-2229" name="__codelineno-0-2229"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2230"><a id="__codelineno-0-2230" name="__codelineno-0-2230"></a><span class="sd">        [0, 3/5]</span>
</span><span id="__span-0-2231"><a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="sd">        [0, 4/5]</span>
</span><span id="__span-0-2232"><a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="sd">        ])</span>
</span><span id="__span-0-2233"><a id="__codelineno-0-2233" name="__codelineno-0-2233"></a>
</span><span id="__span-0-2234"><a id="__codelineno-0-2234" name="__codelineno-0-2234"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[3], [4]])</span>
</span><span id="__span-0-2235"><a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">        &gt;&gt;&gt; mat.normalized(factor=True)</span>
</span><span id="__span-0-2236"><a id="__codelineno-0-2236" name="__codelineno-0-2236"></a><span class="sd">        ScalarFactor(diag=Matrix([[1/5]</span>
</span><span id="__span-0-2237"><a id="__codelineno-0-2237" name="__codelineno-0-2237"></a><span class="sd">        ]), full=Matrix([</span>
</span><span id="__span-0-2238"><a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="sd">        [3]</span>
</span><span id="__span-0-2239"><a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">        [4]</span>
</span><span id="__span-0-2240"><a id="__codelineno-0-2240" name="__codelineno-0-2240"></a><span class="sd">        ]), order=&#39;FD&#39;)</span>
</span><span id="__span-0-2241"><a id="__codelineno-0-2241" name="__codelineno-0-2241"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2242"><a id="__codelineno-0-2242" name="__codelineno-0-2242"></a>
</span><span id="__span-0-2243"><a id="__codelineno-0-2243" name="__codelineno-0-2243"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
</span><span id="__span-0-2244"><a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>        <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-0-2245"><a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>        <span class="n">scalar</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">col</span><span class="p">))</span>  <span class="c1"># Manual norm calculation</span>
</span><span id="__span-0-2246"><a id="__codelineno-0-2246" name="__codelineno-0-2246"></a>        <span class="k">if</span> <span class="n">iszerofunc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2247"><a id="__codelineno-0-2247" name="__codelineno-0-2247"></a>            <span class="k">if</span> <span class="n">scalar</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-2248"><a id="__codelineno-0-2248" name="__codelineno-0-2248"></a>                <span class="bp">self</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">scalar</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-2249"><a id="__codelineno-0-2249" name="__codelineno-0-2249"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2250"><a id="__codelineno-0-2250" name="__codelineno-0-2250"></a>            <span class="k">if</span> <span class="n">iszerofunc</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-2251"><a id="__codelineno-0-2251" name="__codelineno-0-2251"></a>                <span class="bp">self</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">scalar</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-2252"><a id="__codelineno-0-2252" name="__codelineno-0-2252"></a>
</span><span id="__span-0-2253"><a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>    <span class="k">if</span> <span class="n">factor</span><span class="p">:</span>
</span><span id="__span-0-2254"><a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scalar_factor</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2255"><a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2256"><a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>        <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.is_linearly_independent" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_linearly_independent</span><span class="p">(</span><span class="n">colspace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#ma1522.symbolic.Matrix.is_linearly_independent" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Determines if the vectors in the matrix are linearly independent.</p>
<p>This method checks whether the columns (or rows) of the matrix are linearly independent
by computing its reduced row echelon form (RREF) and comparing the number of pivot columns
to the number of columns (or rows).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>colspace</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, checks linear independence of columns (column space).
If <code>False</code>, checks linear independence of rows (row space).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Level of output during the RREF and check.</p>
<ul>
<li>0: No output (default).</li>
<li>1: Print summary of the RREF and check.</li>
<li>2: Print the matrix before and after RREF, and the check details.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p><code>True</code> if the matrix's columns (or rows) are linearly independent, <code>False</code> otherwise.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_linearly_independent</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">True</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_linearly_independent</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">False</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2258"><a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_linearly_independent</span><span class="p">(</span>
</span><span id="__span-0-2259"><a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-2260"><a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>    <span class="n">colspace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-2261"><a id="__codelineno-0-2261" name="__codelineno-0-2261"></a>    <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-2262"><a id="__codelineno-0-2262" name="__codelineno-0-2262"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2263"><a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determines if the vectors in the matrix are linearly independent.</span>
</span><span id="__span-0-2264"><a id="__codelineno-0-2264" name="__codelineno-0-2264"></a>
</span><span id="__span-0-2265"><a id="__codelineno-0-2265" name="__codelineno-0-2265"></a><span class="sd">    This method checks whether the columns (or rows) of the matrix are linearly independent</span>
</span><span id="__span-0-2266"><a id="__codelineno-0-2266" name="__codelineno-0-2266"></a><span class="sd">    by computing its reduced row echelon form (RREF) and comparing the number of pivot columns</span>
</span><span id="__span-0-2267"><a id="__codelineno-0-2267" name="__codelineno-0-2267"></a><span class="sd">    to the number of columns (or rows).</span>
</span><span id="__span-0-2268"><a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>
</span><span id="__span-0-2269"><a id="__codelineno-0-2269" name="__codelineno-0-2269"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2270"><a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="sd">        colspace (bool, optional): If `True`, checks linear independence of columns (column space).</span>
</span><span id="__span-0-2271"><a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="sd">            If `False`, checks linear independence of rows (row space).</span>
</span><span id="__span-0-2272"><a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>
</span><span id="__span-0-2273"><a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><span class="sd">        verbosity (int, optional): Level of output during the RREF and check.</span>
</span><span id="__span-0-2274"><a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>
</span><span id="__span-0-2275"><a id="__codelineno-0-2275" name="__codelineno-0-2275"></a><span class="sd">            - 0: No output (default).</span>
</span><span id="__span-0-2276"><a id="__codelineno-0-2276" name="__codelineno-0-2276"></a><span class="sd">            - 1: Print summary of the RREF and check.</span>
</span><span id="__span-0-2277"><a id="__codelineno-0-2277" name="__codelineno-0-2277"></a><span class="sd">            - 2: Print the matrix before and after RREF, and the check details.</span>
</span><span id="__span-0-2278"><a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>
</span><span id="__span-0-2279"><a id="__codelineno-0-2279" name="__codelineno-0-2279"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2280"><a id="__codelineno-0-2280" name="__codelineno-0-2280"></a><span class="sd">        (bool): `True` if the matrix&#39;s columns (or rows) are linearly independent, `False` otherwise.</span>
</span><span id="__span-0-2281"><a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>
</span><span id="__span-0-2282"><a id="__codelineno-0-2282" name="__codelineno-0-2282"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2283"><a id="__codelineno-0-2283" name="__codelineno-0-2283"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-2284"><a id="__codelineno-0-2284" name="__codelineno-0-2284"></a><span class="sd">        &gt;&gt;&gt; mat.is_linearly_independent()</span>
</span><span id="__span-0-2285"><a id="__codelineno-0-2285" name="__codelineno-0-2285"></a><span class="sd">        True</span>
</span><span id="__span-0-2286"><a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>
</span><span id="__span-0-2287"><a id="__codelineno-0-2287" name="__codelineno-0-2287"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [2, 4]])</span>
</span><span id="__span-0-2288"><a id="__codelineno-0-2288" name="__codelineno-0-2288"></a><span class="sd">        &gt;&gt;&gt; mat.is_linearly_independent()</span>
</span><span id="__span-0-2289"><a id="__codelineno-0-2289" name="__codelineno-0-2289"></a><span class="sd">        False</span>
</span><span id="__span-0-2290"><a id="__codelineno-0-2290" name="__codelineno-0-2290"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2291"><a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>    <span class="n">rref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2292"><a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rref</span><span class="p">,</span> <span class="n">RREF</span><span class="p">),</span> <span class="s2">&quot;RREF should return a RREF dataclass&quot;</span>
</span><span id="__span-0-2293"><a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>    <span class="n">rref_mat</span><span class="p">,</span> <span class="n">pivots</span> <span class="o">=</span> <span class="n">rref</span><span class="o">.</span><span class="n">rref</span><span class="p">,</span> <span class="n">rref</span><span class="o">.</span><span class="n">pivots</span>
</span><span id="__span-0-2294"><a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>
</span><span id="__span-0-2295"><a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2296"><a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rref(self)&quot;</span><span class="p">)</span>
</span><span id="__span-0-2297"><a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>    <span class="k">elif</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2298"><a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: self&quot;</span><span class="p">)</span>
</span><span id="__span-0-2299"><a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-2300"><a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2301"><a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>        <span class="n">display</span><span class="p">(</span><span class="n">rref_mat</span><span class="p">)</span>
</span><span id="__span-0-2302"><a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>
</span><span id="__span-0-2303"><a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>    <span class="k">if</span> <span class="n">colspace</span><span class="p">:</span>
</span><span id="__span-0-2304"><a id="__codelineno-0-2304" name="__codelineno-0-2304"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2305"><a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>            <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-0-2306"><a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>                <span class="sa">f</span><span class="s2">&quot;Check if Number of columns (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="si">}</span><span class="s2">) == Number of pivot columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pivots</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-2307"><a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>            <span class="p">)</span>
</span><span id="__span-0-2308"><a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">pivots</span><span class="p">)</span>
</span><span id="__span-0-2309"><a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2310"><a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2311"><a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>            <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-0-2312"><a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>                <span class="sa">f</span><span class="s2">&quot;Check if Number of rows (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">) == Number of pivot columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pivots</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-2313"><a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>            <span class="p">)</span>
</span><span id="__span-0-2314"><a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">pivots</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.get_linearly_independent_vectors" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_linearly_independent_vectors</span><span class="p">(</span><span class="n">colspace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.get_linearly_independent_vectors" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns a matrix containing the linearly independent vectors from the column space or row space.</p>
<p>This method computes the reduced row echelon form (RREF) of the matrix and selects the non-zero rows
as linearly independent vectors. The result is a matrix whose columns (or rows) are linearly independent.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>colspace</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, returns linearly independent vectors from the column space.
If <code>False</code>, returns from the row space.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Level of output verbosity.</p>
<ul>
<li>0: No output.</li>
<li>1: Print a summary of the RREF and selection.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix whose columns (if colspace=True) or rows (if colspace=False) are linearly independent vectors.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">get_linearly_independent_vectors</span><span class="p">(</span><span class="n">colspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2316"><a id="__codelineno-0-2316" name="__codelineno-0-2316"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_linearly_independent_vectors</span><span class="p">(</span>
</span><span id="__span-0-2317"><a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">colspace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-2318"><a id="__codelineno-0-2318" name="__codelineno-0-2318"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2319"><a id="__codelineno-0-2319" name="__codelineno-0-2319"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a matrix containing the linearly independent vectors from the column space or row space.</span>
</span><span id="__span-0-2320"><a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>
</span><span id="__span-0-2321"><a id="__codelineno-0-2321" name="__codelineno-0-2321"></a><span class="sd">    This method computes the reduced row echelon form (RREF) of the matrix and selects the non-zero rows</span>
</span><span id="__span-0-2322"><a id="__codelineno-0-2322" name="__codelineno-0-2322"></a><span class="sd">    as linearly independent vectors. The result is a matrix whose columns (or rows) are linearly independent.</span>
</span><span id="__span-0-2323"><a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>
</span><span id="__span-0-2324"><a id="__codelineno-0-2324" name="__codelineno-0-2324"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2325"><a id="__codelineno-0-2325" name="__codelineno-0-2325"></a><span class="sd">        colspace (bool, optional): If `True`, returns linearly independent vectors from the column space.</span>
</span><span id="__span-0-2326"><a id="__codelineno-0-2326" name="__codelineno-0-2326"></a><span class="sd">            If `False`, returns from the row space.</span>
</span><span id="__span-0-2327"><a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>
</span><span id="__span-0-2328"><a id="__codelineno-0-2328" name="__codelineno-0-2328"></a><span class="sd">        verbosity (int, optional): Level of output verbosity.</span>
</span><span id="__span-0-2329"><a id="__codelineno-0-2329" name="__codelineno-0-2329"></a>
</span><span id="__span-0-2330"><a id="__codelineno-0-2330" name="__codelineno-0-2330"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2331"><a id="__codelineno-0-2331" name="__codelineno-0-2331"></a><span class="sd">            - 1: Print a summary of the RREF and selection.</span>
</span><span id="__span-0-2332"><a id="__codelineno-0-2332" name="__codelineno-0-2332"></a>
</span><span id="__span-0-2333"><a id="__codelineno-0-2333" name="__codelineno-0-2333"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2334"><a id="__codelineno-0-2334" name="__codelineno-0-2334"></a><span class="sd">        (Matrix): A matrix whose columns (if colspace=True) or rows (if colspace=False) are linearly independent vectors.</span>
</span><span id="__span-0-2335"><a id="__codelineno-0-2335" name="__codelineno-0-2335"></a>
</span><span id="__span-0-2336"><a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2337"><a id="__codelineno-0-2337" name="__codelineno-0-2337"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [2, 4]])</span>
</span><span id="__span-0-2338"><a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="sd">        &gt;&gt;&gt; mat.get_linearly_independent_vectors(colspace=True, verbosity=0)</span>
</span><span id="__span-0-2339"><a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2340"><a id="__codelineno-0-2340" name="__codelineno-0-2340"></a><span class="sd">        [1]</span>
</span><span id="__span-0-2341"><a id="__codelineno-0-2341" name="__codelineno-0-2341"></a><span class="sd">        [2]</span>
</span><span id="__span-0-2342"><a id="__codelineno-0-2342" name="__codelineno-0-2342"></a><span class="sd">        ])</span>
</span><span id="__span-0-2343"><a id="__codelineno-0-2343" name="__codelineno-0-2343"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2344"><a id="__codelineno-0-2344" name="__codelineno-0-2344"></a>    <span class="k">if</span> <span class="n">colspace</span><span class="p">:</span>
</span><span id="__span-0-2345"><a id="__codelineno-0-2345" name="__codelineno-0-2345"></a>        <span class="n">rref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2346"><a id="__codelineno-0-2346" name="__codelineno-0-2346"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rref</span><span class="p">,</span> <span class="n">RREF</span><span class="p">),</span> <span class="s2">&quot;RREF should return a RREF dataclass&quot;</span>
</span><span id="__span-0-2347"><a id="__codelineno-0-2347" name="__codelineno-0-2347"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2348"><a id="__codelineno-0-2348" name="__codelineno-0-2348"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [self]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2349"><a id="__codelineno-0-2349" name="__codelineno-0-2349"></a>            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-2350"><a id="__codelineno-0-2350" name="__codelineno-0-2350"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2351"><a id="__codelineno-0-2351" name="__codelineno-0-2351"></a>            <span class="n">display</span><span class="p">(</span><span class="n">rref</span><span class="p">)</span>
</span><span id="__span-0-2352"><a id="__codelineno-0-2352" name="__codelineno-0-2352"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Select columns of self corresponding to pivot positions.&quot;</span><span class="p">)</span>
</span><span id="__span-0-2353"><a id="__codelineno-0-2353" name="__codelineno-0-2353"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="o">*</span><span class="n">rref</span><span class="o">.</span><span class="n">pivots</span><span class="p">)</span>
</span><span id="__span-0-2354"><a id="__codelineno-0-2354" name="__codelineno-0-2354"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2355"><a id="__codelineno-0-2355" name="__codelineno-0-2355"></a>        <span class="n">rref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2356"><a id="__codelineno-0-2356" name="__codelineno-0-2356"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rref</span><span class="p">,</span> <span class="n">RREF</span><span class="p">),</span> <span class="s2">&quot;RREF should return a RREF dataclass&quot;</span>
</span><span id="__span-0-2357"><a id="__codelineno-0-2357" name="__codelineno-0-2357"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2358"><a id="__codelineno-0-2358" name="__codelineno-0-2358"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [self^T]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2359"><a id="__codelineno-0-2359" name="__codelineno-0-2359"></a>            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="__span-0-2360"><a id="__codelineno-0-2360" name="__codelineno-0-2360"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2361"><a id="__codelineno-0-2361" name="__codelineno-0-2361"></a>            <span class="n">display</span><span class="p">(</span><span class="n">rref</span><span class="p">)</span>
</span><span id="__span-0-2362"><a id="__codelineno-0-2362" name="__codelineno-0-2362"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Select rows of self corresponding to pivot positions.&quot;</span><span class="p">)</span>
</span><span id="__span-0-2363"><a id="__codelineno-0-2363" name="__codelineno-0-2363"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_rows</span><span class="p">(</span><span class="o">*</span><span class="n">rref</span><span class="o">.</span><span class="n">pivots</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.simplify_basis" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">simplify_basis</span><span class="p">(</span><span class="n">colspace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.simplify_basis" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns a simplified basis for the column space or row space of the matrix.</p>
<p>This method computes a basis for either the column space or the row space of the matrix
by reducing the matrix (or its transpose) to reduced row echelon form (RREF) and selecting
the nonzero rows as basis vectors. The result is a matrix whose columns (or rows) form a basis
for the specified subspace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>colspace</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, returns a basis for the column space.
If <code>False</code>, returns a basis for the row space.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Level of output verbosity.</p>
<ul>
<li>0: No output.</li>
<li>1: Print a summary of the RREF and basis selection.</li>
<li>2: Print the matrix before and after RREF, and show the selected basis vectors.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix whose columns (if colspace=True) or rows (if colspace=False) form a basis
for the corresponding subspace.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">simplify_basis</span><span class="p">(</span><span class="n">colspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">simplify_basis</span><span class="p">(</span><span class="n">colspace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 0]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0, 1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2365"><a id="__codelineno-0-2365" name="__codelineno-0-2365"></a><span class="k">def</span><span class="w"> </span><span class="nf">simplify_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colspace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2366"><a id="__codelineno-0-2366" name="__codelineno-0-2366"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a simplified basis for the column space or row space of the matrix.</span>
</span><span id="__span-0-2367"><a id="__codelineno-0-2367" name="__codelineno-0-2367"></a>
</span><span id="__span-0-2368"><a id="__codelineno-0-2368" name="__codelineno-0-2368"></a><span class="sd">    This method computes a basis for either the column space or the row space of the matrix</span>
</span><span id="__span-0-2369"><a id="__codelineno-0-2369" name="__codelineno-0-2369"></a><span class="sd">    by reducing the matrix (or its transpose) to reduced row echelon form (RREF) and selecting</span>
</span><span id="__span-0-2370"><a id="__codelineno-0-2370" name="__codelineno-0-2370"></a><span class="sd">    the nonzero rows as basis vectors. The result is a matrix whose columns (or rows) form a basis</span>
</span><span id="__span-0-2371"><a id="__codelineno-0-2371" name="__codelineno-0-2371"></a><span class="sd">    for the specified subspace.</span>
</span><span id="__span-0-2372"><a id="__codelineno-0-2372" name="__codelineno-0-2372"></a>
</span><span id="__span-0-2373"><a id="__codelineno-0-2373" name="__codelineno-0-2373"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2374"><a id="__codelineno-0-2374" name="__codelineno-0-2374"></a><span class="sd">        colspace (bool, optional): If `True`, returns a basis for the column space.</span>
</span><span id="__span-0-2375"><a id="__codelineno-0-2375" name="__codelineno-0-2375"></a><span class="sd">            If `False`, returns a basis for the row space.</span>
</span><span id="__span-0-2376"><a id="__codelineno-0-2376" name="__codelineno-0-2376"></a>
</span><span id="__span-0-2377"><a id="__codelineno-0-2377" name="__codelineno-0-2377"></a><span class="sd">        verbosity (int, optional): Level of output verbosity.</span>
</span><span id="__span-0-2378"><a id="__codelineno-0-2378" name="__codelineno-0-2378"></a>
</span><span id="__span-0-2379"><a id="__codelineno-0-2379" name="__codelineno-0-2379"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2380"><a id="__codelineno-0-2380" name="__codelineno-0-2380"></a><span class="sd">            - 1: Print a summary of the RREF and basis selection.</span>
</span><span id="__span-0-2381"><a id="__codelineno-0-2381" name="__codelineno-0-2381"></a><span class="sd">            - 2: Print the matrix before and after RREF, and show the selected basis vectors.</span>
</span><span id="__span-0-2382"><a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>
</span><span id="__span-0-2383"><a id="__codelineno-0-2383" name="__codelineno-0-2383"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2384"><a id="__codelineno-0-2384" name="__codelineno-0-2384"></a><span class="sd">        (Matrix): A matrix whose columns (if colspace=True) or rows (if colspace=False) form a basis</span>
</span><span id="__span-0-2385"><a id="__codelineno-0-2385" name="__codelineno-0-2385"></a><span class="sd">            for the corresponding subspace.</span>
</span><span id="__span-0-2386"><a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>
</span><span id="__span-0-2387"><a id="__codelineno-0-2387" name="__codelineno-0-2387"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2388"><a id="__codelineno-0-2388" name="__codelineno-0-2388"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [2, 4]])</span>
</span><span id="__span-0-2389"><a id="__codelineno-0-2389" name="__codelineno-0-2389"></a><span class="sd">        &gt;&gt;&gt; mat.simplify_basis(colspace=True, verbosity=0)</span>
</span><span id="__span-0-2390"><a id="__codelineno-0-2390" name="__codelineno-0-2390"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2391"><a id="__codelineno-0-2391" name="__codelineno-0-2391"></a><span class="sd">        [1]</span>
</span><span id="__span-0-2392"><a id="__codelineno-0-2392" name="__codelineno-0-2392"></a><span class="sd">        [2]</span>
</span><span id="__span-0-2393"><a id="__codelineno-0-2393" name="__codelineno-0-2393"></a><span class="sd">        ])</span>
</span><span id="__span-0-2394"><a id="__codelineno-0-2394" name="__codelineno-0-2394"></a>
</span><span id="__span-0-2395"><a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-2396"><a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="sd">        &gt;&gt;&gt; mat.simplify_basis(colspace=False, verbosity=0)</span>
</span><span id="__span-0-2397"><a id="__codelineno-0-2397" name="__codelineno-0-2397"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2398"><a id="__codelineno-0-2398" name="__codelineno-0-2398"></a><span class="sd">        [1, 0]</span>
</span><span id="__span-0-2399"><a id="__codelineno-0-2399" name="__codelineno-0-2399"></a><span class="sd">        [0, 1]</span>
</span><span id="__span-0-2400"><a id="__codelineno-0-2400" name="__codelineno-0-2400"></a><span class="sd">        ])</span>
</span><span id="__span-0-2401"><a id="__codelineno-0-2401" name="__codelineno-0-2401"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2402"><a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>    <span class="k">if</span> <span class="n">colspace</span><span class="p">:</span>
</span><span id="__span-0-2403"><a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>        <span class="n">rref_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-2404"><a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rref_mat</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">),</span> <span class="s2">&quot;RREF should return a Matrix&quot;</span>
</span><span id="__span-0-2405"><a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2406"><a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Select non-zero rows of rref(self.T) as basis vectors.&quot;</span><span class="p">)</span>
</span><span id="__span-0-2407"><a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2408"><a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: self^T&quot;</span><span class="p">)</span>
</span><span id="__span-0-2409"><a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="__span-0-2410"><a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2411"><a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>            <span class="n">display</span><span class="p">(</span><span class="n">rref_mat</span><span class="p">)</span>
</span><span id="__span-0-2412"><a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2413"><a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>        <span class="n">rref_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-2414"><a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rref_mat</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">),</span> <span class="s2">&quot;RREF should return a Matrix&quot;</span>
</span><span id="__span-0-2415"><a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2416"><a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Select non-zero rows of rref(self) as basis vectors.&quot;</span><span class="p">)</span>
</span><span id="__span-0-2417"><a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2418"><a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: self&quot;</span><span class="p">)</span>
</span><span id="__span-0-2419"><a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-2420"><a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2421"><a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>            <span class="n">display</span><span class="p">(</span><span class="n">rref_mat</span><span class="p">)</span>
</span><span id="__span-0-2422"><a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>
</span><span id="__span-0-2423"><a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>    <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-2424"><a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rref_mat</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
</span><span id="__span-0-2425"><a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="n">_is_zero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rref_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]):</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-2426"><a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-0-2427"><a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>
</span><span id="__span-0-2428"><a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">rref_mat</span><span class="o">.</span><span class="n">select_rows</span><span class="p">(</span><span class="o">*</span><span class="n">idxs</span><span class="p">)</span>
</span><span id="__span-0-2429"><a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>    <span class="k">if</span> <span class="n">colspace</span><span class="p">:</span>
</span><span id="__span-0-2430"><a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>        <span class="k">return</span> <span class="n">mat</span><span class="o">.</span><span class="n">T</span>
</span><span id="__span-0-2431"><a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2432"><a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>        <span class="k">return</span> <span class="n">mat</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.extend_basis" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">extend_basis</span><span class="p">(</span><span class="n">span_subspace</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.extend_basis" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Extends the matrix to form a basis for the span of the given subspace.</p>
<p>This method extends the column space of the current matrix to include the columns of the provided
<code>span_subspace</code>, computes the Reduced Row Echelon Form (RREF) of the augmented matrix,
and then selects the pivot columns to return the extended basis.</p>
<p>If no <code>span_subspace</code> is provided, the identity matrix (i.e. <span class="arithmatex">\(\mathrm{span} \left(\mathbb{R}^n \right)\)</span>) is used as the default.
The result is a matrix with the extended basis that spans the combined space of the <code>self</code>
matrix and the <code>span_subspace</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>span_subspace</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>A matrix whose columns represent the subspace to
be added to the current matrix. If <code>None</code>, the identity matrix is used.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Verbosity level for displaying information.</p>
<ul>
<li>0: No output.</li>
<li>1: Display steps.</li>
<li>2: Display the matrix before and after RREF.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix whose column space represents the extended basis, consisting of the pivot columns
    from the RREF of the augmented matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">extend_basis</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, 1]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[2, 0]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2434"><a id="__codelineno-0-2434" name="__codelineno-0-2434"></a><span class="k">def</span><span class="w"> </span><span class="nf">extend_basis</span><span class="p">(</span>
</span><span id="__span-0-2435"><a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">span_subspace</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-0-2436"><a id="__codelineno-0-2436" name="__codelineno-0-2436"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2437"><a id="__codelineno-0-2437" name="__codelineno-0-2437"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Extends the matrix to form a basis for the span of the given subspace.</span>
</span><span id="__span-0-2438"><a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>
</span><span id="__span-0-2439"><a id="__codelineno-0-2439" name="__codelineno-0-2439"></a><span class="sd">    This method extends the column space of the current matrix to include the columns of the provided</span>
</span><span id="__span-0-2440"><a id="__codelineno-0-2440" name="__codelineno-0-2440"></a><span class="sd">    `span_subspace`, computes the Reduced Row Echelon Form (RREF) of the augmented matrix,</span>
</span><span id="__span-0-2441"><a id="__codelineno-0-2441" name="__codelineno-0-2441"></a><span class="sd">    and then selects the pivot columns to return the extended basis.</span>
</span><span id="__span-0-2442"><a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>
</span><span id="__span-0-2443"><a id="__codelineno-0-2443" name="__codelineno-0-2443"></a><span class="sd">    If no `span_subspace` is provided, the identity matrix (i.e. $\mathrm{span} \left(\mathbb{R}^n \right)$) is used as the default.</span>
</span><span id="__span-0-2444"><a id="__codelineno-0-2444" name="__codelineno-0-2444"></a><span class="sd">    The result is a matrix with the extended basis that spans the combined space of the `self`</span>
</span><span id="__span-0-2445"><a id="__codelineno-0-2445" name="__codelineno-0-2445"></a><span class="sd">    matrix and the `span_subspace`.</span>
</span><span id="__span-0-2446"><a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>
</span><span id="__span-0-2447"><a id="__codelineno-0-2447" name="__codelineno-0-2447"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2448"><a id="__codelineno-0-2448" name="__codelineno-0-2448"></a><span class="sd">        span_subspace (Matrix, optional): A matrix whose columns represent the subspace to</span>
</span><span id="__span-0-2449"><a id="__codelineno-0-2449" name="__codelineno-0-2449"></a><span class="sd">            be added to the current matrix. If `None`, the identity matrix is used.</span>
</span><span id="__span-0-2450"><a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>
</span><span id="__span-0-2451"><a id="__codelineno-0-2451" name="__codelineno-0-2451"></a><span class="sd">        verbosity (int, optional): Verbosity level for displaying information.</span>
</span><span id="__span-0-2452"><a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>
</span><span id="__span-0-2453"><a id="__codelineno-0-2453" name="__codelineno-0-2453"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2454"><a id="__codelineno-0-2454" name="__codelineno-0-2454"></a><span class="sd">            - 1: Display steps.</span>
</span><span id="__span-0-2455"><a id="__codelineno-0-2455" name="__codelineno-0-2455"></a><span class="sd">            - 2: Display the matrix before and after RREF.</span>
</span><span id="__span-0-2456"><a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>
</span><span id="__span-0-2457"><a id="__codelineno-0-2457" name="__codelineno-0-2457"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2458"><a id="__codelineno-0-2458" name="__codelineno-0-2458"></a><span class="sd">        (Matrix): A matrix whose column space represents the extended basis, consisting of the pivot columns</span>
</span><span id="__span-0-2459"><a id="__codelineno-0-2459" name="__codelineno-0-2459"></a><span class="sd">                from the RREF of the augmented matrix.</span>
</span><span id="__span-0-2460"><a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>
</span><span id="__span-0-2461"><a id="__codelineno-0-2461" name="__codelineno-0-2461"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2462"><a id="__codelineno-0-2462" name="__codelineno-0-2462"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [2, 4]])</span>
</span><span id="__span-0-2463"><a id="__codelineno-0-2463" name="__codelineno-0-2463"></a><span class="sd">        &gt;&gt;&gt; mat.extend_basis(verbosity=0)</span>
</span><span id="__span-0-2464"><a id="__codelineno-0-2464" name="__codelineno-0-2464"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2465"><a id="__codelineno-0-2465" name="__codelineno-0-2465"></a><span class="sd">        [1, 1]</span>
</span><span id="__span-0-2466"><a id="__codelineno-0-2466" name="__codelineno-0-2466"></a><span class="sd">        [2, 0]</span>
</span><span id="__span-0-2467"><a id="__codelineno-0-2467" name="__codelineno-0-2467"></a><span class="sd">        ])</span>
</span><span id="__span-0-2468"><a id="__codelineno-0-2468" name="__codelineno-0-2468"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2469"><a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>
</span><span id="__span-0-2470"><a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>    <span class="k">if</span> <span class="n">span_subspace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2471"><a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>        <span class="n">span_subspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span>
</span><span id="__span-0-2472"><a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>    <span class="n">aug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">span_subspace</span><span class="p">)</span>
</span><span id="__span-0-2473"><a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>    <span class="n">rref</span> <span class="o">=</span> <span class="n">aug</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2474"><a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rref</span><span class="p">,</span> <span class="n">RREF</span><span class="p">),</span> <span class="s2">&quot;RREF should return a RREF dataclass&quot;</span>
</span><span id="__span-0-2475"><a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>
</span><span id="__span-0-2476"><a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2477"><a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rref([self | span_subspace])&quot;</span><span class="p">)</span>
</span><span id="__span-0-2478"><a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>    <span class="k">elif</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2479"><a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [self | span_subspace]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2480"><a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>        <span class="n">display</span><span class="p">(</span><span class="n">aug</span><span class="p">)</span>
</span><span id="__span-0-2481"><a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2482"><a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>        <span class="n">display</span><span class="p">(</span><span class="n">rref</span><span class="p">)</span>
</span><span id="__span-0-2483"><a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-0-2484"><a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>            <span class="s2">&quot;Select columns of rref([self | span_subspace]) corresponding to pivot positions.&quot;</span>
</span><span id="__span-0-2485"><a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>        <span class="p">)</span>
</span><span id="__span-0-2486"><a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>
</span><span id="__span-0-2487"><a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>    <span class="k">return</span> <span class="n">aug</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="o">*</span><span class="n">rref</span><span class="o">.</span><span class="n">pivots</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.intersect_subspace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">intersect_subspace</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.intersect_subspace" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the intersection of two subspaces by finding the nullspace of their orthogonal complements.</p>
<p>This method computes the intersection of the subspaces spanned by the columns of the current matrix
(<code>self</code>) and the provided matrix (<code>other</code>). The intersection is computed by finding the union of the nullspace of
the row space of the two matrices, and then finding its orthogonal complement.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>other</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The second matrix representing the other subspace to intersect with the current matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate steps:</p>
<ul>
<li>0: No output.</li>
<li>1: Display steps.</li>
<li>2: Display the relevant matrices.
Defaults to 2.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix whose columns form a basis for the intersection of the two subspaces.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat1</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat2</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat1</span><span class="o">.</span><span class="n">intersect_subspace</span><span class="p">(</span><span class="n">mat2</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[0]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2489"><a id="__codelineno-0-2489" name="__codelineno-0-2489"></a><span class="k">def</span><span class="w"> </span><span class="nf">intersect_subspace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2490"><a id="__codelineno-0-2490" name="__codelineno-0-2490"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the intersection of two subspaces by finding the nullspace of their orthogonal complements.</span>
</span><span id="__span-0-2491"><a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>
</span><span id="__span-0-2492"><a id="__codelineno-0-2492" name="__codelineno-0-2492"></a><span class="sd">    This method computes the intersection of the subspaces spanned by the columns of the current matrix</span>
</span><span id="__span-0-2493"><a id="__codelineno-0-2493" name="__codelineno-0-2493"></a><span class="sd">    (`self`) and the provided matrix (`other`). The intersection is computed by finding the union of the nullspace of</span>
</span><span id="__span-0-2494"><a id="__codelineno-0-2494" name="__codelineno-0-2494"></a><span class="sd">    the row space of the two matrices, and then finding its orthogonal complement.</span>
</span><span id="__span-0-2495"><a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>
</span><span id="__span-0-2496"><a id="__codelineno-0-2496" name="__codelineno-0-2496"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2497"><a id="__codelineno-0-2497" name="__codelineno-0-2497"></a><span class="sd">        other (Matrix): The second matrix representing the other subspace to intersect with the current matrix.</span>
</span><span id="__span-0-2498"><a id="__codelineno-0-2498" name="__codelineno-0-2498"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate steps:</span>
</span><span id="__span-0-2499"><a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>
</span><span id="__span-0-2500"><a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2501"><a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="sd">            - 1: Display steps.</span>
</span><span id="__span-0-2502"><a id="__codelineno-0-2502" name="__codelineno-0-2502"></a><span class="sd">            - 2: Display the relevant matrices.</span>
</span><span id="__span-0-2503"><a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><span class="sd">            Defaults to 2.</span>
</span><span id="__span-0-2504"><a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>
</span><span id="__span-0-2505"><a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2506"><a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">        (Matrix): A matrix whose columns form a basis for the intersection of the two subspaces.</span>
</span><span id="__span-0-2507"><a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>
</span><span id="__span-0-2508"><a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2509"><a id="__codelineno-0-2509" name="__codelineno-0-2509"></a><span class="sd">        &gt;&gt;&gt; mat1 = Matrix([[1, 0], [0, 1]])</span>
</span><span id="__span-0-2510"><a id="__codelineno-0-2510" name="__codelineno-0-2510"></a><span class="sd">        &gt;&gt;&gt; mat2 = Matrix([[1, 1], [0, 0]])</span>
</span><span id="__span-0-2511"><a id="__codelineno-0-2511" name="__codelineno-0-2511"></a><span class="sd">        &gt;&gt;&gt; mat1.intersect_subspace(mat2, verbosity=0)</span>
</span><span id="__span-0-2512"><a id="__codelineno-0-2512" name="__codelineno-0-2512"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2513"><a id="__codelineno-0-2513" name="__codelineno-0-2513"></a><span class="sd">        [1]</span>
</span><span id="__span-0-2514"><a id="__codelineno-0-2514" name="__codelineno-0-2514"></a><span class="sd">        [0]</span>
</span><span id="__span-0-2515"><a id="__codelineno-0-2515" name="__codelineno-0-2515"></a><span class="sd">        ])</span>
</span><span id="__span-0-2516"><a id="__codelineno-0-2516" name="__codelineno-0-2516"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2517"><a id="__codelineno-0-2517" name="__codelineno-0-2517"></a>
</span><span id="__span-0-2518"><a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>    <span class="c1"># Construct 2 matrices A and B, whose solution space (ie nullspace) is</span>
</span><span id="__span-0-2519"><a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>    <span class="c1"># the subspace self and other respectively. Observe that the solution</span>
</span><span id="__span-0-2520"><a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>    <span class="c1"># space is orthogonal to the row space, so it is the orthogonal complement.</span>
</span><span id="__span-0-2521"><a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>
</span><span id="__span-0-2522"><a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_complement</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</span><span id="__span-0-2523"><a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>    <span class="n">B</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">orthogonal_complement</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</span><span id="__span-0-2524"><a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>
</span><span id="__span-0-2525"><a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>    <span class="c1"># Now we obtain A and B which represent the linear system of 2 different</span>
</span><span id="__span-0-2526"><a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>    <span class="c1"># subspaces. When we solve these simultaneously, we will find the solution</span>
</span><span id="__span-0-2527"><a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>    <span class="c1"># space which contains vectors which are solutions to both linear systems.</span>
</span><span id="__span-0-2528"><a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>    <span class="n">aug</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-0-2529"><a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2530"><a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A = Null(self^T)^T&quot;</span><span class="p">)</span>
</span><span id="__span-0-2531"><a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B = Null(other^T)^T&quot;</span><span class="p">)</span>
</span><span id="__span-0-2532"><a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Null([A ; B])&quot;</span><span class="p">)</span>
</span><span id="__span-0-2533"><a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>
</span><span id="__span-0-2534"><a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2535"><a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-0-2536"><a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>            <span class="s2">&quot;A linear system whose solution space is the subspace of self. Null(self^T)^T&quot;</span>
</span><span id="__span-0-2537"><a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>        <span class="p">)</span>
</span><span id="__span-0-2538"><a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>        <span class="n">display</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="__span-0-2539"><a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="__span-0-2540"><a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">A linear system whose solution space is the subspace of other. Null(other^T)^T&quot;</span>
</span><span id="__span-0-2541"><a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>        <span class="p">)</span>
</span><span id="__span-0-2542"><a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>        <span class="n">display</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-0-2543"><a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Before RREF: [self ; other]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2544"><a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>        <span class="n">display</span><span class="p">(</span><span class="n">aug</span><span class="p">)</span>
</span><span id="__span-0-2545"><a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2546"><a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>        <span class="n">display</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">rref</span><span class="p">())</span>
</span><span id="__span-0-2547"><a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>
</span><span id="__span-0-2548"><a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">nullspace</span><span class="p">())</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.is_subspace_of" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_subspace_of</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#ma1522.symbolic.Matrix.is_subspace_of" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if the current matrix is a subspace of another matrix.</p>
<p>This method determines whether the subspace spanned by the columns of the current matrix (<code>self</code>)
is a subspace of the provided matrix (<code>other</code>). It does so by checking if the row-reduced echelon form
(RREF) of the augmented matrix <code>[other | self]</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>other</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The second matrix representing the other subspace to compare with the current matrix.
If <code>None</code>, the identity matrix is used to check if it spans <span class="arithmatex">\(\mathbb{R}^\text{self.rows}}\)</span></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate steps:</p>
<ul>
<li>0: No output.</li>
<li>1: Display the steps.</li>
<li>2: Display the relevant matrices.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p><code>True</code> if the subspace spanned by <code>self</code> is a subspace of <code>other</code>, <code>False</code> otherwise.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.ShapeError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.ShapeError">ShapeError</a></code>
            –
          <div class="doc-md-description">
            <p>If the number of rows in the current matrix and the target matrix are different.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat1</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat2</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat2</span><span class="o">.</span><span class="n">is_subspace_of</span><span class="p">(</span><span class="n">mat1</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">True</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2550"><a id="__codelineno-0-2550" name="__codelineno-0-2550"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_subspace_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2551"><a id="__codelineno-0-2551" name="__codelineno-0-2551"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Checks if the current matrix is a subspace of another matrix.</span>
</span><span id="__span-0-2552"><a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>
</span><span id="__span-0-2553"><a id="__codelineno-0-2553" name="__codelineno-0-2553"></a><span class="sd">    This method determines whether the subspace spanned by the columns of the current matrix (`self`)</span>
</span><span id="__span-0-2554"><a id="__codelineno-0-2554" name="__codelineno-0-2554"></a><span class="sd">    is a subspace of the provided matrix (`other`). It does so by checking if the row-reduced echelon form</span>
</span><span id="__span-0-2555"><a id="__codelineno-0-2555" name="__codelineno-0-2555"></a><span class="sd">    (RREF) of the augmented matrix `[other | self]`.</span>
</span><span id="__span-0-2556"><a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>
</span><span id="__span-0-2557"><a id="__codelineno-0-2557" name="__codelineno-0-2557"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2558"><a id="__codelineno-0-2558" name="__codelineno-0-2558"></a><span class="sd">        other (Matrix, optional): The second matrix representing the other subspace to compare with the current matrix.</span>
</span><span id="__span-0-2559"><a id="__codelineno-0-2559" name="__codelineno-0-2559"></a><span class="sd">            If `None`, the identity matrix is used to check if it spans $\mathbb{R}^\text{self.rows}}$</span>
</span><span id="__span-0-2560"><a id="__codelineno-0-2560" name="__codelineno-0-2560"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate steps:</span>
</span><span id="__span-0-2561"><a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>
</span><span id="__span-0-2562"><a id="__codelineno-0-2562" name="__codelineno-0-2562"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2563"><a id="__codelineno-0-2563" name="__codelineno-0-2563"></a><span class="sd">            - 1: Display the steps.</span>
</span><span id="__span-0-2564"><a id="__codelineno-0-2564" name="__codelineno-0-2564"></a><span class="sd">            - 2: Display the relevant matrices.</span>
</span><span id="__span-0-2565"><a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>
</span><span id="__span-0-2566"><a id="__codelineno-0-2566" name="__codelineno-0-2566"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2567"><a id="__codelineno-0-2567" name="__codelineno-0-2567"></a><span class="sd">        (bool): `True` if the subspace spanned by `self` is a subspace of `other`, `False` otherwise.</span>
</span><span id="__span-0-2568"><a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>
</span><span id="__span-0-2569"><a id="__codelineno-0-2569" name="__codelineno-0-2569"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-2570"><a id="__codelineno-0-2570" name="__codelineno-0-2570"></a><span class="sd">        sympy.matrices.exceptions.ShapeError: If the number of rows in the current matrix and the target matrix are different.</span>
</span><span id="__span-0-2571"><a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>
</span><span id="__span-0-2572"><a id="__codelineno-0-2572" name="__codelineno-0-2572"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2573"><a id="__codelineno-0-2573" name="__codelineno-0-2573"></a><span class="sd">        &gt;&gt;&gt; mat1 = Matrix([[1, 0], [0, 1]])</span>
</span><span id="__span-0-2574"><a id="__codelineno-0-2574" name="__codelineno-0-2574"></a><span class="sd">        &gt;&gt;&gt; mat2 = Matrix([[1], [0]])</span>
</span><span id="__span-0-2575"><a id="__codelineno-0-2575" name="__codelineno-0-2575"></a><span class="sd">        &gt;&gt;&gt; mat2.is_subspace_of(mat1, verbosity=0)</span>
</span><span id="__span-0-2576"><a id="__codelineno-0-2576" name="__codelineno-0-2576"></a><span class="sd">        True</span>
</span><span id="__span-0-2577"><a id="__codelineno-0-2577" name="__codelineno-0-2577"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2578"><a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-2579"><a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">ShapeError</span><span class="p">(</span>
</span><span id="__span-0-2580"><a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>            <span class="sa">f</span><span class="s2">&quot;The matrices have incompatible number of rows (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="__span-0-2581"><a id="__codelineno-0-2581" name="__codelineno-0-2581"></a>        <span class="p">)</span>
</span><span id="__span-0-2582"><a id="__codelineno-0-2582" name="__codelineno-0-2582"></a>
</span><span id="__span-0-2583"><a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>    <span class="n">aug</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-2584"><a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>    <span class="n">sub</span> <span class="o">=</span> <span class="n">aug</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2585"><a id="__codelineno-0-2585" name="__codelineno-0-2585"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="n">RREF</span><span class="p">),</span> <span class="s2">&quot;RREF should return a RREF dataclass&quot;</span>
</span><span id="__span-0-2586"><a id="__codelineno-0-2586" name="__codelineno-0-2586"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2587"><a id="__codelineno-0-2587" name="__codelineno-0-2587"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check rref([other | self])&quot;</span><span class="p">)</span>
</span><span id="__span-0-2588"><a id="__codelineno-0-2588" name="__codelineno-0-2588"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2589"><a id="__codelineno-0-2589" name="__codelineno-0-2589"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check if span(self) is subspace of span(other)&quot;</span><span class="p">)</span>
</span><span id="__span-0-2590"><a id="__codelineno-0-2590" name="__codelineno-0-2590"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Before RREF: [other | self]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2591"><a id="__codelineno-0-2591" name="__codelineno-0-2591"></a>        <span class="n">display</span><span class="p">(</span><span class="n">aug</span><span class="p">)</span>
</span><span id="__span-0-2592"><a id="__codelineno-0-2592" name="__codelineno-0-2592"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2593"><a id="__codelineno-0-2593" name="__codelineno-0-2593"></a>        <span class="n">display</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
</span><span id="__span-0-2594"><a id="__codelineno-0-2594" name="__codelineno-0-2594"></a>        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">pivots</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
</span><span id="__span-0-2595"><a id="__codelineno-0-2595" name="__codelineno-0-2595"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Span(self) is not a subspace of span(other).</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-2596"><a id="__codelineno-0-2596" name="__codelineno-0-2596"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2597"><a id="__codelineno-0-2597" name="__codelineno-0-2597"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Span(self) is a subspace of span(other).</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-2598"><a id="__codelineno-0-2598" name="__codelineno-0-2598"></a>
</span><span id="__span-0-2599"><a id="__codelineno-0-2599" name="__codelineno-0-2599"></a>    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">pivots</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">cols</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.is_same_subspace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_same_subspace</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#ma1522.symbolic.Matrix.is_same_subspace" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if two subspaces are the same by verifying if each subspace is a subspace of the other.</p>
<p>This method determines whether the subspaces spanned by the columns of the current matrix (<code>self</code>)
and the provided matrix (<code>other</code>) are the same. It does so by calling the <code>is_subspace_of</code> method
twice: first to check if <code>self</code> is a subspace of <code>other</code>, and then to check if <code>other</code> is a subspace of <code>self</code>.
If both checks return <code>True</code>, then the subspaces are considered the same.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>other</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>The second matrix representing the other subspace to compare with the current matrix.
If <code>None</code>, the identity matrix is used to check if it spans <span class="arithmatex">\(\mathbb{R}^\text{self.rows}}\)</span></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate steps:</p>
<ul>
<li>0: No output.</li>
<li>1: Display the steps.</li>
<li>2: Display the relevant matrices.
Defaults to 2.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p><code>True</code> if the subspaces spanned by <code>self</code> and <code>other</code> are the same, <code>False</code> otherwise.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.ShapeError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.ShapeError">ShapeError</a></code>
            –
          <div class="doc-md-description">
            <p>If the number of rows in the current matrix and the target matrix are different.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat1</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat2</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat1</span><span class="o">.</span><span class="n">is_same_subspace</span><span class="p">(</span><span class="n">mat2</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">True</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2601">2601</a></span>
<span class="normal"><a href="#__codelineno-0-2602">2602</a></span>
<span class="normal"><a href="#__codelineno-0-2603">2603</a></span>
<span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span>
<span class="normal"><a href="#__codelineno-0-2620">2620</a></span>
<span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span>
<span class="normal"><a href="#__codelineno-0-2624">2624</a></span>
<span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span>
<span class="normal"><a href="#__codelineno-0-2631">2631</a></span>
<span class="normal"><a href="#__codelineno-0-2632">2632</a></span>
<span class="normal"><a href="#__codelineno-0-2633">2633</a></span>
<span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span>
<span class="normal"><a href="#__codelineno-0-2639">2639</a></span>
<span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2601"><a id="__codelineno-0-2601" name="__codelineno-0-2601"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_same_subspace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2602"><a id="__codelineno-0-2602" name="__codelineno-0-2602"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Checks if two subspaces are the same by verifying if each subspace is a subspace of the other.</span>
</span><span id="__span-0-2603"><a id="__codelineno-0-2603" name="__codelineno-0-2603"></a>
</span><span id="__span-0-2604"><a id="__codelineno-0-2604" name="__codelineno-0-2604"></a><span class="sd">    This method determines whether the subspaces spanned by the columns of the current matrix (`self`)</span>
</span><span id="__span-0-2605"><a id="__codelineno-0-2605" name="__codelineno-0-2605"></a><span class="sd">    and the provided matrix (`other`) are the same. It does so by calling the `is_subspace_of` method</span>
</span><span id="__span-0-2606"><a id="__codelineno-0-2606" name="__codelineno-0-2606"></a><span class="sd">    twice: first to check if `self` is a subspace of `other`, and then to check if `other` is a subspace of `self`.</span>
</span><span id="__span-0-2607"><a id="__codelineno-0-2607" name="__codelineno-0-2607"></a><span class="sd">    If both checks return `True`, then the subspaces are considered the same.</span>
</span><span id="__span-0-2608"><a id="__codelineno-0-2608" name="__codelineno-0-2608"></a>
</span><span id="__span-0-2609"><a id="__codelineno-0-2609" name="__codelineno-0-2609"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2610"><a id="__codelineno-0-2610" name="__codelineno-0-2610"></a><span class="sd">        other (Matrix, optional): The second matrix representing the other subspace to compare with the current matrix.</span>
</span><span id="__span-0-2611"><a id="__codelineno-0-2611" name="__codelineno-0-2611"></a><span class="sd">            If `None`, the identity matrix is used to check if it spans $\mathbb{R}^\text{self.rows}}$</span>
</span><span id="__span-0-2612"><a id="__codelineno-0-2612" name="__codelineno-0-2612"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate steps:</span>
</span><span id="__span-0-2613"><a id="__codelineno-0-2613" name="__codelineno-0-2613"></a>
</span><span id="__span-0-2614"><a id="__codelineno-0-2614" name="__codelineno-0-2614"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2615"><a id="__codelineno-0-2615" name="__codelineno-0-2615"></a><span class="sd">            - 1: Display the steps.</span>
</span><span id="__span-0-2616"><a id="__codelineno-0-2616" name="__codelineno-0-2616"></a><span class="sd">            - 2: Display the relevant matrices.</span>
</span><span id="__span-0-2617"><a id="__codelineno-0-2617" name="__codelineno-0-2617"></a><span class="sd">            Defaults to 2.</span>
</span><span id="__span-0-2618"><a id="__codelineno-0-2618" name="__codelineno-0-2618"></a>
</span><span id="__span-0-2619"><a id="__codelineno-0-2619" name="__codelineno-0-2619"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2620"><a id="__codelineno-0-2620" name="__codelineno-0-2620"></a><span class="sd">        (bool): `True` if the subspaces spanned by `self` and `other` are the same, `False` otherwise.</span>
</span><span id="__span-0-2621"><a id="__codelineno-0-2621" name="__codelineno-0-2621"></a>
</span><span id="__span-0-2622"><a id="__codelineno-0-2622" name="__codelineno-0-2622"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-2623"><a id="__codelineno-0-2623" name="__codelineno-0-2623"></a><span class="sd">        sympy.matrices.exceptions.ShapeError: If the number of rows in the current matrix and the target matrix are different.</span>
</span><span id="__span-0-2624"><a id="__codelineno-0-2624" name="__codelineno-0-2624"></a>
</span><span id="__span-0-2625"><a id="__codelineno-0-2625" name="__codelineno-0-2625"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2626"><a id="__codelineno-0-2626" name="__codelineno-0-2626"></a><span class="sd">        &gt;&gt;&gt; mat1 = Matrix([[1, 0], [0, 1]])</span>
</span><span id="__span-0-2627"><a id="__codelineno-0-2627" name="__codelineno-0-2627"></a><span class="sd">        &gt;&gt;&gt; mat2 = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-2628"><a id="__codelineno-0-2628" name="__codelineno-0-2628"></a><span class="sd">        &gt;&gt;&gt; mat1.is_same_subspace(mat2, verbosity=0)</span>
</span><span id="__span-0-2629"><a id="__codelineno-0-2629" name="__codelineno-0-2629"></a><span class="sd">        True</span>
</span><span id="__span-0-2630"><a id="__codelineno-0-2630" name="__codelineno-0-2630"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2631"><a id="__codelineno-0-2631" name="__codelineno-0-2631"></a>    <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-2632"><a id="__codelineno-0-2632" name="__codelineno-0-2632"></a>        <span class="n">rref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2633"><a id="__codelineno-0-2633" name="__codelineno-0-2633"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rref</span><span class="p">,</span> <span class="n">RREF</span><span class="p">),</span> <span class="s2">&quot;RREF should return a RREF dataclass&quot;</span>
</span><span id="__span-0-2634"><a id="__codelineno-0-2634" name="__codelineno-0-2634"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2635"><a id="__codelineno-0-2635" name="__codelineno-0-2635"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check rref(self) does not have zero rows&quot;</span><span class="p">)</span>
</span><span id="__span-0-2636"><a id="__codelineno-0-2636" name="__codelineno-0-2636"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2637"><a id="__codelineno-0-2637" name="__codelineno-0-2637"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: self&quot;</span><span class="p">)</span>
</span><span id="__span-0-2638"><a id="__codelineno-0-2638" name="__codelineno-0-2638"></a>            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-2639"><a id="__codelineno-0-2639" name="__codelineno-0-2639"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2640"><a id="__codelineno-0-2640" name="__codelineno-0-2640"></a>            <span class="n">display</span><span class="p">(</span><span class="n">rref</span><span class="o">.</span><span class="n">rref</span><span class="p">)</span>
</span><span id="__span-0-2641"><a id="__codelineno-0-2641" name="__codelineno-0-2641"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">rref</span><span class="o">.</span><span class="n">pivots</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span>  <span class="c1"># no zero rows</span>
</span><span id="__span-0-2642"><a id="__codelineno-0-2642" name="__codelineno-0-2642"></a>
</span><span id="__span-0-2643"><a id="__codelineno-0-2643" name="__codelineno-0-2643"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-2644"><a id="__codelineno-0-2644" name="__codelineno-0-2644"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">ShapeError</span><span class="p">(</span>
</span><span id="__span-0-2645"><a id="__codelineno-0-2645" name="__codelineno-0-2645"></a>            <span class="sa">f</span><span class="s2">&quot;The matrices have incompatible number of rows (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="__span-0-2646"><a id="__codelineno-0-2646" name="__codelineno-0-2646"></a>        <span class="p">)</span>
</span><span id="__span-0-2647"><a id="__codelineno-0-2647" name="__codelineno-0-2647"></a>
</span><span id="__span-0-2648"><a id="__codelineno-0-2648" name="__codelineno-0-2648"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2649"><a id="__codelineno-0-2649" name="__codelineno-0-2649"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check if span(self) is subspace of span(other), and vice versa.&quot;</span><span class="p">)</span>
</span><span id="__span-0-2650"><a id="__codelineno-0-2650" name="__codelineno-0-2650"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_subspace_of</span><span class="p">(</span>
</span><span id="__span-0-2651"><a id="__codelineno-0-2651" name="__codelineno-0-2651"></a>        <span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span>
</span><span id="__span-0-2652"><a id="__codelineno-0-2652" name="__codelineno-0-2652"></a>    <span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">is_subspace_of</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.coords_relative" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">coords_relative</span><span class="p">(</span><span class="n">basis</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.coords_relative" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the coordinates of the current vector relative to a given basis.</p>
<p>This method finds the coordinate vector <code>c</code> such that <code>self = basis @ c</code>,
where <code>basis</code> is a matrix whose columns form a basis, and <code>self</code> is a column vector. The method
achieves this by augmenting the target matrix with the current matrix, performing
Reduced Row Echelon Form (RREF), and extracting the appropriate part of the resulting matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>basis</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The matrix whose columns form the target basis.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Level of output verbosity.</p>
<ul>
<li>0: No output.</li>
<li>1: Print summary of the RREF and solution.</li>
<li>2: Print the matrix before and after RREF, and show the solution details.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The coordinate vector of <code>self</code> relative to the basis <code>to</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.ShapeError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.ShapeError">ShapeError</a></code>
            –
          <div class="doc-md-description">
            <p>If <code>self</code> is not a column vector
or if the number of rows in <code>self</code> and <code>basis</code> do not match.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            –
          <div class="doc-md-description">
            <p>If the system is inconsistent and no solution exists.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">coords_relative</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[-5]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[ 4]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span>
<span class="normal"><a href="#__codelineno-0-2715">2715</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2654"><a id="__codelineno-0-2654" name="__codelineno-0-2654"></a><span class="k">def</span><span class="w"> </span><span class="nf">coords_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basis</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2655"><a id="__codelineno-0-2655" name="__codelineno-0-2655"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the coordinates of the current vector relative to a given basis.</span>
</span><span id="__span-0-2656"><a id="__codelineno-0-2656" name="__codelineno-0-2656"></a>
</span><span id="__span-0-2657"><a id="__codelineno-0-2657" name="__codelineno-0-2657"></a><span class="sd">    This method finds the coordinate vector `c` such that `self = basis @ c`,</span>
</span><span id="__span-0-2658"><a id="__codelineno-0-2658" name="__codelineno-0-2658"></a><span class="sd">    where `basis` is a matrix whose columns form a basis, and `self` is a column vector. The method</span>
</span><span id="__span-0-2659"><a id="__codelineno-0-2659" name="__codelineno-0-2659"></a><span class="sd">    achieves this by augmenting the target matrix with the current matrix, performing</span>
</span><span id="__span-0-2660"><a id="__codelineno-0-2660" name="__codelineno-0-2660"></a><span class="sd">    Reduced Row Echelon Form (RREF), and extracting the appropriate part of the resulting matrix.</span>
</span><span id="__span-0-2661"><a id="__codelineno-0-2661" name="__codelineno-0-2661"></a>
</span><span id="__span-0-2662"><a id="__codelineno-0-2662" name="__codelineno-0-2662"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2663"><a id="__codelineno-0-2663" name="__codelineno-0-2663"></a><span class="sd">        basis (Matrix): The matrix whose columns form the target basis.</span>
</span><span id="__span-0-2664"><a id="__codelineno-0-2664" name="__codelineno-0-2664"></a>
</span><span id="__span-0-2665"><a id="__codelineno-0-2665" name="__codelineno-0-2665"></a><span class="sd">        verbosity (int, optional): Level of output verbosity.</span>
</span><span id="__span-0-2666"><a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>
</span><span id="__span-0-2667"><a id="__codelineno-0-2667" name="__codelineno-0-2667"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2668"><a id="__codelineno-0-2668" name="__codelineno-0-2668"></a><span class="sd">            - 1: Print summary of the RREF and solution.</span>
</span><span id="__span-0-2669"><a id="__codelineno-0-2669" name="__codelineno-0-2669"></a><span class="sd">            - 2: Print the matrix before and after RREF, and show the solution details.</span>
</span><span id="__span-0-2670"><a id="__codelineno-0-2670" name="__codelineno-0-2670"></a>
</span><span id="__span-0-2671"><a id="__codelineno-0-2671" name="__codelineno-0-2671"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2672"><a id="__codelineno-0-2672" name="__codelineno-0-2672"></a><span class="sd">        (Matrix): The coordinate vector of `self` relative to the basis `to`.</span>
</span><span id="__span-0-2673"><a id="__codelineno-0-2673" name="__codelineno-0-2673"></a>
</span><span id="__span-0-2674"><a id="__codelineno-0-2674" name="__codelineno-0-2674"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-2675"><a id="__codelineno-0-2675" name="__codelineno-0-2675"></a><span class="sd">        sympy.matrices.exceptions.ShapeError: If `self` is not a column vector</span>
</span><span id="__span-0-2676"><a id="__codelineno-0-2676" name="__codelineno-0-2676"></a><span class="sd">            or if the number of rows in `self` and `basis` do not match.</span>
</span><span id="__span-0-2677"><a id="__codelineno-0-2677" name="__codelineno-0-2677"></a><span class="sd">        ValueError: If the system is inconsistent and no solution exists.</span>
</span><span id="__span-0-2678"><a id="__codelineno-0-2678" name="__codelineno-0-2678"></a>
</span><span id="__span-0-2679"><a id="__codelineno-0-2679" name="__codelineno-0-2679"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2680"><a id="__codelineno-0-2680" name="__codelineno-0-2680"></a><span class="sd">        &gt;&gt;&gt; v = Matrix([[3], [7]])</span>
</span><span id="__span-0-2681"><a id="__codelineno-0-2681" name="__codelineno-0-2681"></a><span class="sd">        &gt;&gt;&gt; B = Matrix([[1, 2], [1, 3]])</span>
</span><span id="__span-0-2682"><a id="__codelineno-0-2682" name="__codelineno-0-2682"></a><span class="sd">        &gt;&gt;&gt; v.coords_relative(B, verbosity=0)</span>
</span><span id="__span-0-2683"><a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2684"><a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="sd">        [-5]</span>
</span><span id="__span-0-2685"><a id="__codelineno-0-2685" name="__codelineno-0-2685"></a><span class="sd">        [ 4]</span>
</span><span id="__span-0-2686"><a id="__codelineno-0-2686" name="__codelineno-0-2686"></a><span class="sd">        ])</span>
</span><span id="__span-0-2687"><a id="__codelineno-0-2687" name="__codelineno-0-2687"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2688"><a id="__codelineno-0-2688" name="__codelineno-0-2688"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2689"><a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">ShapeError</span><span class="p">(</span>
</span><span id="__span-0-2690"><a id="__codelineno-0-2690" name="__codelineno-0-2690"></a>            <span class="sa">f</span><span class="s2">&quot;self should be a vector with 1 column. (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="__span-0-2691"><a id="__codelineno-0-2691" name="__codelineno-0-2691"></a>        <span class="p">)</span>
</span><span id="__span-0-2692"><a id="__codelineno-0-2692" name="__codelineno-0-2692"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">!=</span> <span class="n">basis</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-2693"><a id="__codelineno-0-2693" name="__codelineno-0-2693"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">ShapeError</span><span class="p">(</span>
</span><span id="__span-0-2694"><a id="__codelineno-0-2694" name="__codelineno-0-2694"></a>            <span class="sa">f</span><span class="s2">&quot;The matrices have incompatible number of rows (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">basis</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="__span-0-2695"><a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>        <span class="p">)</span>
</span><span id="__span-0-2696"><a id="__codelineno-0-2696" name="__codelineno-0-2696"></a>
</span><span id="__span-0-2697"><a id="__codelineno-0-2697" name="__codelineno-0-2697"></a>    <span class="n">M</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-2698"><a id="__codelineno-0-2698" name="__codelineno-0-2698"></a>    <span class="n">rref</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2699"><a id="__codelineno-0-2699" name="__codelineno-0-2699"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rref</span><span class="p">,</span> <span class="n">RREF</span><span class="p">),</span> <span class="s2">&quot;RREF should return a RREF dataclass&quot;</span>
</span><span id="__span-0-2700"><a id="__codelineno-0-2700" name="__codelineno-0-2700"></a>    <span class="n">rref_mat</span><span class="p">,</span> <span class="n">pivots</span> <span class="o">=</span> <span class="n">rref</span><span class="o">.</span><span class="n">rref</span><span class="p">,</span> <span class="n">rref</span><span class="o">.</span><span class="n">pivots</span>
</span><span id="__span-0-2701"><a id="__codelineno-0-2701" name="__codelineno-0-2701"></a>
</span><span id="__span-0-2702"><a id="__codelineno-0-2702" name="__codelineno-0-2702"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2703"><a id="__codelineno-0-2703" name="__codelineno-0-2703"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solve system via rref([to | self])&quot;</span><span class="p">)</span>
</span><span id="__span-0-2704"><a id="__codelineno-0-2704" name="__codelineno-0-2704"></a>    <span class="k">elif</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2705"><a id="__codelineno-0-2705" name="__codelineno-0-2705"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [to | self]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2706"><a id="__codelineno-0-2706" name="__codelineno-0-2706"></a>        <span class="n">display</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</span><span id="__span-0-2707"><a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2708"><a id="__codelineno-0-2708" name="__codelineno-0-2708"></a>        <span class="n">display</span><span class="p">(</span><span class="n">rref_mat</span><span class="p">)</span>
</span><span id="__span-0-2709"><a id="__codelineno-0-2709" name="__codelineno-0-2709"></a>
</span><span id="__span-0-2710"><a id="__codelineno-0-2710" name="__codelineno-0-2710"></a>    <span class="k">if</span> <span class="n">basis</span><span class="o">.</span><span class="n">cols</span> <span class="ow">in</span> <span class="n">pivots</span><span class="p">:</span>
</span><span id="__span-0-2711"><a id="__codelineno-0-2711" name="__codelineno-0-2711"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No solution found due to inconsistent system.&quot;</span><span class="p">)</span>
</span><span id="__span-0-2712"><a id="__codelineno-0-2712" name="__codelineno-0-2712"></a>
</span><span id="__span-0-2713"><a id="__codelineno-0-2713" name="__codelineno-0-2713"></a>    <span class="n">sol</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># solution should be unique</span>
</span><span id="__span-0-2714"><a id="__codelineno-0-2714" name="__codelineno-0-2714"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">),</span> <span class="s2">&quot;Solution should be a Matrix (vector) object&quot;</span>
</span><span id="__span-0-2715"><a id="__codelineno-0-2715" name="__codelineno-0-2715"></a>    <span class="k">return</span> <span class="n">sol</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.transition_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">transition_matrix</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.transition_matrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the transition matrix that transforms this matrix to another matrix.</p>
<p>This method computes the transition matrix <code>P</code> such that <code>self = P @ to</code>,
where <code>to</code> is the target basis, and <code>self</code> is the current basis. The method
achieves this by augmenting the target matrix with the current matrix, performing
Reduced Row Echelon Form (RREF), and extracting the appropriate part of the resulting matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>to</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The matrix to which the current matrix should be transformed.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Verbosity level for displaying information.</p>
<ul>
<li>0: No output.</li>
<li>1: Display the steps.</li>
<li>2: Display the relevant matrices.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The transition matrix <code>P</code> that satisfies <code>self = P @ to</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            –
          <div class="doc-md-description">
            <p>If the columns of the <code>self</code> matrix and <code>to</code> matrix do not span the same subspace.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat1</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat2</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat1</span><span class="o">.</span><span class="n">transition_matrix</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">mat2</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1/2,   0],</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[  0, 1/2]])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span>
<span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span>
<span class="normal"><a href="#__codelineno-0-2735">2735</a></span>
<span class="normal"><a href="#__codelineno-0-2736">2736</a></span>
<span class="normal"><a href="#__codelineno-0-2737">2737</a></span>
<span class="normal"><a href="#__codelineno-0-2738">2738</a></span>
<span class="normal"><a href="#__codelineno-0-2739">2739</a></span>
<span class="normal"><a href="#__codelineno-0-2740">2740</a></span>
<span class="normal"><a href="#__codelineno-0-2741">2741</a></span>
<span class="normal"><a href="#__codelineno-0-2742">2742</a></span>
<span class="normal"><a href="#__codelineno-0-2743">2743</a></span>
<span class="normal"><a href="#__codelineno-0-2744">2744</a></span>
<span class="normal"><a href="#__codelineno-0-2745">2745</a></span>
<span class="normal"><a href="#__codelineno-0-2746">2746</a></span>
<span class="normal"><a href="#__codelineno-0-2747">2747</a></span>
<span class="normal"><a href="#__codelineno-0-2748">2748</a></span>
<span class="normal"><a href="#__codelineno-0-2749">2749</a></span>
<span class="normal"><a href="#__codelineno-0-2750">2750</a></span>
<span class="normal"><a href="#__codelineno-0-2751">2751</a></span>
<span class="normal"><a href="#__codelineno-0-2752">2752</a></span>
<span class="normal"><a href="#__codelineno-0-2753">2753</a></span>
<span class="normal"><a href="#__codelineno-0-2754">2754</a></span>
<span class="normal"><a href="#__codelineno-0-2755">2755</a></span>
<span class="normal"><a href="#__codelineno-0-2756">2756</a></span>
<span class="normal"><a href="#__codelineno-0-2757">2757</a></span>
<span class="normal"><a href="#__codelineno-0-2758">2758</a></span>
<span class="normal"><a href="#__codelineno-0-2759">2759</a></span>
<span class="normal"><a href="#__codelineno-0-2760">2760</a></span>
<span class="normal"><a href="#__codelineno-0-2761">2761</a></span>
<span class="normal"><a href="#__codelineno-0-2762">2762</a></span>
<span class="normal"><a href="#__codelineno-0-2763">2763</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2717"><a id="__codelineno-0-2717" name="__codelineno-0-2717"></a><span class="k">def</span><span class="w"> </span><span class="nf">transition_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2718"><a id="__codelineno-0-2718" name="__codelineno-0-2718"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the transition matrix that transforms this matrix to another matrix.</span>
</span><span id="__span-0-2719"><a id="__codelineno-0-2719" name="__codelineno-0-2719"></a>
</span><span id="__span-0-2720"><a id="__codelineno-0-2720" name="__codelineno-0-2720"></a><span class="sd">    This method computes the transition matrix `P` such that `self = P @ to`,</span>
</span><span id="__span-0-2721"><a id="__codelineno-0-2721" name="__codelineno-0-2721"></a><span class="sd">    where `to` is the target basis, and `self` is the current basis. The method</span>
</span><span id="__span-0-2722"><a id="__codelineno-0-2722" name="__codelineno-0-2722"></a><span class="sd">    achieves this by augmenting the target matrix with the current matrix, performing</span>
</span><span id="__span-0-2723"><a id="__codelineno-0-2723" name="__codelineno-0-2723"></a><span class="sd">    Reduced Row Echelon Form (RREF), and extracting the appropriate part of the resulting matrix.</span>
</span><span id="__span-0-2724"><a id="__codelineno-0-2724" name="__codelineno-0-2724"></a>
</span><span id="__span-0-2725"><a id="__codelineno-0-2725" name="__codelineno-0-2725"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2726"><a id="__codelineno-0-2726" name="__codelineno-0-2726"></a><span class="sd">        to (Matrix): The matrix to which the current matrix should be transformed.</span>
</span><span id="__span-0-2727"><a id="__codelineno-0-2727" name="__codelineno-0-2727"></a>
</span><span id="__span-0-2728"><a id="__codelineno-0-2728" name="__codelineno-0-2728"></a><span class="sd">        verbosity (int, optional): Verbosity level for displaying information.</span>
</span><span id="__span-0-2729"><a id="__codelineno-0-2729" name="__codelineno-0-2729"></a>
</span><span id="__span-0-2730"><a id="__codelineno-0-2730" name="__codelineno-0-2730"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2731"><a id="__codelineno-0-2731" name="__codelineno-0-2731"></a><span class="sd">            - 1: Display the steps.</span>
</span><span id="__span-0-2732"><a id="__codelineno-0-2732" name="__codelineno-0-2732"></a><span class="sd">            - 2: Display the relevant matrices.</span>
</span><span id="__span-0-2733"><a id="__codelineno-0-2733" name="__codelineno-0-2733"></a>
</span><span id="__span-0-2734"><a id="__codelineno-0-2734" name="__codelineno-0-2734"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2735"><a id="__codelineno-0-2735" name="__codelineno-0-2735"></a><span class="sd">        (Matrix): The transition matrix `P` that satisfies `self = P @ to`.</span>
</span><span id="__span-0-2736"><a id="__codelineno-0-2736" name="__codelineno-0-2736"></a>
</span><span id="__span-0-2737"><a id="__codelineno-0-2737" name="__codelineno-0-2737"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-2738"><a id="__codelineno-0-2738" name="__codelineno-0-2738"></a><span class="sd">        AssertionError: If the columns of the `self` matrix and `to` matrix do not span the same subspace.</span>
</span><span id="__span-0-2739"><a id="__codelineno-0-2739" name="__codelineno-0-2739"></a>
</span><span id="__span-0-2740"><a id="__codelineno-0-2740" name="__codelineno-0-2740"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2741"><a id="__codelineno-0-2741" name="__codelineno-0-2741"></a><span class="sd">        &gt;&gt;&gt; mat1 = Matrix([[1, 0], [0, 1]])</span>
</span><span id="__span-0-2742"><a id="__codelineno-0-2742" name="__codelineno-0-2742"></a><span class="sd">        &gt;&gt;&gt; mat2 = Matrix([[2, 0], [0, 2]])</span>
</span><span id="__span-0-2743"><a id="__codelineno-0-2743" name="__codelineno-0-2743"></a><span class="sd">        &gt;&gt;&gt; mat1.transition_matrix(to=mat2, verbosity=0)</span>
</span><span id="__span-0-2744"><a id="__codelineno-0-2744" name="__codelineno-0-2744"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2745"><a id="__codelineno-0-2745" name="__codelineno-0-2745"></a><span class="sd">        [1/2,   0],</span>
</span><span id="__span-0-2746"><a id="__codelineno-0-2746" name="__codelineno-0-2746"></a><span class="sd">        [  0, 1/2]])</span>
</span><span id="__span-0-2747"><a id="__codelineno-0-2747" name="__codelineno-0-2747"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2748"><a id="__codelineno-0-2748" name="__codelineno-0-2748"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_same_subspace</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-2749"><a id="__codelineno-0-2749" name="__codelineno-0-2749"></a>        <span class="s2">&quot;Column vectors of both matrices must span the same subspace.&quot;</span>
</span><span id="__span-0-2750"><a id="__codelineno-0-2750" name="__codelineno-0-2750"></a>    <span class="p">)</span>
</span><span id="__span-0-2751"><a id="__codelineno-0-2751" name="__codelineno-0-2751"></a>
</span><span id="__span-0-2752"><a id="__codelineno-0-2752" name="__codelineno-0-2752"></a>    <span class="n">M</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-2753"><a id="__codelineno-0-2753" name="__codelineno-0-2753"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">rref</span><span class="p">(</span><span class="n">pivots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-2754"><a id="__codelineno-0-2754" name="__codelineno-0-2754"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">),</span> <span class="s2">&quot;RREF should return a Matrix object&quot;</span>
</span><span id="__span-0-2755"><a id="__codelineno-0-2755" name="__codelineno-0-2755"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2756"><a id="__codelineno-0-2756" name="__codelineno-0-2756"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rref([to | self])&quot;</span><span class="p">)</span>
</span><span id="__span-0-2757"><a id="__codelineno-0-2757" name="__codelineno-0-2757"></a>    <span class="k">elif</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-2758"><a id="__codelineno-0-2758" name="__codelineno-0-2758"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [to | self]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2759"><a id="__codelineno-0-2759" name="__codelineno-0-2759"></a>        <span class="n">display</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</span><span id="__span-0-2760"><a id="__codelineno-0-2760" name="__codelineno-0-2760"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2761"><a id="__codelineno-0-2761" name="__codelineno-0-2761"></a>        <span class="n">display</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="__span-0-2762"><a id="__codelineno-0-2762" name="__codelineno-0-2762"></a>    <span class="n">P</span> <span class="o">=</span> <span class="n">res</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="p">:]</span>
</span><span id="__span-0-2763"><a id="__codelineno-0-2763" name="__codelineno-0-2763"></a>    <span class="k">return</span> <span class="n">P</span>  <span class="c1"># type: ignore</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.nullspace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">nullspace</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span></code>

<a href="#ma1522.symbolic.Matrix.nullspace" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the null space (kernel) of the matrix, i.e., the set of vectors that satisfy <code>self @ x = 0</code>.</p>
<p>This method utilizes the rank-nullity theorem to determine if the null space exists. Fixes the
issue with SymPy <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.nullspace">implementation</a> of nullspace where
it raises an exception if the nullspace is trivial (only contain the zero vector).
If the matrix has full column rank (i.e., rank = number of columns), it has no non-trivial null space,
and an empty list is returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate steps.</p>
<ul>
<li>0: No output.</li>
<li>1: Display the matrix before and after row-reduction (RREF).</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Additional positional arguments passed to SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.nullspace"><code>nullspace</code></a> method.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments passed to SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.nullspace"><code>nullspace</code></a> method.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a>]</code>
          –
          <div class="doc-md-description">
            <p>list[Matrix]: A list of <a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a> objects representing the null space vectors. Returns an empty list if the null space is trivial.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[-2],</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[ 1]])]</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.nullspace"><code>Matrix.nullspace</code></a></li>
<li><a class="autorefs autorefs-internal" title="            orthogonal_complement(verbosity: int = 0) -> Matrix" href="#ma1522.symbolic.Matrix.orthogonal_complement"><code>orthogonal_complement</code></a> for computing the orthogonal complement of the matrix.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2770">2770</a></span>
<span class="normal"><a href="#__codelineno-0-2771">2771</a></span>
<span class="normal"><a href="#__codelineno-0-2772">2772</a></span>
<span class="normal"><a href="#__codelineno-0-2773">2773</a></span>
<span class="normal"><a href="#__codelineno-0-2774">2774</a></span>
<span class="normal"><a href="#__codelineno-0-2775">2775</a></span>
<span class="normal"><a href="#__codelineno-0-2776">2776</a></span>
<span class="normal"><a href="#__codelineno-0-2777">2777</a></span>
<span class="normal"><a href="#__codelineno-0-2778">2778</a></span>
<span class="normal"><a href="#__codelineno-0-2779">2779</a></span>
<span class="normal"><a href="#__codelineno-0-2780">2780</a></span>
<span class="normal"><a href="#__codelineno-0-2781">2781</a></span>
<span class="normal"><a href="#__codelineno-0-2782">2782</a></span>
<span class="normal"><a href="#__codelineno-0-2783">2783</a></span>
<span class="normal"><a href="#__codelineno-0-2784">2784</a></span>
<span class="normal"><a href="#__codelineno-0-2785">2785</a></span>
<span class="normal"><a href="#__codelineno-0-2786">2786</a></span>
<span class="normal"><a href="#__codelineno-0-2787">2787</a></span>
<span class="normal"><a href="#__codelineno-0-2788">2788</a></span>
<span class="normal"><a href="#__codelineno-0-2789">2789</a></span>
<span class="normal"><a href="#__codelineno-0-2790">2790</a></span>
<span class="normal"><a href="#__codelineno-0-2791">2791</a></span>
<span class="normal"><a href="#__codelineno-0-2792">2792</a></span>
<span class="normal"><a href="#__codelineno-0-2793">2793</a></span>
<span class="normal"><a href="#__codelineno-0-2794">2794</a></span>
<span class="normal"><a href="#__codelineno-0-2795">2795</a></span>
<span class="normal"><a href="#__codelineno-0-2796">2796</a></span>
<span class="normal"><a href="#__codelineno-0-2797">2797</a></span>
<span class="normal"><a href="#__codelineno-0-2798">2798</a></span>
<span class="normal"><a href="#__codelineno-0-2799">2799</a></span>
<span class="normal"><a href="#__codelineno-0-2800">2800</a></span>
<span class="normal"><a href="#__codelineno-0-2801">2801</a></span>
<span class="normal"><a href="#__codelineno-0-2802">2802</a></span>
<span class="normal"><a href="#__codelineno-0-2803">2803</a></span>
<span class="normal"><a href="#__codelineno-0-2804">2804</a></span>
<span class="normal"><a href="#__codelineno-0-2805">2805</a></span>
<span class="normal"><a href="#__codelineno-0-2806">2806</a></span>
<span class="normal"><a href="#__codelineno-0-2807">2807</a></span>
<span class="normal"><a href="#__codelineno-0-2808">2808</a></span>
<span class="normal"><a href="#__codelineno-0-2809">2809</a></span>
<span class="normal"><a href="#__codelineno-0-2810">2810</a></span>
<span class="normal"><a href="#__codelineno-0-2811">2811</a></span>
<span class="normal"><a href="#__codelineno-0-2812">2812</a></span>
<span class="normal"><a href="#__codelineno-0-2813">2813</a></span>
<span class="normal"><a href="#__codelineno-0-2814">2814</a></span>
<span class="normal"><a href="#__codelineno-0-2815">2815</a></span>
<span class="normal"><a href="#__codelineno-0-2816">2816</a></span>
<span class="normal"><a href="#__codelineno-0-2817">2817</a></span>
<span class="normal"><a href="#__codelineno-0-2818">2818</a></span>
<span class="normal"><a href="#__codelineno-0-2819">2819</a></span>
<span class="normal"><a href="#__codelineno-0-2820">2820</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2770"><a id="__codelineno-0-2770" name="__codelineno-0-2770"></a><span class="k">def</span><span class="w"> </span><span class="nf">nullspace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]:</span>
</span><span id="__span-0-2771"><a id="__codelineno-0-2771" name="__codelineno-0-2771"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-2772"><a id="__codelineno-0-2772" name="__codelineno-0-2772"></a><span class="sd">    Computes the null space (kernel) of the matrix, i.e., the set of vectors that satisfy `self @ x = 0`.</span>
</span><span id="__span-0-2773"><a id="__codelineno-0-2773" name="__codelineno-0-2773"></a>
</span><span id="__span-0-2774"><a id="__codelineno-0-2774" name="__codelineno-0-2774"></a><span class="sd">    This method utilizes the rank-nullity theorem to determine if the null space exists. Fixes the</span>
</span><span id="__span-0-2775"><a id="__codelineno-0-2775" name="__codelineno-0-2775"></a><span class="sd">    issue with SymPy [implementation][sympy.matrices.matrixbase.MatrixBase.nullspace] of nullspace where</span>
</span><span id="__span-0-2776"><a id="__codelineno-0-2776" name="__codelineno-0-2776"></a><span class="sd">    it raises an exception if the nullspace is trivial (only contain the zero vector).</span>
</span><span id="__span-0-2777"><a id="__codelineno-0-2777" name="__codelineno-0-2777"></a><span class="sd">    If the matrix has full column rank (i.e., rank = number of columns), it has no non-trivial null space,</span>
</span><span id="__span-0-2778"><a id="__codelineno-0-2778" name="__codelineno-0-2778"></a><span class="sd">    and an empty list is returned.</span>
</span><span id="__span-0-2779"><a id="__codelineno-0-2779" name="__codelineno-0-2779"></a>
</span><span id="__span-0-2780"><a id="__codelineno-0-2780" name="__codelineno-0-2780"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2781"><a id="__codelineno-0-2781" name="__codelineno-0-2781"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate steps.</span>
</span><span id="__span-0-2782"><a id="__codelineno-0-2782" name="__codelineno-0-2782"></a>
</span><span id="__span-0-2783"><a id="__codelineno-0-2783" name="__codelineno-0-2783"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2784"><a id="__codelineno-0-2784" name="__codelineno-0-2784"></a><span class="sd">            - 1: Display the matrix before and after row-reduction (RREF).</span>
</span><span id="__span-0-2785"><a id="__codelineno-0-2785" name="__codelineno-0-2785"></a><span class="sd">        *args: Additional positional arguments passed to SymPy&#39;s [`nullspace`][sympy.matrices.matrixbase.MatrixBase.nullspace] method.</span>
</span><span id="__span-0-2786"><a id="__codelineno-0-2786" name="__codelineno-0-2786"></a><span class="sd">        **kwargs: Additional keyword arguments passed to SymPy&#39;s [`nullspace`][sympy.matrices.matrixbase.MatrixBase.nullspace] method.</span>
</span><span id="__span-0-2787"><a id="__codelineno-0-2787" name="__codelineno-0-2787"></a>
</span><span id="__span-0-2788"><a id="__codelineno-0-2788" name="__codelineno-0-2788"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2789"><a id="__codelineno-0-2789" name="__codelineno-0-2789"></a><span class="sd">        list[Matrix]: A list of [`Matrix`][...] objects representing the null space vectors. Returns an empty list if the null space is trivial.</span>
</span><span id="__span-0-2790"><a id="__codelineno-0-2790" name="__codelineno-0-2790"></a>
</span><span id="__span-0-2791"><a id="__codelineno-0-2791" name="__codelineno-0-2791"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2792"><a id="__codelineno-0-2792" name="__codelineno-0-2792"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 6]])</span>
</span><span id="__span-0-2793"><a id="__codelineno-0-2793" name="__codelineno-0-2793"></a><span class="sd">        &gt;&gt;&gt; mat.nullspace()</span>
</span><span id="__span-0-2794"><a id="__codelineno-0-2794" name="__codelineno-0-2794"></a><span class="sd">        [Matrix([</span>
</span><span id="__span-0-2795"><a id="__codelineno-0-2795" name="__codelineno-0-2795"></a><span class="sd">        [-2],</span>
</span><span id="__span-0-2796"><a id="__codelineno-0-2796" name="__codelineno-0-2796"></a><span class="sd">        [ 1]])]</span>
</span><span id="__span-0-2797"><a id="__codelineno-0-2797" name="__codelineno-0-2797"></a>
</span><span id="__span-0-2798"><a id="__codelineno-0-2798" name="__codelineno-0-2798"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-2799"><a id="__codelineno-0-2799" name="__codelineno-0-2799"></a><span class="sd">        - SymPy&#39;s [`Matrix.nullspace`][sympy.matrices.matrixbase.MatrixBase.nullspace]</span>
</span><span id="__span-0-2800"><a id="__codelineno-0-2800" name="__codelineno-0-2800"></a><span class="sd">        - [`orthogonal_complement`][..] for computing the orthogonal complement of the matrix.</span>
</span><span id="__span-0-2801"><a id="__codelineno-0-2801" name="__codelineno-0-2801"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2802"><a id="__codelineno-0-2802" name="__codelineno-0-2802"></a>
</span><span id="__span-0-2803"><a id="__codelineno-0-2803" name="__codelineno-0-2803"></a>    <span class="c1"># Issue with SymPy implementation of nullspace when there is None</span>
</span><span id="__span-0-2804"><a id="__codelineno-0-2804" name="__codelineno-0-2804"></a>    <span class="c1"># Using rank nullity theorem to verify there are vectors spanning nullspace</span>
</span><span id="__span-0-2805"><a id="__codelineno-0-2805" name="__codelineno-0-2805"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2806"><a id="__codelineno-0-2806" name="__codelineno-0-2806"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [self]&quot;</span><span class="p">)</span>
</span><span id="__span-0-2807"><a id="__codelineno-0-2807" name="__codelineno-0-2807"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-2808"><a id="__codelineno-0-2808" name="__codelineno-0-2808"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-2809"><a id="__codelineno-0-2809" name="__codelineno-0-2809"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rref</span><span class="p">())</span>
</span><span id="__span-0-2810"><a id="__codelineno-0-2810" name="__codelineno-0-2810"></a>
</span><span id="__span-0-2811"><a id="__codelineno-0-2811" name="__codelineno-0-2811"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
</span><span id="__span-0-2812"><a id="__codelineno-0-2812" name="__codelineno-0-2812"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2813"><a id="__codelineno-0-2813" name="__codelineno-0-2813"></a>            <span class="n">warn</span><span class="p">(</span>
</span><span id="__span-0-2814"><a id="__codelineno-0-2814" name="__codelineno-0-2814"></a>                <span class="s2">&quot;Only trivial nullspace (0-vector) detected!&quot;</span><span class="p">,</span>
</span><span id="__span-0-2815"><a id="__codelineno-0-2815" name="__codelineno-0-2815"></a>                <span class="ne">UserWarning</span><span class="p">,</span>
</span><span id="__span-0-2816"><a id="__codelineno-0-2816" name="__codelineno-0-2816"></a>                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-2817"><a id="__codelineno-0-2817" name="__codelineno-0-2817"></a>            <span class="p">)</span>
</span><span id="__span-0-2818"><a id="__codelineno-0-2818" name="__codelineno-0-2818"></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="__span-0-2819"><a id="__codelineno-0-2819" name="__codelineno-0-2819"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2820"><a id="__codelineno-0-2820" name="__codelineno-0-2820"></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">nullspace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.nullity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">nullity</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

<a href="#ma1522.symbolic.Matrix.nullity" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the nullity of the matrix, which is the dimension of its null space.</p>
<p>The nullity is defined as the number of free variables in the solution to the homogeneous equation <code>self @ x = 0</code>.
It can be computed as <code>nullity = cols - rank</code>, where <code>cols</code> is the number of columns in the matrix and <code>rank</code> is its rank.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          –
          <div class="doc-md-description">
            <p>The nullity of the matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">1</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2822">2822</a></span>
<span class="normal"><a href="#__codelineno-0-2823">2823</a></span>
<span class="normal"><a href="#__codelineno-0-2824">2824</a></span>
<span class="normal"><a href="#__codelineno-0-2825">2825</a></span>
<span class="normal"><a href="#__codelineno-0-2826">2826</a></span>
<span class="normal"><a href="#__codelineno-0-2827">2827</a></span>
<span class="normal"><a href="#__codelineno-0-2828">2828</a></span>
<span class="normal"><a href="#__codelineno-0-2829">2829</a></span>
<span class="normal"><a href="#__codelineno-0-2830">2830</a></span>
<span class="normal"><a href="#__codelineno-0-2831">2831</a></span>
<span class="normal"><a href="#__codelineno-0-2832">2832</a></span>
<span class="normal"><a href="#__codelineno-0-2833">2833</a></span>
<span class="normal"><a href="#__codelineno-0-2834">2834</a></span>
<span class="normal"><a href="#__codelineno-0-2835">2835</a></span>
<span class="normal"><a href="#__codelineno-0-2836">2836</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2822"><a id="__codelineno-0-2822" name="__codelineno-0-2822"></a><span class="k">def</span><span class="w"> </span><span class="nf">nullity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-0-2823"><a id="__codelineno-0-2823" name="__codelineno-0-2823"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the nullity of the matrix, which is the dimension of its null space.</span>
</span><span id="__span-0-2824"><a id="__codelineno-0-2824" name="__codelineno-0-2824"></a>
</span><span id="__span-0-2825"><a id="__codelineno-0-2825" name="__codelineno-0-2825"></a><span class="sd">    The nullity is defined as the number of free variables in the solution to the homogeneous equation `self @ x = 0`.</span>
</span><span id="__span-0-2826"><a id="__codelineno-0-2826" name="__codelineno-0-2826"></a><span class="sd">    It can be computed as `nullity = cols - rank`, where `cols` is the number of columns in the matrix and `rank` is its rank.</span>
</span><span id="__span-0-2827"><a id="__codelineno-0-2827" name="__codelineno-0-2827"></a>
</span><span id="__span-0-2828"><a id="__codelineno-0-2828" name="__codelineno-0-2828"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2829"><a id="__codelineno-0-2829" name="__codelineno-0-2829"></a><span class="sd">        (int): The nullity of the matrix.</span>
</span><span id="__span-0-2830"><a id="__codelineno-0-2830" name="__codelineno-0-2830"></a>
</span><span id="__span-0-2831"><a id="__codelineno-0-2831" name="__codelineno-0-2831"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2832"><a id="__codelineno-0-2832" name="__codelineno-0-2832"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 6]])</span>
</span><span id="__span-0-2833"><a id="__codelineno-0-2833" name="__codelineno-0-2833"></a><span class="sd">        &gt;&gt;&gt; mat.nullity()</span>
</span><span id="__span-0-2834"><a id="__codelineno-0-2834" name="__codelineno-0-2834"></a><span class="sd">        1</span>
</span><span id="__span-0-2835"><a id="__codelineno-0-2835" name="__codelineno-0-2835"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2836"><a id="__codelineno-0-2836" name="__codelineno-0-2836"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.orthogonal_complement" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">orthogonal_complement</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.orthogonal_complement" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the orthogonal complement of the matrix (the null space of its transpose).</p>
<p>The orthogonal complement consists of all vectors that are orthogonal to the column space of the matrix.
This method computes the null space of the transpose of the matrix, which gives a basis for the orthogonal complement.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>The orthogonal complement is the set of all vectors <code>v</code> such that <code>self^T @ v = 0</code>.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for debugging.</p>
<ul>
<li>0: No output.</li>
<li>1: Display the matrix before and after row-reduction (RREF).</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix whose columns form a basis for the orthogonal complement.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">orthogonal_complement</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[0]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2842">2842</a></span>
<span class="normal"><a href="#__codelineno-0-2843">2843</a></span>
<span class="normal"><a href="#__codelineno-0-2844">2844</a></span>
<span class="normal"><a href="#__codelineno-0-2845">2845</a></span>
<span class="normal"><a href="#__codelineno-0-2846">2846</a></span>
<span class="normal"><a href="#__codelineno-0-2847">2847</a></span>
<span class="normal"><a href="#__codelineno-0-2848">2848</a></span>
<span class="normal"><a href="#__codelineno-0-2849">2849</a></span>
<span class="normal"><a href="#__codelineno-0-2850">2850</a></span>
<span class="normal"><a href="#__codelineno-0-2851">2851</a></span>
<span class="normal"><a href="#__codelineno-0-2852">2852</a></span>
<span class="normal"><a href="#__codelineno-0-2853">2853</a></span>
<span class="normal"><a href="#__codelineno-0-2854">2854</a></span>
<span class="normal"><a href="#__codelineno-0-2855">2855</a></span>
<span class="normal"><a href="#__codelineno-0-2856">2856</a></span>
<span class="normal"><a href="#__codelineno-0-2857">2857</a></span>
<span class="normal"><a href="#__codelineno-0-2858">2858</a></span>
<span class="normal"><a href="#__codelineno-0-2859">2859</a></span>
<span class="normal"><a href="#__codelineno-0-2860">2860</a></span>
<span class="normal"><a href="#__codelineno-0-2861">2861</a></span>
<span class="normal"><a href="#__codelineno-0-2862">2862</a></span>
<span class="normal"><a href="#__codelineno-0-2863">2863</a></span>
<span class="normal"><a href="#__codelineno-0-2864">2864</a></span>
<span class="normal"><a href="#__codelineno-0-2865">2865</a></span>
<span class="normal"><a href="#__codelineno-0-2866">2866</a></span>
<span class="normal"><a href="#__codelineno-0-2867">2867</a></span>
<span class="normal"><a href="#__codelineno-0-2868">2868</a></span>
<span class="normal"><a href="#__codelineno-0-2869">2869</a></span>
<span class="normal"><a href="#__codelineno-0-2870">2870</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2842"><a id="__codelineno-0-2842" name="__codelineno-0-2842"></a><span class="k">def</span><span class="w"> </span><span class="nf">orthogonal_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2843"><a id="__codelineno-0-2843" name="__codelineno-0-2843"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the orthogonal complement of the matrix (the null space of its transpose).</span>
</span><span id="__span-0-2844"><a id="__codelineno-0-2844" name="__codelineno-0-2844"></a>
</span><span id="__span-0-2845"><a id="__codelineno-0-2845" name="__codelineno-0-2845"></a><span class="sd">    The orthogonal complement consists of all vectors that are orthogonal to the column space of the matrix.</span>
</span><span id="__span-0-2846"><a id="__codelineno-0-2846" name="__codelineno-0-2846"></a><span class="sd">    This method computes the null space of the transpose of the matrix, which gives a basis for the orthogonal complement.</span>
</span><span id="__span-0-2847"><a id="__codelineno-0-2847" name="__codelineno-0-2847"></a>
</span><span id="__span-0-2848"><a id="__codelineno-0-2848" name="__codelineno-0-2848"></a><span class="sd">    Note:</span>
</span><span id="__span-0-2849"><a id="__codelineno-0-2849" name="__codelineno-0-2849"></a><span class="sd">        The orthogonal complement is the set of all vectors `v` such that `self^T @ v = 0`.</span>
</span><span id="__span-0-2850"><a id="__codelineno-0-2850" name="__codelineno-0-2850"></a>
</span><span id="__span-0-2851"><a id="__codelineno-0-2851" name="__codelineno-0-2851"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2852"><a id="__codelineno-0-2852" name="__codelineno-0-2852"></a><span class="sd">        verbosity (int, optional): Level of verbosity for debugging.</span>
</span><span id="__span-0-2853"><a id="__codelineno-0-2853" name="__codelineno-0-2853"></a>
</span><span id="__span-0-2854"><a id="__codelineno-0-2854" name="__codelineno-0-2854"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2855"><a id="__codelineno-0-2855" name="__codelineno-0-2855"></a><span class="sd">            - 1: Display the matrix before and after row-reduction (RREF).</span>
</span><span id="__span-0-2856"><a id="__codelineno-0-2856" name="__codelineno-0-2856"></a>
</span><span id="__span-0-2857"><a id="__codelineno-0-2857" name="__codelineno-0-2857"></a>
</span><span id="__span-0-2858"><a id="__codelineno-0-2858" name="__codelineno-0-2858"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2859"><a id="__codelineno-0-2859" name="__codelineno-0-2859"></a><span class="sd">        (Matrix): A matrix whose columns form a basis for the orthogonal complement.</span>
</span><span id="__span-0-2860"><a id="__codelineno-0-2860" name="__codelineno-0-2860"></a>
</span><span id="__span-0-2861"><a id="__codelineno-0-2861" name="__codelineno-0-2861"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2862"><a id="__codelineno-0-2862" name="__codelineno-0-2862"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 0], [0, 0]])</span>
</span><span id="__span-0-2863"><a id="__codelineno-0-2863" name="__codelineno-0-2863"></a><span class="sd">        &gt;&gt;&gt; mat.orthogonal_complement()</span>
</span><span id="__span-0-2864"><a id="__codelineno-0-2864" name="__codelineno-0-2864"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-2865"><a id="__codelineno-0-2865" name="__codelineno-0-2865"></a><span class="sd">        [0]</span>
</span><span id="__span-0-2866"><a id="__codelineno-0-2866" name="__codelineno-0-2866"></a><span class="sd">        [1]</span>
</span><span id="__span-0-2867"><a id="__codelineno-0-2867" name="__codelineno-0-2867"></a><span class="sd">        ])</span>
</span><span id="__span-0-2868"><a id="__codelineno-0-2868" name="__codelineno-0-2868"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2869"><a id="__codelineno-0-2869" name="__codelineno-0-2869"></a>
</span><span id="__span-0-2870"><a id="__codelineno-0-2870" name="__codelineno-0-2870"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">nullspace</span><span class="p">(</span><span class="n">verbosity</span><span class="p">))</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.is_vec_orthogonal" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_vec_orthogonal</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#ma1522.symbolic.Matrix.is_vec_orthogonal" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if the column vectors of the matrix are orthogonal to each other.</p>
<p>This method computes <code>self^T @ self</code> and checks if the result is diagonal.
If the result is diagonal, the vectors are orthogonal (i.e., <span class="arithmatex">\(u_i \dot u_j = 0 \forall i != j\)</span>).</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This method checks for orthogonality, not orthonormality. For orthonormality, use <a class="autorefs autorefs-internal" title="            is_mat_orthogonal(verbosity: int = 1) -> bool" href="#ma1522.symbolic.Matrix.is_mat_orthogonal"><code>is_mat_orthogonal</code></a>.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate results.</p>
<ul>
<li>0: No output.</li>
<li>1: Display the matrix product <code>self.T @ self</code>.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p><code>True</code> if the column vectors are orthogonal, <code>False</code> otherwise.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_vec_orthogonal</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">True</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2872">2872</a></span>
<span class="normal"><a href="#__codelineno-0-2873">2873</a></span>
<span class="normal"><a href="#__codelineno-0-2874">2874</a></span>
<span class="normal"><a href="#__codelineno-0-2875">2875</a></span>
<span class="normal"><a href="#__codelineno-0-2876">2876</a></span>
<span class="normal"><a href="#__codelineno-0-2877">2877</a></span>
<span class="normal"><a href="#__codelineno-0-2878">2878</a></span>
<span class="normal"><a href="#__codelineno-0-2879">2879</a></span>
<span class="normal"><a href="#__codelineno-0-2880">2880</a></span>
<span class="normal"><a href="#__codelineno-0-2881">2881</a></span>
<span class="normal"><a href="#__codelineno-0-2882">2882</a></span>
<span class="normal"><a href="#__codelineno-0-2883">2883</a></span>
<span class="normal"><a href="#__codelineno-0-2884">2884</a></span>
<span class="normal"><a href="#__codelineno-0-2885">2885</a></span>
<span class="normal"><a href="#__codelineno-0-2886">2886</a></span>
<span class="normal"><a href="#__codelineno-0-2887">2887</a></span>
<span class="normal"><a href="#__codelineno-0-2888">2888</a></span>
<span class="normal"><a href="#__codelineno-0-2889">2889</a></span>
<span class="normal"><a href="#__codelineno-0-2890">2890</a></span>
<span class="normal"><a href="#__codelineno-0-2891">2891</a></span>
<span class="normal"><a href="#__codelineno-0-2892">2892</a></span>
<span class="normal"><a href="#__codelineno-0-2893">2893</a></span>
<span class="normal"><a href="#__codelineno-0-2894">2894</a></span>
<span class="normal"><a href="#__codelineno-0-2895">2895</a></span>
<span class="normal"><a href="#__codelineno-0-2896">2896</a></span>
<span class="normal"><a href="#__codelineno-0-2897">2897</a></span>
<span class="normal"><a href="#__codelineno-0-2898">2898</a></span>
<span class="normal"><a href="#__codelineno-0-2899">2899</a></span>
<span class="normal"><a href="#__codelineno-0-2900">2900</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2872"><a id="__codelineno-0-2872" name="__codelineno-0-2872"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_vec_orthogonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2873"><a id="__codelineno-0-2873" name="__codelineno-0-2873"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Checks if the column vectors of the matrix are orthogonal to each other.</span>
</span><span id="__span-0-2874"><a id="__codelineno-0-2874" name="__codelineno-0-2874"></a>
</span><span id="__span-0-2875"><a id="__codelineno-0-2875" name="__codelineno-0-2875"></a><span class="sd">    This method computes `self^T @ self` and checks if the result is diagonal.</span>
</span><span id="__span-0-2876"><a id="__codelineno-0-2876" name="__codelineno-0-2876"></a><span class="sd">    If the result is diagonal, the vectors are orthogonal (i.e., $u_i \dot u_j = 0 \forall i != j$).</span>
</span><span id="__span-0-2877"><a id="__codelineno-0-2877" name="__codelineno-0-2877"></a>
</span><span id="__span-0-2878"><a id="__codelineno-0-2878" name="__codelineno-0-2878"></a><span class="sd">    Note:</span>
</span><span id="__span-0-2879"><a id="__codelineno-0-2879" name="__codelineno-0-2879"></a><span class="sd">        This method checks for orthogonality, not orthonormality. For orthonormality, use [`is_mat_orthogonal`][..].</span>
</span><span id="__span-0-2880"><a id="__codelineno-0-2880" name="__codelineno-0-2880"></a>
</span><span id="__span-0-2881"><a id="__codelineno-0-2881" name="__codelineno-0-2881"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2882"><a id="__codelineno-0-2882" name="__codelineno-0-2882"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate results.</span>
</span><span id="__span-0-2883"><a id="__codelineno-0-2883" name="__codelineno-0-2883"></a>
</span><span id="__span-0-2884"><a id="__codelineno-0-2884" name="__codelineno-0-2884"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2885"><a id="__codelineno-0-2885" name="__codelineno-0-2885"></a><span class="sd">            - 1: Display the matrix product `self.T @ self`.</span>
</span><span id="__span-0-2886"><a id="__codelineno-0-2886" name="__codelineno-0-2886"></a>
</span><span id="__span-0-2887"><a id="__codelineno-0-2887" name="__codelineno-0-2887"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2888"><a id="__codelineno-0-2888" name="__codelineno-0-2888"></a><span class="sd">        (bool): `True` if the column vectors are orthogonal, `False` otherwise.</span>
</span><span id="__span-0-2889"><a id="__codelineno-0-2889" name="__codelineno-0-2889"></a>
</span><span id="__span-0-2890"><a id="__codelineno-0-2890" name="__codelineno-0-2890"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2891"><a id="__codelineno-0-2891" name="__codelineno-0-2891"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 0], [0, 2]])</span>
</span><span id="__span-0-2892"><a id="__codelineno-0-2892" name="__codelineno-0-2892"></a><span class="sd">        &gt;&gt;&gt; mat.is_vec_orthogonal(verbosity=0)</span>
</span><span id="__span-0-2893"><a id="__codelineno-0-2893" name="__codelineno-0-2893"></a><span class="sd">        True</span>
</span><span id="__span-0-2894"><a id="__codelineno-0-2894" name="__codelineno-0-2894"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2895"><a id="__codelineno-0-2895" name="__codelineno-0-2895"></a>
</span><span id="__span-0-2896"><a id="__codelineno-0-2896" name="__codelineno-0-2896"></a>    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span>
</span><span id="__span-0-2897"><a id="__codelineno-0-2897" name="__codelineno-0-2897"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2898"><a id="__codelineno-0-2898" name="__codelineno-0-2898"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check if [self^T @ self] is a diagonal matrix&quot;</span><span class="p">)</span>
</span><span id="__span-0-2899"><a id="__codelineno-0-2899" name="__codelineno-0-2899"></a>        <span class="n">display</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="__span-0-2900"><a id="__codelineno-0-2900" name="__codelineno-0-2900"></a>    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">is_diagonal</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.is_mat_orthogonal" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_mat_orthogonal</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#ma1522.symbolic.Matrix.is_mat_orthogonal" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if the matrix is orthogonal (i.e., its columns are orthonormal).</p>
<p>A matrix is orthogonal if its columns are orthonormal, i.e., if <code>self.T @ self</code> is the identity matrix.
This method computes <code>self.T @ self</code> and checks if the result is an identity matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate results.</p>
<ul>
<li>0: No output.</li>
<li>1: Display the matrix product <code>self.T @ self</code>.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p>True if the matrix is orthogonal, False otherwise.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_mat_orthogonal</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">True</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_mat_orthogonal</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">False</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2902">2902</a></span>
<span class="normal"><a href="#__codelineno-0-2903">2903</a></span>
<span class="normal"><a href="#__codelineno-0-2904">2904</a></span>
<span class="normal"><a href="#__codelineno-0-2905">2905</a></span>
<span class="normal"><a href="#__codelineno-0-2906">2906</a></span>
<span class="normal"><a href="#__codelineno-0-2907">2907</a></span>
<span class="normal"><a href="#__codelineno-0-2908">2908</a></span>
<span class="normal"><a href="#__codelineno-0-2909">2909</a></span>
<span class="normal"><a href="#__codelineno-0-2910">2910</a></span>
<span class="normal"><a href="#__codelineno-0-2911">2911</a></span>
<span class="normal"><a href="#__codelineno-0-2912">2912</a></span>
<span class="normal"><a href="#__codelineno-0-2913">2913</a></span>
<span class="normal"><a href="#__codelineno-0-2914">2914</a></span>
<span class="normal"><a href="#__codelineno-0-2915">2915</a></span>
<span class="normal"><a href="#__codelineno-0-2916">2916</a></span>
<span class="normal"><a href="#__codelineno-0-2917">2917</a></span>
<span class="normal"><a href="#__codelineno-0-2918">2918</a></span>
<span class="normal"><a href="#__codelineno-0-2919">2919</a></span>
<span class="normal"><a href="#__codelineno-0-2920">2920</a></span>
<span class="normal"><a href="#__codelineno-0-2921">2921</a></span>
<span class="normal"><a href="#__codelineno-0-2922">2922</a></span>
<span class="normal"><a href="#__codelineno-0-2923">2923</a></span>
<span class="normal"><a href="#__codelineno-0-2924">2924</a></span>
<span class="normal"><a href="#__codelineno-0-2925">2925</a></span>
<span class="normal"><a href="#__codelineno-0-2926">2926</a></span>
<span class="normal"><a href="#__codelineno-0-2927">2927</a></span>
<span class="normal"><a href="#__codelineno-0-2928">2928</a></span>
<span class="normal"><a href="#__codelineno-0-2929">2929</a></span>
<span class="normal"><a href="#__codelineno-0-2930">2930</a></span>
<span class="normal"><a href="#__codelineno-0-2931">2931</a></span>
<span class="normal"><a href="#__codelineno-0-2932">2932</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2902"><a id="__codelineno-0-2902" name="__codelineno-0-2902"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_mat_orthogonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-2903"><a id="__codelineno-0-2903" name="__codelineno-0-2903"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-2904"><a id="__codelineno-0-2904" name="__codelineno-0-2904"></a><span class="sd">    Checks if the matrix is orthogonal (i.e., its columns are orthonormal).</span>
</span><span id="__span-0-2905"><a id="__codelineno-0-2905" name="__codelineno-0-2905"></a>
</span><span id="__span-0-2906"><a id="__codelineno-0-2906" name="__codelineno-0-2906"></a><span class="sd">    A matrix is orthogonal if its columns are orthonormal, i.e., if `self.T @ self` is the identity matrix.</span>
</span><span id="__span-0-2907"><a id="__codelineno-0-2907" name="__codelineno-0-2907"></a><span class="sd">    This method computes `self.T @ self` and checks if the result is an identity matrix.</span>
</span><span id="__span-0-2908"><a id="__codelineno-0-2908" name="__codelineno-0-2908"></a>
</span><span id="__span-0-2909"><a id="__codelineno-0-2909" name="__codelineno-0-2909"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2910"><a id="__codelineno-0-2910" name="__codelineno-0-2910"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate results.</span>
</span><span id="__span-0-2911"><a id="__codelineno-0-2911" name="__codelineno-0-2911"></a>
</span><span id="__span-0-2912"><a id="__codelineno-0-2912" name="__codelineno-0-2912"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2913"><a id="__codelineno-0-2913" name="__codelineno-0-2913"></a><span class="sd">            - 1: Display the matrix product `self.T @ self`.</span>
</span><span id="__span-0-2914"><a id="__codelineno-0-2914" name="__codelineno-0-2914"></a>
</span><span id="__span-0-2915"><a id="__codelineno-0-2915" name="__codelineno-0-2915"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2916"><a id="__codelineno-0-2916" name="__codelineno-0-2916"></a><span class="sd">        (bool): True if the matrix is orthogonal, False otherwise.</span>
</span><span id="__span-0-2917"><a id="__codelineno-0-2917" name="__codelineno-0-2917"></a>
</span><span id="__span-0-2918"><a id="__codelineno-0-2918" name="__codelineno-0-2918"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2919"><a id="__codelineno-0-2919" name="__codelineno-0-2919"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 0], [0, 1]])</span>
</span><span id="__span-0-2920"><a id="__codelineno-0-2920" name="__codelineno-0-2920"></a><span class="sd">        &gt;&gt;&gt; mat.is_mat_orthogonal(verbosity=0)</span>
</span><span id="__span-0-2921"><a id="__codelineno-0-2921" name="__codelineno-0-2921"></a><span class="sd">        True</span>
</span><span id="__span-0-2922"><a id="__codelineno-0-2922" name="__codelineno-0-2922"></a>
</span><span id="__span-0-2923"><a id="__codelineno-0-2923" name="__codelineno-0-2923"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 0], [0, 2]])</span>
</span><span id="__span-0-2924"><a id="__codelineno-0-2924" name="__codelineno-0-2924"></a><span class="sd">        &gt;&gt;&gt; mat.is_mat_orthogonal(verbosity=0)</span>
</span><span id="__span-0-2925"><a id="__codelineno-0-2925" name="__codelineno-0-2925"></a><span class="sd">        False</span>
</span><span id="__span-0-2926"><a id="__codelineno-0-2926" name="__codelineno-0-2926"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2927"><a id="__codelineno-0-2927" name="__codelineno-0-2927"></a>
</span><span id="__span-0-2928"><a id="__codelineno-0-2928" name="__codelineno-0-2928"></a>    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span>
</span><span id="__span-0-2929"><a id="__codelineno-0-2929" name="__codelineno-0-2929"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2930"><a id="__codelineno-0-2930" name="__codelineno-0-2930"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self^T @ self&quot;</span><span class="p">)</span>
</span><span id="__span-0-2931"><a id="__codelineno-0-2931" name="__codelineno-0-2931"></a>        <span class="n">display</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="__span-0-2932"><a id="__codelineno-0-2932" name="__codelineno-0-2932"></a>    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">is_diagonal</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">entry</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">diagonal</span><span class="p">())</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.orthogonal_decomposition" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">orthogonal_decomposition</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecDecomp</span></code>

<a href="#ma1522.symbolic.Matrix.orthogonal_decomposition" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Decomposes the current vector (or matrix) into its orthogonal projection onto a subspace and its orthogonal complement.</p>
<p>This method computes the orthogonal decomposition of <code>self</code> relative to the subspace spanned by the columns of <code>to</code>.
It finds the projection of <code>self</code> onto the subspace (<code>proj</code>) and the component orthogonal to the subspace (<code>norm</code>), such that:
    <code>self = proj + norm</code></p>
<p>The projection is computed using the least squares solution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>to</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The matrix whose columns form the subspace onto which to project <code>self</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate results.</p>
<ul>
<li>0: No output.</li>
<li>1: Display the projected and normal components.</li>
<li>2: Display detailed steps.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              VecDecomp(proj: Matrix, norm: Matrix)

  
      dataclass
   (ma1522.custom_types.VecDecomp)" href="../custom_types/#ma1522.custom_types.VecDecomp">VecDecomp</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass with fields:</p>
<ul>
<li>proj (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The projection of <code>self</code> onto the subspace spanned by <code>to</code>.</li>
<li>norm (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The component of <code>self</code> orthogonal to the subspace spanned by <code>to</code>.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span>
<span class="normal"><a href="#__codelineno-0-8">8</a></span>
<span class="normal"><a href="#__codelineno-0-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">orthogonal_decomposition</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">VecDecomp(proj=Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3],</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[0]]), norm=Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[0]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[4]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2934">2934</a></span>
<span class="normal"><a href="#__codelineno-0-2935">2935</a></span>
<span class="normal"><a href="#__codelineno-0-2936">2936</a></span>
<span class="normal"><a href="#__codelineno-0-2937">2937</a></span>
<span class="normal"><a href="#__codelineno-0-2938">2938</a></span>
<span class="normal"><a href="#__codelineno-0-2939">2939</a></span>
<span class="normal"><a href="#__codelineno-0-2940">2940</a></span>
<span class="normal"><a href="#__codelineno-0-2941">2941</a></span>
<span class="normal"><a href="#__codelineno-0-2942">2942</a></span>
<span class="normal"><a href="#__codelineno-0-2943">2943</a></span>
<span class="normal"><a href="#__codelineno-0-2944">2944</a></span>
<span class="normal"><a href="#__codelineno-0-2945">2945</a></span>
<span class="normal"><a href="#__codelineno-0-2946">2946</a></span>
<span class="normal"><a href="#__codelineno-0-2947">2947</a></span>
<span class="normal"><a href="#__codelineno-0-2948">2948</a></span>
<span class="normal"><a href="#__codelineno-0-2949">2949</a></span>
<span class="normal"><a href="#__codelineno-0-2950">2950</a></span>
<span class="normal"><a href="#__codelineno-0-2951">2951</a></span>
<span class="normal"><a href="#__codelineno-0-2952">2952</a></span>
<span class="normal"><a href="#__codelineno-0-2953">2953</a></span>
<span class="normal"><a href="#__codelineno-0-2954">2954</a></span>
<span class="normal"><a href="#__codelineno-0-2955">2955</a></span>
<span class="normal"><a href="#__codelineno-0-2956">2956</a></span>
<span class="normal"><a href="#__codelineno-0-2957">2957</a></span>
<span class="normal"><a href="#__codelineno-0-2958">2958</a></span>
<span class="normal"><a href="#__codelineno-0-2959">2959</a></span>
<span class="normal"><a href="#__codelineno-0-2960">2960</a></span>
<span class="normal"><a href="#__codelineno-0-2961">2961</a></span>
<span class="normal"><a href="#__codelineno-0-2962">2962</a></span>
<span class="normal"><a href="#__codelineno-0-2963">2963</a></span>
<span class="normal"><a href="#__codelineno-0-2964">2964</a></span>
<span class="normal"><a href="#__codelineno-0-2965">2965</a></span>
<span class="normal"><a href="#__codelineno-0-2966">2966</a></span>
<span class="normal"><a href="#__codelineno-0-2967">2967</a></span>
<span class="normal"><a href="#__codelineno-0-2968">2968</a></span>
<span class="normal"><a href="#__codelineno-0-2969">2969</a></span>
<span class="normal"><a href="#__codelineno-0-2970">2970</a></span>
<span class="normal"><a href="#__codelineno-0-2971">2971</a></span>
<span class="normal"><a href="#__codelineno-0-2972">2972</a></span>
<span class="normal"><a href="#__codelineno-0-2973">2973</a></span>
<span class="normal"><a href="#__codelineno-0-2974">2974</a></span>
<span class="normal"><a href="#__codelineno-0-2975">2975</a></span>
<span class="normal"><a href="#__codelineno-0-2976">2976</a></span>
<span class="normal"><a href="#__codelineno-0-2977">2977</a></span>
<span class="normal"><a href="#__codelineno-0-2978">2978</a></span>
<span class="normal"><a href="#__codelineno-0-2979">2979</a></span>
<span class="normal"><a href="#__codelineno-0-2980">2980</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2934"><a id="__codelineno-0-2934" name="__codelineno-0-2934"></a><span class="k">def</span><span class="w"> </span><span class="nf">orthogonal_decomposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VecDecomp</span><span class="p">:</span>
</span><span id="__span-0-2935"><a id="__codelineno-0-2935" name="__codelineno-0-2935"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decomposes the current vector (or matrix) into its orthogonal projection onto a subspace and its orthogonal complement.</span>
</span><span id="__span-0-2936"><a id="__codelineno-0-2936" name="__codelineno-0-2936"></a>
</span><span id="__span-0-2937"><a id="__codelineno-0-2937" name="__codelineno-0-2937"></a><span class="sd">    This method computes the orthogonal decomposition of `self` relative to the subspace spanned by the columns of `to`.</span>
</span><span id="__span-0-2938"><a id="__codelineno-0-2938" name="__codelineno-0-2938"></a><span class="sd">    It finds the projection of `self` onto the subspace (`proj`) and the component orthogonal to the subspace (`norm`), such that:</span>
</span><span id="__span-0-2939"><a id="__codelineno-0-2939" name="__codelineno-0-2939"></a><span class="sd">        `self = proj + norm`</span>
</span><span id="__span-0-2940"><a id="__codelineno-0-2940" name="__codelineno-0-2940"></a>
</span><span id="__span-0-2941"><a id="__codelineno-0-2941" name="__codelineno-0-2941"></a><span class="sd">    The projection is computed using the least squares solution.</span>
</span><span id="__span-0-2942"><a id="__codelineno-0-2942" name="__codelineno-0-2942"></a>
</span><span id="__span-0-2943"><a id="__codelineno-0-2943" name="__codelineno-0-2943"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2944"><a id="__codelineno-0-2944" name="__codelineno-0-2944"></a><span class="sd">        to (Matrix): The matrix whose columns form the subspace onto which to project `self`.</span>
</span><span id="__span-0-2945"><a id="__codelineno-0-2945" name="__codelineno-0-2945"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate results.</span>
</span><span id="__span-0-2946"><a id="__codelineno-0-2946" name="__codelineno-0-2946"></a>
</span><span id="__span-0-2947"><a id="__codelineno-0-2947" name="__codelineno-0-2947"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2948"><a id="__codelineno-0-2948" name="__codelineno-0-2948"></a><span class="sd">            - 1: Display the projected and normal components.</span>
</span><span id="__span-0-2949"><a id="__codelineno-0-2949" name="__codelineno-0-2949"></a><span class="sd">            - 2: Display detailed steps.</span>
</span><span id="__span-0-2950"><a id="__codelineno-0-2950" name="__codelineno-0-2950"></a>
</span><span id="__span-0-2951"><a id="__codelineno-0-2951" name="__codelineno-0-2951"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2952"><a id="__codelineno-0-2952" name="__codelineno-0-2952"></a><span class="sd">        (VecDecomp): A dataclass with fields:</span>
</span><span id="__span-0-2953"><a id="__codelineno-0-2953" name="__codelineno-0-2953"></a>
</span><span id="__span-0-2954"><a id="__codelineno-0-2954" name="__codelineno-0-2954"></a><span class="sd">            - proj ([`Matrix`][...]): The projection of `self` onto the subspace spanned by `to`.</span>
</span><span id="__span-0-2955"><a id="__codelineno-0-2955" name="__codelineno-0-2955"></a><span class="sd">            - norm ([`Matrix`][...]): The component of `self` orthogonal to the subspace spanned by `to`.</span>
</span><span id="__span-0-2956"><a id="__codelineno-0-2956" name="__codelineno-0-2956"></a>
</span><span id="__span-0-2957"><a id="__codelineno-0-2957" name="__codelineno-0-2957"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2958"><a id="__codelineno-0-2958" name="__codelineno-0-2958"></a><span class="sd">        &gt;&gt;&gt; v = Matrix([[3], [4]])</span>
</span><span id="__span-0-2959"><a id="__codelineno-0-2959" name="__codelineno-0-2959"></a><span class="sd">        &gt;&gt;&gt; B = Matrix([[1], [0]])</span>
</span><span id="__span-0-2960"><a id="__codelineno-0-2960" name="__codelineno-0-2960"></a><span class="sd">        &gt;&gt;&gt; v.orthogonal_decomposition(B)</span>
</span><span id="__span-0-2961"><a id="__codelineno-0-2961" name="__codelineno-0-2961"></a><span class="sd">        VecDecomp(proj=Matrix([</span>
</span><span id="__span-0-2962"><a id="__codelineno-0-2962" name="__codelineno-0-2962"></a><span class="sd">        [3],</span>
</span><span id="__span-0-2963"><a id="__codelineno-0-2963" name="__codelineno-0-2963"></a><span class="sd">        [0]]), norm=Matrix([</span>
</span><span id="__span-0-2964"><a id="__codelineno-0-2964" name="__codelineno-0-2964"></a><span class="sd">        [0]</span>
</span><span id="__span-0-2965"><a id="__codelineno-0-2965" name="__codelineno-0-2965"></a><span class="sd">        [4]</span>
</span><span id="__span-0-2966"><a id="__codelineno-0-2966" name="__codelineno-0-2966"></a><span class="sd">        ]))</span>
</span><span id="__span-0-2967"><a id="__codelineno-0-2967" name="__codelineno-0-2967"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-2968"><a id="__codelineno-0-2968" name="__codelineno-0-2968"></a>
</span><span id="__span-0-2969"><a id="__codelineno-0-2969" name="__codelineno-0-2969"></a>    <span class="n">sol</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">solve_least_squares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</span><span id="__span-0-2970"><a id="__codelineno-0-2970" name="__codelineno-0-2970"></a>    <span class="n">proj</span> <span class="o">=</span> <span class="n">to</span> <span class="o">@</span> <span class="n">sol</span>
</span><span id="__span-0-2971"><a id="__codelineno-0-2971" name="__codelineno-0-2971"></a>    <span class="n">norm</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">proj</span>
</span><span id="__span-0-2972"><a id="__codelineno-0-2972" name="__codelineno-0-2972"></a>
</span><span id="__span-0-2973"><a id="__codelineno-0-2973" name="__codelineno-0-2973"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-2974"><a id="__codelineno-0-2974" name="__codelineno-0-2974"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Projected component: Au&quot;</span><span class="p">)</span>
</span><span id="__span-0-2975"><a id="__codelineno-0-2975" name="__codelineno-0-2975"></a>        <span class="n">display</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
</span><span id="__span-0-2976"><a id="__codelineno-0-2976" name="__codelineno-0-2976"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Normal component: b - b_proj&quot;</span><span class="p">)</span>
</span><span id="__span-0-2977"><a id="__codelineno-0-2977" name="__codelineno-0-2977"></a>        <span class="n">display</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
</span><span id="__span-0-2978"><a id="__codelineno-0-2978" name="__codelineno-0-2978"></a>
</span><span id="__span-0-2979"><a id="__codelineno-0-2979" name="__codelineno-0-2979"></a>    <span class="k">assert</span> <span class="n">proj</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">==</span> <span class="bp">self</span>
</span><span id="__span-0-2980"><a id="__codelineno-0-2980" name="__codelineno-0-2980"></a>    <span class="k">return</span> <span class="n">VecDecomp</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.proj_comp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">proj_comp</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.proj_comp" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the orthogonal projection of the current vector (or matrix) onto the subspace spanned by the columns of another matrix.</p>
<p>This method returns the component of <code>self</code> that lies in the subspace defined by the columns of <code>to</code>.
It is equivalent to the projection of <code>self</code> onto the subspace, as computed by the orthogonal decomposition.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>to</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The matrix whose columns form the subspace onto which to project <code>self</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate results.</p>
<ul>
<li>0: No output.</li>
<li>1: Display the projected component.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The projection of <code>self</code> onto the subspace spanned by <code>to</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">proj_comp</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3],</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[0]])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2982">2982</a></span>
<span class="normal"><a href="#__codelineno-0-2983">2983</a></span>
<span class="normal"><a href="#__codelineno-0-2984">2984</a></span>
<span class="normal"><a href="#__codelineno-0-2985">2985</a></span>
<span class="normal"><a href="#__codelineno-0-2986">2986</a></span>
<span class="normal"><a href="#__codelineno-0-2987">2987</a></span>
<span class="normal"><a href="#__codelineno-0-2988">2988</a></span>
<span class="normal"><a href="#__codelineno-0-2989">2989</a></span>
<span class="normal"><a href="#__codelineno-0-2990">2990</a></span>
<span class="normal"><a href="#__codelineno-0-2991">2991</a></span>
<span class="normal"><a href="#__codelineno-0-2992">2992</a></span>
<span class="normal"><a href="#__codelineno-0-2993">2993</a></span>
<span class="normal"><a href="#__codelineno-0-2994">2994</a></span>
<span class="normal"><a href="#__codelineno-0-2995">2995</a></span>
<span class="normal"><a href="#__codelineno-0-2996">2996</a></span>
<span class="normal"><a href="#__codelineno-0-2997">2997</a></span>
<span class="normal"><a href="#__codelineno-0-2998">2998</a></span>
<span class="normal"><a href="#__codelineno-0-2999">2999</a></span>
<span class="normal"><a href="#__codelineno-0-3000">3000</a></span>
<span class="normal"><a href="#__codelineno-0-3001">3001</a></span>
<span class="normal"><a href="#__codelineno-0-3002">3002</a></span>
<span class="normal"><a href="#__codelineno-0-3003">3003</a></span>
<span class="normal"><a href="#__codelineno-0-3004">3004</a></span>
<span class="normal"><a href="#__codelineno-0-3005">3005</a></span>
<span class="normal"><a href="#__codelineno-0-3006">3006</a></span>
<span class="normal"><a href="#__codelineno-0-3007">3007</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2982"><a id="__codelineno-0-2982" name="__codelineno-0-2982"></a><span class="k">def</span><span class="w"> </span><span class="nf">proj_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-2983"><a id="__codelineno-0-2983" name="__codelineno-0-2983"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the orthogonal projection of the current vector (or matrix) onto the subspace spanned by the columns of another matrix.</span>
</span><span id="__span-0-2984"><a id="__codelineno-0-2984" name="__codelineno-0-2984"></a>
</span><span id="__span-0-2985"><a id="__codelineno-0-2985" name="__codelineno-0-2985"></a><span class="sd">    This method returns the component of `self` that lies in the subspace defined by the columns of `to`.</span>
</span><span id="__span-0-2986"><a id="__codelineno-0-2986" name="__codelineno-0-2986"></a><span class="sd">    It is equivalent to the projection of `self` onto the subspace, as computed by the orthogonal decomposition.</span>
</span><span id="__span-0-2987"><a id="__codelineno-0-2987" name="__codelineno-0-2987"></a>
</span><span id="__span-0-2988"><a id="__codelineno-0-2988" name="__codelineno-0-2988"></a><span class="sd">    Args:</span>
</span><span id="__span-0-2989"><a id="__codelineno-0-2989" name="__codelineno-0-2989"></a><span class="sd">        to (Matrix): The matrix whose columns form the subspace onto which to project `self`.</span>
</span><span id="__span-0-2990"><a id="__codelineno-0-2990" name="__codelineno-0-2990"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate results.</span>
</span><span id="__span-0-2991"><a id="__codelineno-0-2991" name="__codelineno-0-2991"></a>
</span><span id="__span-0-2992"><a id="__codelineno-0-2992" name="__codelineno-0-2992"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-2993"><a id="__codelineno-0-2993" name="__codelineno-0-2993"></a><span class="sd">            - 1: Display the projected component.</span>
</span><span id="__span-0-2994"><a id="__codelineno-0-2994" name="__codelineno-0-2994"></a>
</span><span id="__span-0-2995"><a id="__codelineno-0-2995" name="__codelineno-0-2995"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-2996"><a id="__codelineno-0-2996" name="__codelineno-0-2996"></a><span class="sd">        (Matrix): The projection of `self` onto the subspace spanned by `to`.</span>
</span><span id="__span-0-2997"><a id="__codelineno-0-2997" name="__codelineno-0-2997"></a>
</span><span id="__span-0-2998"><a id="__codelineno-0-2998" name="__codelineno-0-2998"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-2999"><a id="__codelineno-0-2999" name="__codelineno-0-2999"></a><span class="sd">        &gt;&gt;&gt; v = Matrix([[3], [4]])</span>
</span><span id="__span-0-3000"><a id="__codelineno-0-3000" name="__codelineno-0-3000"></a><span class="sd">        &gt;&gt;&gt; B = Matrix([[1], [0]])</span>
</span><span id="__span-0-3001"><a id="__codelineno-0-3001" name="__codelineno-0-3001"></a><span class="sd">        &gt;&gt;&gt; v.proj_comp(B)</span>
</span><span id="__span-0-3002"><a id="__codelineno-0-3002" name="__codelineno-0-3002"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-3003"><a id="__codelineno-0-3003" name="__codelineno-0-3003"></a><span class="sd">        [3],</span>
</span><span id="__span-0-3004"><a id="__codelineno-0-3004" name="__codelineno-0-3004"></a><span class="sd">        [0]])</span>
</span><span id="__span-0-3005"><a id="__codelineno-0-3005" name="__codelineno-0-3005"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3006"><a id="__codelineno-0-3006" name="__codelineno-0-3006"></a>
</span><span id="__span-0-3007"><a id="__codelineno-0-3007" name="__codelineno-0-3007"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_decomposition</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">to</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span><span class="o">.</span><span class="n">proj</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.norm_comp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">norm_comp</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.norm_comp" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the component of the current vector (or matrix) orthogonal to the subspace spanned by the columns of another matrix.</p>
<p>This method returns the part of <code>self</code> that is perpendicular to the subspace defined by the columns of <code>to</code>.
It is equivalent to the normal component from the orthogonal decomposition.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>to</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The matrix whose columns form the subspace to which the orthogonal component is computed.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate results.</p>
<ul>
<li>0: No output (default).</li>
<li>1: Display the normal component.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>The component of <code>self</code> orthogonal to the subspace spanned by <code>to</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">norm_comp</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[4]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3009">3009</a></span>
<span class="normal"><a href="#__codelineno-0-3010">3010</a></span>
<span class="normal"><a href="#__codelineno-0-3011">3011</a></span>
<span class="normal"><a href="#__codelineno-0-3012">3012</a></span>
<span class="normal"><a href="#__codelineno-0-3013">3013</a></span>
<span class="normal"><a href="#__codelineno-0-3014">3014</a></span>
<span class="normal"><a href="#__codelineno-0-3015">3015</a></span>
<span class="normal"><a href="#__codelineno-0-3016">3016</a></span>
<span class="normal"><a href="#__codelineno-0-3017">3017</a></span>
<span class="normal"><a href="#__codelineno-0-3018">3018</a></span>
<span class="normal"><a href="#__codelineno-0-3019">3019</a></span>
<span class="normal"><a href="#__codelineno-0-3020">3020</a></span>
<span class="normal"><a href="#__codelineno-0-3021">3021</a></span>
<span class="normal"><a href="#__codelineno-0-3022">3022</a></span>
<span class="normal"><a href="#__codelineno-0-3023">3023</a></span>
<span class="normal"><a href="#__codelineno-0-3024">3024</a></span>
<span class="normal"><a href="#__codelineno-0-3025">3025</a></span>
<span class="normal"><a href="#__codelineno-0-3026">3026</a></span>
<span class="normal"><a href="#__codelineno-0-3027">3027</a></span>
<span class="normal"><a href="#__codelineno-0-3028">3028</a></span>
<span class="normal"><a href="#__codelineno-0-3029">3029</a></span>
<span class="normal"><a href="#__codelineno-0-3030">3030</a></span>
<span class="normal"><a href="#__codelineno-0-3031">3031</a></span>
<span class="normal"><a href="#__codelineno-0-3032">3032</a></span>
<span class="normal"><a href="#__codelineno-0-3033">3033</a></span>
<span class="normal"><a href="#__codelineno-0-3034">3034</a></span>
<span class="normal"><a href="#__codelineno-0-3035">3035</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3009"><a id="__codelineno-0-3009" name="__codelineno-0-3009"></a><span class="k">def</span><span class="w"> </span><span class="nf">norm_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-3010"><a id="__codelineno-0-3010" name="__codelineno-0-3010"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the component of the current vector (or matrix) orthogonal to the subspace spanned by the columns of another matrix.</span>
</span><span id="__span-0-3011"><a id="__codelineno-0-3011" name="__codelineno-0-3011"></a>
</span><span id="__span-0-3012"><a id="__codelineno-0-3012" name="__codelineno-0-3012"></a><span class="sd">    This method returns the part of `self` that is perpendicular to the subspace defined by the columns of `to`.</span>
</span><span id="__span-0-3013"><a id="__codelineno-0-3013" name="__codelineno-0-3013"></a><span class="sd">    It is equivalent to the normal component from the orthogonal decomposition.</span>
</span><span id="__span-0-3014"><a id="__codelineno-0-3014" name="__codelineno-0-3014"></a>
</span><span id="__span-0-3015"><a id="__codelineno-0-3015" name="__codelineno-0-3015"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3016"><a id="__codelineno-0-3016" name="__codelineno-0-3016"></a><span class="sd">        to (Matrix): The matrix whose columns form the subspace to which the orthogonal component is computed.</span>
</span><span id="__span-0-3017"><a id="__codelineno-0-3017" name="__codelineno-0-3017"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate results.</span>
</span><span id="__span-0-3018"><a id="__codelineno-0-3018" name="__codelineno-0-3018"></a>
</span><span id="__span-0-3019"><a id="__codelineno-0-3019" name="__codelineno-0-3019"></a><span class="sd">            - 0: No output (default).</span>
</span><span id="__span-0-3020"><a id="__codelineno-0-3020" name="__codelineno-0-3020"></a><span class="sd">            - 1: Display the normal component.</span>
</span><span id="__span-0-3021"><a id="__codelineno-0-3021" name="__codelineno-0-3021"></a>
</span><span id="__span-0-3022"><a id="__codelineno-0-3022" name="__codelineno-0-3022"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3023"><a id="__codelineno-0-3023" name="__codelineno-0-3023"></a><span class="sd">        (Matrix): The component of `self` orthogonal to the subspace spanned by `to`.</span>
</span><span id="__span-0-3024"><a id="__codelineno-0-3024" name="__codelineno-0-3024"></a>
</span><span id="__span-0-3025"><a id="__codelineno-0-3025" name="__codelineno-0-3025"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3026"><a id="__codelineno-0-3026" name="__codelineno-0-3026"></a><span class="sd">        &gt;&gt;&gt; v = Matrix([[3], [4]])</span>
</span><span id="__span-0-3027"><a id="__codelineno-0-3027" name="__codelineno-0-3027"></a><span class="sd">        &gt;&gt;&gt; B = Matrix([[1], [0]])</span>
</span><span id="__span-0-3028"><a id="__codelineno-0-3028" name="__codelineno-0-3028"></a><span class="sd">        &gt;&gt;&gt; v.norm_comp(B)</span>
</span><span id="__span-0-3029"><a id="__codelineno-0-3029" name="__codelineno-0-3029"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-3030"><a id="__codelineno-0-3030" name="__codelineno-0-3030"></a><span class="sd">        [0]</span>
</span><span id="__span-0-3031"><a id="__codelineno-0-3031" name="__codelineno-0-3031"></a><span class="sd">        [4]</span>
</span><span id="__span-0-3032"><a id="__codelineno-0-3032" name="__codelineno-0-3032"></a><span class="sd">        ])</span>
</span><span id="__span-0-3033"><a id="__codelineno-0-3033" name="__codelineno-0-3033"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3034"><a id="__codelineno-0-3034" name="__codelineno-0-3034"></a>
</span><span id="__span-0-3035"><a id="__codelineno-0-3035" name="__codelineno-0-3035"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_decomposition</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">to</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.gram_schmidt" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">factor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="n">ScalarFactor</span></code>

<a href="#ma1522.symbolic.Matrix.gram_schmidt" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Performs Gram-Schmidt orthogonalization to convert a set of vectors (columns of the matrix) into
an orthogonal set (that includes 0 vectors if any).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>factor</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, the resulting orthogonal vectors will be scaled to have integer factors.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity:</p>
<ul>
<li>0: No output.</li>
<li>1: Display intermediate results for each step of the process.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix whose columns are the orthogonalized vectors.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[  sqrt(10)/10, 3*sqrt(10)/10]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3*sqrt(10)/10,  -sqrt(10)/10]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3037">3037</a></span>
<span class="normal"><a href="#__codelineno-0-3038">3038</a></span>
<span class="normal"><a href="#__codelineno-0-3039">3039</a></span>
<span class="normal"><a href="#__codelineno-0-3040">3040</a></span>
<span class="normal"><a href="#__codelineno-0-3041">3041</a></span>
<span class="normal"><a href="#__codelineno-0-3042">3042</a></span>
<span class="normal"><a href="#__codelineno-0-3043">3043</a></span>
<span class="normal"><a href="#__codelineno-0-3044">3044</a></span>
<span class="normal"><a href="#__codelineno-0-3045">3045</a></span>
<span class="normal"><a href="#__codelineno-0-3046">3046</a></span>
<span class="normal"><a href="#__codelineno-0-3047">3047</a></span>
<span class="normal"><a href="#__codelineno-0-3048">3048</a></span>
<span class="normal"><a href="#__codelineno-0-3049">3049</a></span>
<span class="normal"><a href="#__codelineno-0-3050">3050</a></span>
<span class="normal"><a href="#__codelineno-0-3051">3051</a></span>
<span class="normal"><a href="#__codelineno-0-3052">3052</a></span>
<span class="normal"><a href="#__codelineno-0-3053">3053</a></span>
<span class="normal"><a href="#__codelineno-0-3054">3054</a></span>
<span class="normal"><a href="#__codelineno-0-3055">3055</a></span>
<span class="normal"><a href="#__codelineno-0-3056">3056</a></span>
<span class="normal"><a href="#__codelineno-0-3057">3057</a></span>
<span class="normal"><a href="#__codelineno-0-3058">3058</a></span>
<span class="normal"><a href="#__codelineno-0-3059">3059</a></span>
<span class="normal"><a href="#__codelineno-0-3060">3060</a></span>
<span class="normal"><a href="#__codelineno-0-3061">3061</a></span>
<span class="normal"><a href="#__codelineno-0-3062">3062</a></span>
<span class="normal"><a href="#__codelineno-0-3063">3063</a></span>
<span class="normal"><a href="#__codelineno-0-3064">3064</a></span>
<span class="normal"><a href="#__codelineno-0-3065">3065</a></span>
<span class="normal"><a href="#__codelineno-0-3066">3066</a></span>
<span class="normal"><a href="#__codelineno-0-3067">3067</a></span>
<span class="normal"><a href="#__codelineno-0-3068">3068</a></span>
<span class="normal"><a href="#__codelineno-0-3069">3069</a></span>
<span class="normal"><a href="#__codelineno-0-3070">3070</a></span>
<span class="normal"><a href="#__codelineno-0-3071">3071</a></span>
<span class="normal"><a href="#__codelineno-0-3072">3072</a></span>
<span class="normal"><a href="#__codelineno-0-3073">3073</a></span>
<span class="normal"><a href="#__codelineno-0-3074">3074</a></span>
<span class="normal"><a href="#__codelineno-0-3075">3075</a></span>
<span class="normal"><a href="#__codelineno-0-3076">3076</a></span>
<span class="normal"><a href="#__codelineno-0-3077">3077</a></span>
<span class="normal"><a href="#__codelineno-0-3078">3078</a></span>
<span class="normal"><a href="#__codelineno-0-3079">3079</a></span>
<span class="normal"><a href="#__codelineno-0-3080">3080</a></span>
<span class="normal"><a href="#__codelineno-0-3081">3081</a></span>
<span class="normal"><a href="#__codelineno-0-3082">3082</a></span>
<span class="normal"><a href="#__codelineno-0-3083">3083</a></span>
<span class="normal"><a href="#__codelineno-0-3084">3084</a></span>
<span class="normal"><a href="#__codelineno-0-3085">3085</a></span>
<span class="normal"><a href="#__codelineno-0-3086">3086</a></span>
<span class="normal"><a href="#__codelineno-0-3087">3087</a></span>
<span class="normal"><a href="#__codelineno-0-3088">3088</a></span>
<span class="normal"><a href="#__codelineno-0-3089">3089</a></span>
<span class="normal"><a href="#__codelineno-0-3090">3090</a></span>
<span class="normal"><a href="#__codelineno-0-3091">3091</a></span>
<span class="normal"><a href="#__codelineno-0-3092">3092</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3037"><a id="__codelineno-0-3037" name="__codelineno-0-3037"></a><span class="k">def</span><span class="w"> </span><span class="nf">gram_schmidt</span><span class="p">(</span>
</span><span id="__span-0-3038"><a id="__codelineno-0-3038" name="__codelineno-0-3038"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-3039"><a id="__codelineno-0-3039" name="__codelineno-0-3039"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="n">ScalarFactor</span><span class="p">:</span>
</span><span id="__span-0-3040"><a id="__codelineno-0-3040" name="__codelineno-0-3040"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs Gram-Schmidt orthogonalization to convert a set of vectors (columns of the matrix) into</span>
</span><span id="__span-0-3041"><a id="__codelineno-0-3041" name="__codelineno-0-3041"></a><span class="sd">    an orthogonal set (that includes 0 vectors if any).</span>
</span><span id="__span-0-3042"><a id="__codelineno-0-3042" name="__codelineno-0-3042"></a>
</span><span id="__span-0-3043"><a id="__codelineno-0-3043" name="__codelineno-0-3043"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3044"><a id="__codelineno-0-3044" name="__codelineno-0-3044"></a><span class="sd">        factor (bool): If `True`, the resulting orthogonal vectors will be scaled to have integer factors.</span>
</span><span id="__span-0-3045"><a id="__codelineno-0-3045" name="__codelineno-0-3045"></a><span class="sd">        verbosity (int): Level of verbosity:</span>
</span><span id="__span-0-3046"><a id="__codelineno-0-3046" name="__codelineno-0-3046"></a>
</span><span id="__span-0-3047"><a id="__codelineno-0-3047" name="__codelineno-0-3047"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-3048"><a id="__codelineno-0-3048" name="__codelineno-0-3048"></a><span class="sd">            - 1: Display intermediate results for each step of the process.</span>
</span><span id="__span-0-3049"><a id="__codelineno-0-3049" name="__codelineno-0-3049"></a>
</span><span id="__span-0-3050"><a id="__codelineno-0-3050" name="__codelineno-0-3050"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3051"><a id="__codelineno-0-3051" name="__codelineno-0-3051"></a><span class="sd">        (Matrix): A matrix whose columns are the orthogonalized vectors.</span>
</span><span id="__span-0-3052"><a id="__codelineno-0-3052" name="__codelineno-0-3052"></a>
</span><span id="__span-0-3053"><a id="__codelineno-0-3053" name="__codelineno-0-3053"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3054"><a id="__codelineno-0-3054" name="__codelineno-0-3054"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-3055"><a id="__codelineno-0-3055" name="__codelineno-0-3055"></a><span class="sd">        &gt;&gt;&gt; mat.gram_schmidt(factor=False, verbosity=0)</span>
</span><span id="__span-0-3056"><a id="__codelineno-0-3056" name="__codelineno-0-3056"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-3057"><a id="__codelineno-0-3057" name="__codelineno-0-3057"></a><span class="sd">        [  sqrt(10)/10, 3*sqrt(10)/10]</span>
</span><span id="__span-0-3058"><a id="__codelineno-0-3058" name="__codelineno-0-3058"></a><span class="sd">        [3*sqrt(10)/10,  -sqrt(10)/10]</span>
</span><span id="__span-0-3059"><a id="__codelineno-0-3059" name="__codelineno-0-3059"></a><span class="sd">        ])</span>
</span><span id="__span-0-3060"><a id="__codelineno-0-3060" name="__codelineno-0-3060"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3061"><a id="__codelineno-0-3061" name="__codelineno-0-3061"></a>
</span><span id="__span-0-3062"><a id="__codelineno-0-3062" name="__codelineno-0-3062"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-3063"><a id="__codelineno-0-3063" name="__codelineno-0-3063"></a>        <span class="k">return</span> <span class="n">Matrix</span><span class="p">()</span>
</span><span id="__span-0-3064"><a id="__codelineno-0-3064" name="__codelineno-0-3064"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3065"><a id="__codelineno-0-3065" name="__codelineno-0-3065"></a>        <span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;v_</span><span class="si">{</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">)</span>
</span><span id="__span-0-3066"><a id="__codelineno-0-3066" name="__codelineno-0-3066"></a>
</span><span id="__span-0-3067"><a id="__codelineno-0-3067" name="__codelineno-0-3067"></a>    <span class="n">orthogonal_set</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
</span><span id="__span-0-3068"><a id="__codelineno-0-3068" name="__codelineno-0-3068"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
</span><span id="__span-0-3069"><a id="__codelineno-0-3069" name="__codelineno-0-3069"></a>        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-0-3070"><a id="__codelineno-0-3070" name="__codelineno-0-3070"></a>        <span class="n">latex_eq</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;v_</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-3071"><a id="__codelineno-0-3071" name="__codelineno-0-3071"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orthogonal_set</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-3072"><a id="__codelineno-0-3072" name="__codelineno-0-3072"></a>            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-3073"><a id="__codelineno-0-3073" name="__codelineno-0-3073"></a>                <span class="n">latex_eq</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;- </span><span class="se">\\</span><span class="s2">left(</span><span class="se">\\</span><span class="s2">frac</span><span class="se">{{</span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="si">}</span><span class="se">}}{{</span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="si">}</span><span class="se">}}\\</span><span class="s2">right) </span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-3074"><a id="__codelineno-0-3074" name="__codelineno-0-3074"></a>                <span class="n">u</span> <span class="o">-=</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">/</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">*</span> <span class="n">v</span>
</span><span id="__span-0-3075"><a id="__codelineno-0-3075" name="__codelineno-0-3075"></a>
</span><span id="__span-0-3076"><a id="__codelineno-0-3076" name="__codelineno-0-3076"></a>        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3077"><a id="__codelineno-0-3077" name="__codelineno-0-3077"></a>            <span class="n">disp_u</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-0-3078"><a id="__codelineno-0-3078" name="__codelineno-0-3078"></a>            <span class="k">if</span> <span class="n">factor</span><span class="p">:</span>
</span><span id="__span-0-3079"><a id="__codelineno-0-3079" name="__codelineno-0-3079"></a>                <span class="n">scalar</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-3080"><a id="__codelineno-0-3080" name="__codelineno-0-3080"></a>                <span class="n">disp_u</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">MatMul</span><span class="p">(</span><span class="n">scalar</span><span class="p">,</span> <span class="n">u</span> <span class="o">/</span> <span class="n">scalar</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3081"><a id="__codelineno-0-3081" name="__codelineno-0-3081"></a>            <span class="n">latex_eq</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; = </span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">disp_u</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-3082"><a id="__codelineno-0-3082" name="__codelineno-0-3082"></a>            <span class="n">display</span><span class="p">(</span><span class="n">latex_eq</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">)</span>
</span><span id="__span-0-3083"><a id="__codelineno-0-3083" name="__codelineno-0-3083"></a>
</span><span id="__span-0-3084"><a id="__codelineno-0-3084" name="__codelineno-0-3084"></a>        <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-3085"><a id="__codelineno-0-3085" name="__codelineno-0-3085"></a>            <span class="n">warn</span><span class="p">(</span>
</span><span id="__span-0-3086"><a id="__codelineno-0-3086" name="__codelineno-0-3086"></a>                <span class="s2">&quot;Vectors are linearly dependent. Note that there is no QR factorisation&quot;</span><span class="p">,</span>
</span><span id="__span-0-3087"><a id="__codelineno-0-3087" name="__codelineno-0-3087"></a>                <span class="ne">UserWarning</span><span class="p">,</span>
</span><span id="__span-0-3088"><a id="__codelineno-0-3088" name="__codelineno-0-3088"></a>                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-3089"><a id="__codelineno-0-3089" name="__codelineno-0-3089"></a>            <span class="p">)</span>
</span><span id="__span-0-3090"><a id="__codelineno-0-3090" name="__codelineno-0-3090"></a>        <span class="n">orthogonal_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
</span><span id="__span-0-3091"><a id="__codelineno-0-3091" name="__codelineno-0-3091"></a>
</span><span id="__span-0-3092"><a id="__codelineno-0-3092" name="__codelineno-0-3092"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">orthogonal_set</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="n">factor</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.QRdecomposition" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">QRdecomposition</span><span class="p">(</span><span class="n">full</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QR</span></code>

<a href="#ma1522.symbolic.Matrix.QRdecomposition" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the QR decomposition of the matrix. Optionally computes the full QR decomposition.</p>
<p>A full QR decomposition returns an <strong>orthogonal (square) matrix</strong> <code>Q</code> and an upper triangular matrix <code>R</code>
such that <code>self = Q @ R</code>. On the other hand, a reduced QR decomposition returns <code>Q</code> and <code>R</code> such that
<code>self = Q @ R</code>, where <code>Q</code> has <strong>orthonormal columns</strong>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>full</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, computes the full QR decomposition.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity for displaying intermediate results:</p>
<ul>
<li>0: No output.</li>
<li>1: Display intermediate results for each step of the process.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              QR(Q: Matrix, R: Matrix)

  
      dataclass
   (ma1522.custom_types.QR)" href="../custom_types/#ma1522.custom_types.QR">QR</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing:</p>
<ul>
<li><code>Q</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): A matrix with orthonormal columns (or orthogonal matrix if full QR decomposition).</li>
<li><code>R</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): An upper triangular matrix.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span>
<span class="normal"><a href="#__codelineno-0-8">8</a></span>
<span class="normal"><a href="#__codelineno-0-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">QRdecomposition</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">QR(Q=Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[  sqrt(10)/10, 3*sqrt(10)/10]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[3*sqrt(10)/10,  -sqrt(10)/10]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">]), R=Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[sqrt(10), 7*sqrt(10)/5]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[       0,   sqrt(10)/5]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.QRdecomposition"><code>Matrix.QRdecomposition</code></a></li>
<li><a class="autorefs autorefs-internal" title="            gram_schmidt(factor: bool = True, verbosity: int = 1) -> Matrix | ScalarFactor" href="#ma1522.symbolic.Matrix.gram_schmidt"><code>gram_schmidt</code></a> for performing the Gram-Schmidt process to find an orthogonal basis.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3095">3095</a></span>
<span class="normal"><a href="#__codelineno-0-3096">3096</a></span>
<span class="normal"><a href="#__codelineno-0-3097">3097</a></span>
<span class="normal"><a href="#__codelineno-0-3098">3098</a></span>
<span class="normal"><a href="#__codelineno-0-3099">3099</a></span>
<span class="normal"><a href="#__codelineno-0-3100">3100</a></span>
<span class="normal"><a href="#__codelineno-0-3101">3101</a></span>
<span class="normal"><a href="#__codelineno-0-3102">3102</a></span>
<span class="normal"><a href="#__codelineno-0-3103">3103</a></span>
<span class="normal"><a href="#__codelineno-0-3104">3104</a></span>
<span class="normal"><a href="#__codelineno-0-3105">3105</a></span>
<span class="normal"><a href="#__codelineno-0-3106">3106</a></span>
<span class="normal"><a href="#__codelineno-0-3107">3107</a></span>
<span class="normal"><a href="#__codelineno-0-3108">3108</a></span>
<span class="normal"><a href="#__codelineno-0-3109">3109</a></span>
<span class="normal"><a href="#__codelineno-0-3110">3110</a></span>
<span class="normal"><a href="#__codelineno-0-3111">3111</a></span>
<span class="normal"><a href="#__codelineno-0-3112">3112</a></span>
<span class="normal"><a href="#__codelineno-0-3113">3113</a></span>
<span class="normal"><a href="#__codelineno-0-3114">3114</a></span>
<span class="normal"><a href="#__codelineno-0-3115">3115</a></span>
<span class="normal"><a href="#__codelineno-0-3116">3116</a></span>
<span class="normal"><a href="#__codelineno-0-3117">3117</a></span>
<span class="normal"><a href="#__codelineno-0-3118">3118</a></span>
<span class="normal"><a href="#__codelineno-0-3119">3119</a></span>
<span class="normal"><a href="#__codelineno-0-3120">3120</a></span>
<span class="normal"><a href="#__codelineno-0-3121">3121</a></span>
<span class="normal"><a href="#__codelineno-0-3122">3122</a></span>
<span class="normal"><a href="#__codelineno-0-3123">3123</a></span>
<span class="normal"><a href="#__codelineno-0-3124">3124</a></span>
<span class="normal"><a href="#__codelineno-0-3125">3125</a></span>
<span class="normal"><a href="#__codelineno-0-3126">3126</a></span>
<span class="normal"><a href="#__codelineno-0-3127">3127</a></span>
<span class="normal"><a href="#__codelineno-0-3128">3128</a></span>
<span class="normal"><a href="#__codelineno-0-3129">3129</a></span>
<span class="normal"><a href="#__codelineno-0-3130">3130</a></span>
<span class="normal"><a href="#__codelineno-0-3131">3131</a></span>
<span class="normal"><a href="#__codelineno-0-3132">3132</a></span>
<span class="normal"><a href="#__codelineno-0-3133">3133</a></span>
<span class="normal"><a href="#__codelineno-0-3134">3134</a></span>
<span class="normal"><a href="#__codelineno-0-3135">3135</a></span>
<span class="normal"><a href="#__codelineno-0-3136">3136</a></span>
<span class="normal"><a href="#__codelineno-0-3137">3137</a></span>
<span class="normal"><a href="#__codelineno-0-3138">3138</a></span>
<span class="normal"><a href="#__codelineno-0-3139">3139</a></span>
<span class="normal"><a href="#__codelineno-0-3140">3140</a></span>
<span class="normal"><a href="#__codelineno-0-3141">3141</a></span>
<span class="normal"><a href="#__codelineno-0-3142">3142</a></span>
<span class="normal"><a href="#__codelineno-0-3143">3143</a></span>
<span class="normal"><a href="#__codelineno-0-3144">3144</a></span>
<span class="normal"><a href="#__codelineno-0-3145">3145</a></span>
<span class="normal"><a href="#__codelineno-0-3146">3146</a></span>
<span class="normal"><a href="#__codelineno-0-3147">3147</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3095"><a id="__codelineno-0-3095" name="__codelineno-0-3095"></a><span class="k">def</span><span class="w"> </span><span class="nf">QRdecomposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QR</span><span class="p">:</span>
</span><span id="__span-0-3096"><a id="__codelineno-0-3096" name="__codelineno-0-3096"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the QR decomposition of the matrix. Optionally computes the full QR decomposition.</span>
</span><span id="__span-0-3097"><a id="__codelineno-0-3097" name="__codelineno-0-3097"></a>
</span><span id="__span-0-3098"><a id="__codelineno-0-3098" name="__codelineno-0-3098"></a><span class="sd">    A full QR decomposition returns an **orthogonal (square) matrix** `Q` and an upper triangular matrix `R`</span>
</span><span id="__span-0-3099"><a id="__codelineno-0-3099" name="__codelineno-0-3099"></a><span class="sd">    such that `self = Q @ R`. On the other hand, a reduced QR decomposition returns `Q` and `R` such that</span>
</span><span id="__span-0-3100"><a id="__codelineno-0-3100" name="__codelineno-0-3100"></a><span class="sd">    `self = Q @ R`, where `Q` has **orthonormal columns**.</span>
</span><span id="__span-0-3101"><a id="__codelineno-0-3101" name="__codelineno-0-3101"></a>
</span><span id="__span-0-3102"><a id="__codelineno-0-3102" name="__codelineno-0-3102"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3103"><a id="__codelineno-0-3103" name="__codelineno-0-3103"></a><span class="sd">        full (bool): If `True`, computes the full QR decomposition.</span>
</span><span id="__span-0-3104"><a id="__codelineno-0-3104" name="__codelineno-0-3104"></a><span class="sd">        verbosity (int, optional): Level of verbosity for displaying intermediate results:</span>
</span><span id="__span-0-3105"><a id="__codelineno-0-3105" name="__codelineno-0-3105"></a>
</span><span id="__span-0-3106"><a id="__codelineno-0-3106" name="__codelineno-0-3106"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-3107"><a id="__codelineno-0-3107" name="__codelineno-0-3107"></a><span class="sd">            - 1: Display intermediate results for each step of the process.</span>
</span><span id="__span-0-3108"><a id="__codelineno-0-3108" name="__codelineno-0-3108"></a>
</span><span id="__span-0-3109"><a id="__codelineno-0-3109" name="__codelineno-0-3109"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3110"><a id="__codelineno-0-3110" name="__codelineno-0-3110"></a><span class="sd">        (QR): A dataclass containing:</span>
</span><span id="__span-0-3111"><a id="__codelineno-0-3111" name="__codelineno-0-3111"></a>
</span><span id="__span-0-3112"><a id="__codelineno-0-3112" name="__codelineno-0-3112"></a><span class="sd">            - `Q` ([`Matrix`][...]): A matrix with orthonormal columns (or orthogonal matrix if full QR decomposition).</span>
</span><span id="__span-0-3113"><a id="__codelineno-0-3113" name="__codelineno-0-3113"></a><span class="sd">            - `R` ([`Matrix`][...]): An upper triangular matrix.</span>
</span><span id="__span-0-3114"><a id="__codelineno-0-3114" name="__codelineno-0-3114"></a>
</span><span id="__span-0-3115"><a id="__codelineno-0-3115" name="__codelineno-0-3115"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3116"><a id="__codelineno-0-3116" name="__codelineno-0-3116"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-3117"><a id="__codelineno-0-3117" name="__codelineno-0-3117"></a><span class="sd">        &gt;&gt;&gt; mat.QRdecomposition()</span>
</span><span id="__span-0-3118"><a id="__codelineno-0-3118" name="__codelineno-0-3118"></a><span class="sd">        QR(Q=Matrix([</span>
</span><span id="__span-0-3119"><a id="__codelineno-0-3119" name="__codelineno-0-3119"></a><span class="sd">        [  sqrt(10)/10, 3*sqrt(10)/10]</span>
</span><span id="__span-0-3120"><a id="__codelineno-0-3120" name="__codelineno-0-3120"></a><span class="sd">        [3*sqrt(10)/10,  -sqrt(10)/10]</span>
</span><span id="__span-0-3121"><a id="__codelineno-0-3121" name="__codelineno-0-3121"></a><span class="sd">        ]), R=Matrix([</span>
</span><span id="__span-0-3122"><a id="__codelineno-0-3122" name="__codelineno-0-3122"></a><span class="sd">        [sqrt(10), 7*sqrt(10)/5]</span>
</span><span id="__span-0-3123"><a id="__codelineno-0-3123" name="__codelineno-0-3123"></a><span class="sd">        [       0,   sqrt(10)/5]</span>
</span><span id="__span-0-3124"><a id="__codelineno-0-3124" name="__codelineno-0-3124"></a><span class="sd">        ]))</span>
</span><span id="__span-0-3125"><a id="__codelineno-0-3125" name="__codelineno-0-3125"></a>
</span><span id="__span-0-3126"><a id="__codelineno-0-3126" name="__codelineno-0-3126"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-3127"><a id="__codelineno-0-3127" name="__codelineno-0-3127"></a><span class="sd">        - SymPy&#39;s [`Matrix.QRdecomposition`][sympy.matrices.matrixbase.MatrixBase.QRdecomposition]</span>
</span><span id="__span-0-3128"><a id="__codelineno-0-3128" name="__codelineno-0-3128"></a><span class="sd">        - [`gram_schmidt`][..] for performing the Gram-Schmidt process to find an orthogonal basis.</span>
</span><span id="__span-0-3129"><a id="__codelineno-0-3129" name="__codelineno-0-3129"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3130"><a id="__codelineno-0-3130" name="__codelineno-0-3130"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3131"><a id="__codelineno-0-3131" name="__codelineno-0-3131"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finding orthogonal basis via Gram-Schmidt process:&quot;</span><span class="p">)</span>
</span><span id="__span-0-3132"><a id="__codelineno-0-3132" name="__codelineno-0-3132"></a>        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</span><span id="__span-0-3133"><a id="__codelineno-0-3133" name="__codelineno-0-3133"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">),</span> <span class="s2">&quot;Result should be a Matrix object&quot;</span>
</span><span id="__span-0-3134"><a id="__codelineno-0-3134" name="__codelineno-0-3134"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q matrix:&quot;</span><span class="p">)</span>
</span><span id="__span-0-3135"><a id="__codelineno-0-3135" name="__codelineno-0-3135"></a>        <span class="n">display</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</span><span id="__span-0-3136"><a id="__codelineno-0-3136" name="__codelineno-0-3136"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R matrix: Q.T @ self&quot;</span><span class="p">)</span>
</span><span id="__span-0-3137"><a id="__codelineno-0-3137" name="__codelineno-0-3137"></a>        <span class="n">display</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="__span-0-3138"><a id="__codelineno-0-3138" name="__codelineno-0-3138"></a>
</span><span id="__span-0-3139"><a id="__codelineno-0-3139" name="__codelineno-0-3139"></a>    <span class="c1"># Modified SymPy&#39;s implementation to compute full QR decomposition if required.</span>
</span><span id="__span-0-3140"><a id="__codelineno-0-3140" name="__codelineno-0-3140"></a>    <span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">QRdecomposition</span><span class="p">()</span>
</span><span id="__span-0-3141"><a id="__codelineno-0-3141" name="__codelineno-0-3141"></a>    <span class="k">if</span> <span class="n">full</span> <span class="ow">and</span> <span class="n">Q</span><span class="o">.</span><span class="n">rows</span> <span class="o">!=</span> <span class="n">Q</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
</span><span id="__span-0-3142"><a id="__codelineno-0-3142" name="__codelineno-0-3142"></a>        <span class="n">Q</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</span><span id="__span-0-3143"><a id="__codelineno-0-3143" name="__codelineno-0-3143"></a>        <span class="n">Q_aug</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">elem</span><span class="p">(),</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">QRdecomposition</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-3144"><a id="__codelineno-0-3144" name="__codelineno-0-3144"></a>        <span class="n">R_aug</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Q_aug</span><span class="o">.</span><span class="n">cols</span> <span class="o">-</span> <span class="n">R</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">cols</span><span class="p">)))</span>
</span><span id="__span-0-3145"><a id="__codelineno-0-3145" name="__codelineno-0-3145"></a>        <span class="k">assert</span> <span class="n">Q_aug</span> <span class="o">@</span> <span class="n">R_aug</span> <span class="o">==</span> <span class="bp">self</span>
</span><span id="__span-0-3146"><a id="__codelineno-0-3146" name="__codelineno-0-3146"></a>        <span class="k">return</span> <span class="n">QR</span><span class="p">(</span><span class="n">Q_aug</span><span class="p">,</span> <span class="n">R_aug</span><span class="p">)</span>
</span><span id="__span-0-3147"><a id="__codelineno-0-3147" name="__codelineno-0-3147"></a>    <span class="k">return</span> <span class="n">QR</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.solve_least_squares" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">solve_least_squares</span><span class="p">(</span><span class="n">rhs</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">matrices</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="n">PartGen</span></code>

<a href="#ma1522.symbolic.Matrix.solve_least_squares" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Solves the least squares problem <span class="arithmatex">\(\min || \mathrm{self} \, \mathbf{x} - \mathrm{rhs}||^2\)</span>.</p>
<p>Uses SymPy's built-in method for least squares when the rank condition is met, otherwise uses a custom
solution approach using the normal equations: <span class="arithmatex">\(\mathrm{self}^{\top} \mathrm{self} \, \mathbf{x} = \mathrm{self}^{\top} \mathrm{rhs}\)</span></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rhs</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The right-hand side matrix/vector <code>b</code> in <code>Ax = b</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Level of verbosity (default is <code>1</code>):</p>
<ul>
<li>0: No output.</li>
<li>1: Display intermediate steps.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>matrices</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <ul>
<li>1: Returns the least squares solution matrix.</li>
<li>2: Returns a <a class="autorefs autorefs-internal" title="              PartGen(part_sol: Matrix, gen_sol: Matrix)

  
      dataclass
  " href="../custom_types/#ma1522.custom_types.PartGen"><code>PartGen</code></a> with the part solution and general solution.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Additional positional arguments passed to SymPy's
<a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.solve_least_squares"><code>solve_least_squares</code></a> method.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments passed to to SymPy's
<a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.solve_least_squares"><code>solve_least_squares</code></a> method.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>If <code>matrices=1</code>, returns the least squares solution matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              PartGen(part_sol: Matrix, gen_sol: Matrix)

  
      dataclass
   (ma1522.custom_types.PartGen)" href="../custom_types/#ma1522.custom_types.PartGen">PartGen</a></code>
          –
          <div class="doc-md-description">
            <p>If <code>matrices=2</code>, returns a <a class="autorefs autorefs-internal" title="              PartGen(part_sol: Matrix, gen_sol: Matrix)

  
      dataclass
  " href="../custom_types/#ma1522.custom_types.PartGen"><code>PartGen</code></a> with the part solution and general solution.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">solve_least_squares</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">matrices</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="gp">... </span><span class="c1"># in this case, least squares solution is not unique,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="gp">... </span><span class="c1"># so it returns a general solution.</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">Exception Encountered: Matrix must be non-singular.</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">Attempting custom solve...</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">Matrix([</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">[1]</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="go">[y]</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3149">3149</a></span>
<span class="normal"><a href="#__codelineno-0-3150">3150</a></span>
<span class="normal"><a href="#__codelineno-0-3151">3151</a></span>
<span class="normal"><a href="#__codelineno-0-3152">3152</a></span>
<span class="normal"><a href="#__codelineno-0-3153">3153</a></span>
<span class="normal"><a href="#__codelineno-0-3154">3154</a></span>
<span class="normal"><a href="#__codelineno-0-3155">3155</a></span>
<span class="normal"><a href="#__codelineno-0-3156">3156</a></span>
<span class="normal"><a href="#__codelineno-0-3157">3157</a></span>
<span class="normal"><a href="#__codelineno-0-3158">3158</a></span>
<span class="normal"><a href="#__codelineno-0-3159">3159</a></span>
<span class="normal"><a href="#__codelineno-0-3160">3160</a></span>
<span class="normal"><a href="#__codelineno-0-3161">3161</a></span>
<span class="normal"><a href="#__codelineno-0-3162">3162</a></span>
<span class="normal"><a href="#__codelineno-0-3163">3163</a></span>
<span class="normal"><a href="#__codelineno-0-3164">3164</a></span>
<span class="normal"><a href="#__codelineno-0-3165">3165</a></span>
<span class="normal"><a href="#__codelineno-0-3166">3166</a></span>
<span class="normal"><a href="#__codelineno-0-3167">3167</a></span>
<span class="normal"><a href="#__codelineno-0-3168">3168</a></span>
<span class="normal"><a href="#__codelineno-0-3169">3169</a></span>
<span class="normal"><a href="#__codelineno-0-3170">3170</a></span>
<span class="normal"><a href="#__codelineno-0-3171">3171</a></span>
<span class="normal"><a href="#__codelineno-0-3172">3172</a></span>
<span class="normal"><a href="#__codelineno-0-3173">3173</a></span>
<span class="normal"><a href="#__codelineno-0-3174">3174</a></span>
<span class="normal"><a href="#__codelineno-0-3175">3175</a></span>
<span class="normal"><a href="#__codelineno-0-3176">3176</a></span>
<span class="normal"><a href="#__codelineno-0-3177">3177</a></span>
<span class="normal"><a href="#__codelineno-0-3178">3178</a></span>
<span class="normal"><a href="#__codelineno-0-3179">3179</a></span>
<span class="normal"><a href="#__codelineno-0-3180">3180</a></span>
<span class="normal"><a href="#__codelineno-0-3181">3181</a></span>
<span class="normal"><a href="#__codelineno-0-3182">3182</a></span>
<span class="normal"><a href="#__codelineno-0-3183">3183</a></span>
<span class="normal"><a href="#__codelineno-0-3184">3184</a></span>
<span class="normal"><a href="#__codelineno-0-3185">3185</a></span>
<span class="normal"><a href="#__codelineno-0-3186">3186</a></span>
<span class="normal"><a href="#__codelineno-0-3187">3187</a></span>
<span class="normal"><a href="#__codelineno-0-3188">3188</a></span>
<span class="normal"><a href="#__codelineno-0-3189">3189</a></span>
<span class="normal"><a href="#__codelineno-0-3190">3190</a></span>
<span class="normal"><a href="#__codelineno-0-3191">3191</a></span>
<span class="normal"><a href="#__codelineno-0-3192">3192</a></span>
<span class="normal"><a href="#__codelineno-0-3193">3193</a></span>
<span class="normal"><a href="#__codelineno-0-3194">3194</a></span>
<span class="normal"><a href="#__codelineno-0-3195">3195</a></span>
<span class="normal"><a href="#__codelineno-0-3196">3196</a></span>
<span class="normal"><a href="#__codelineno-0-3197">3197</a></span>
<span class="normal"><a href="#__codelineno-0-3198">3198</a></span>
<span class="normal"><a href="#__codelineno-0-3199">3199</a></span>
<span class="normal"><a href="#__codelineno-0-3200">3200</a></span>
<span class="normal"><a href="#__codelineno-0-3201">3201</a></span>
<span class="normal"><a href="#__codelineno-0-3202">3202</a></span>
<span class="normal"><a href="#__codelineno-0-3203">3203</a></span>
<span class="normal"><a href="#__codelineno-0-3204">3204</a></span>
<span class="normal"><a href="#__codelineno-0-3205">3205</a></span>
<span class="normal"><a href="#__codelineno-0-3206">3206</a></span>
<span class="normal"><a href="#__codelineno-0-3207">3207</a></span>
<span class="normal"><a href="#__codelineno-0-3208">3208</a></span>
<span class="normal"><a href="#__codelineno-0-3209">3209</a></span>
<span class="normal"><a href="#__codelineno-0-3210">3210</a></span>
<span class="normal"><a href="#__codelineno-0-3211">3211</a></span>
<span class="normal"><a href="#__codelineno-0-3212">3212</a></span>
<span class="normal"><a href="#__codelineno-0-3213">3213</a></span>
<span class="normal"><a href="#__codelineno-0-3214">3214</a></span>
<span class="normal"><a href="#__codelineno-0-3215">3215</a></span>
<span class="normal"><a href="#__codelineno-0-3216">3216</a></span>
<span class="normal"><a href="#__codelineno-0-3217">3217</a></span>
<span class="normal"><a href="#__codelineno-0-3218">3218</a></span>
<span class="normal"><a href="#__codelineno-0-3219">3219</a></span>
<span class="normal"><a href="#__codelineno-0-3220">3220</a></span>
<span class="normal"><a href="#__codelineno-0-3221">3221</a></span>
<span class="normal"><a href="#__codelineno-0-3222">3222</a></span>
<span class="normal"><a href="#__codelineno-0-3223">3223</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3149"><a id="__codelineno-0-3149" name="__codelineno-0-3149"></a><span class="k">def</span><span class="w"> </span><span class="nf">solve_least_squares</span><span class="p">(</span>
</span><span id="__span-0-3150"><a id="__codelineno-0-3150" name="__codelineno-0-3150"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">matrices</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-3151"><a id="__codelineno-0-3151" name="__codelineno-0-3151"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span> <span class="o">|</span> <span class="n">PartGen</span><span class="p">:</span>
</span><span id="__span-0-3152"><a id="__codelineno-0-3152" name="__codelineno-0-3152"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Solves the least squares problem $\min || \mathrm{self} \, \mathbf{x} - \mathrm{rhs}||^2$.</span>
</span><span id="__span-0-3153"><a id="__codelineno-0-3153" name="__codelineno-0-3153"></a>
</span><span id="__span-0-3154"><a id="__codelineno-0-3154" name="__codelineno-0-3154"></a><span class="sd">    Uses SymPy&#39;s built-in method for least squares when the rank condition is met, otherwise uses a custom</span>
</span><span id="__span-0-3155"><a id="__codelineno-0-3155" name="__codelineno-0-3155"></a><span class="sd">    solution approach using the normal equations: $\mathrm{self}^{\top} \mathrm{self} \, \mathbf{x} = \mathrm{self}^{\top} \mathrm{rhs}$</span>
</span><span id="__span-0-3156"><a id="__codelineno-0-3156" name="__codelineno-0-3156"></a>
</span><span id="__span-0-3157"><a id="__codelineno-0-3157" name="__codelineno-0-3157"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3158"><a id="__codelineno-0-3158" name="__codelineno-0-3158"></a><span class="sd">        rhs (Matrix): The right-hand side matrix/vector `b` in `Ax = b`.</span>
</span><span id="__span-0-3159"><a id="__codelineno-0-3159" name="__codelineno-0-3159"></a><span class="sd">        verbosity (int, optional): Level of verbosity (default is `1`):</span>
</span><span id="__span-0-3160"><a id="__codelineno-0-3160" name="__codelineno-0-3160"></a>
</span><span id="__span-0-3161"><a id="__codelineno-0-3161" name="__codelineno-0-3161"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-3162"><a id="__codelineno-0-3162" name="__codelineno-0-3162"></a><span class="sd">            - 1: Display intermediate steps.</span>
</span><span id="__span-0-3163"><a id="__codelineno-0-3163" name="__codelineno-0-3163"></a><span class="sd">        matrices (int, optional):</span>
</span><span id="__span-0-3164"><a id="__codelineno-0-3164" name="__codelineno-0-3164"></a>
</span><span id="__span-0-3165"><a id="__codelineno-0-3165" name="__codelineno-0-3165"></a><span class="sd">            - 1: Returns the least squares solution matrix.</span>
</span><span id="__span-0-3166"><a id="__codelineno-0-3166" name="__codelineno-0-3166"></a><span class="sd">            - 2: Returns a [`PartGen`][(p).] with the part solution and general solution.</span>
</span><span id="__span-0-3167"><a id="__codelineno-0-3167" name="__codelineno-0-3167"></a><span class="sd">        *args: Additional positional arguments passed to SymPy&#39;s</span>
</span><span id="__span-0-3168"><a id="__codelineno-0-3168" name="__codelineno-0-3168"></a><span class="sd">            [`solve_least_squares`][sympy.matrices.matrixbase.MatrixBase.solve_least_squares] method.</span>
</span><span id="__span-0-3169"><a id="__codelineno-0-3169" name="__codelineno-0-3169"></a><span class="sd">        **kwargs: Additional arguments passed to to SymPy&#39;s</span>
</span><span id="__span-0-3170"><a id="__codelineno-0-3170" name="__codelineno-0-3170"></a><span class="sd">            [`solve_least_squares`][sympy.matrices.matrixbase.MatrixBase.solve_least_squares] method.</span>
</span><span id="__span-0-3171"><a id="__codelineno-0-3171" name="__codelineno-0-3171"></a>
</span><span id="__span-0-3172"><a id="__codelineno-0-3172" name="__codelineno-0-3172"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3173"><a id="__codelineno-0-3173" name="__codelineno-0-3173"></a><span class="sd">        (Matrix): If `matrices=1`, returns the least squares solution matrix.</span>
</span><span id="__span-0-3174"><a id="__codelineno-0-3174" name="__codelineno-0-3174"></a><span class="sd">        (PartGen): If `matrices=2`, returns a [`PartGen`][(p).] with the part solution and general solution.</span>
</span><span id="__span-0-3175"><a id="__codelineno-0-3175" name="__codelineno-0-3175"></a>
</span><span id="__span-0-3176"><a id="__codelineno-0-3176" name="__codelineno-0-3176"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3177"><a id="__codelineno-0-3177" name="__codelineno-0-3177"></a><span class="sd">        &gt;&gt;&gt; A = Matrix([[1, 0], [0, 0]])</span>
</span><span id="__span-0-3178"><a id="__codelineno-0-3178" name="__codelineno-0-3178"></a><span class="sd">        &gt;&gt;&gt; b = Matrix([1, 2])</span>
</span><span id="__span-0-3179"><a id="__codelineno-0-3179" name="__codelineno-0-3179"></a><span class="sd">        &gt;&gt;&gt; A.solve_least_squares(b, verbosity=0, matrices=1)</span>
</span><span id="__span-0-3180"><a id="__codelineno-0-3180" name="__codelineno-0-3180"></a><span class="sd">        ... # in this case, least squares solution is not unique,</span>
</span><span id="__span-0-3181"><a id="__codelineno-0-3181" name="__codelineno-0-3181"></a><span class="sd">        ... # so it returns a general solution.</span>
</span><span id="__span-0-3182"><a id="__codelineno-0-3182" name="__codelineno-0-3182"></a><span class="sd">        Exception Encountered: Matrix must be non-singular.</span>
</span><span id="__span-0-3183"><a id="__codelineno-0-3183" name="__codelineno-0-3183"></a><span class="sd">        Attempting custom solve...</span>
</span><span id="__span-0-3184"><a id="__codelineno-0-3184" name="__codelineno-0-3184"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-3185"><a id="__codelineno-0-3185" name="__codelineno-0-3185"></a><span class="sd">        [1]</span>
</span><span id="__span-0-3186"><a id="__codelineno-0-3186" name="__codelineno-0-3186"></a><span class="sd">        [y]</span>
</span><span id="__span-0-3187"><a id="__codelineno-0-3187" name="__codelineno-0-3187"></a><span class="sd">        ])</span>
</span><span id="__span-0-3188"><a id="__codelineno-0-3188" name="__codelineno-0-3188"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3189"><a id="__codelineno-0-3189" name="__codelineno-0-3189"></a>
</span><span id="__span-0-3190"><a id="__codelineno-0-3190" name="__codelineno-0-3190"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-3191"><a id="__codelineno-0-3191" name="__codelineno-0-3191"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-3192"><a id="__codelineno-0-3192" name="__codelineno-0-3192"></a>            <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>
</span><span id="__span-0-3193"><a id="__codelineno-0-3193" name="__codelineno-0-3193"></a>            <span class="k">return</span> <span class="n">A</span><span class="o">.</span><span class="n">solve_least_squares</span><span class="p">(</span><span class="n">rhs</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-3194"><a id="__codelineno-0-3194" name="__codelineno-0-3194"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-3195"><a id="__codelineno-0-3195" name="__codelineno-0-3195"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception Encountered: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-3196"><a id="__codelineno-0-3196" name="__codelineno-0-3196"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempting custom solve...&quot;</span><span class="p">)</span>
</span><span id="__span-0-3197"><a id="__codelineno-0-3197" name="__codelineno-0-3197"></a>
</span><span id="__span-0-3198"><a id="__codelineno-0-3198" name="__codelineno-0-3198"></a>    <span class="n">ATA</span><span class="p">,</span> <span class="n">ATb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">rhs</span>
</span><span id="__span-0-3199"><a id="__codelineno-0-3199" name="__codelineno-0-3199"></a>    <span class="k">if</span> <span class="n">ATA</span><span class="o">.</span><span class="n">det</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3200"><a id="__codelineno-0-3200" name="__codelineno-0-3200"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.T @ self is invertible. The lest squares solution is unique.&quot;</span><span class="p">)</span>
</span><span id="__span-0-3201"><a id="__codelineno-0-3201" name="__codelineno-0-3201"></a>        <span class="n">display</span><span class="p">(</span>
</span><span id="__span-0-3202"><a id="__codelineno-0-3202" name="__codelineno-0-3202"></a>            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">mathbf</span><span class="si">{x}</span><span class="s2"> = </span><span class="se">\\</span><span class="s2">left(</span><span class="se">\\</span><span class="s2">mathbf</span><span class="si">{A}</span><span class="s2">^</span><span class="se">\\</span><span class="s2">top </span><span class="se">\\</span><span class="s2">mathbf</span><span class="si">{A}</span><span class="se">\\</span><span class="s2">right)^{-1} </span><span class="se">\\</span><span class="s2">mathbf</span><span class="si">{A}</span><span class="s2">^</span><span class="se">\\</span><span class="s2">top </span><span class="se">\\</span><span class="s2">mathbf</span><span class="si">{b}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3203"><a id="__codelineno-0-3203" name="__codelineno-0-3203"></a>            <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">,</span>
</span><span id="__span-0-3204"><a id="__codelineno-0-3204" name="__codelineno-0-3204"></a>        <span class="p">)</span>
</span><span id="__span-0-3205"><a id="__codelineno-0-3205" name="__codelineno-0-3205"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">ATA</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span> <span class="o">@</span> <span class="n">ATb</span>
</span><span id="__span-0-3206"><a id="__codelineno-0-3206" name="__codelineno-0-3206"></a>        <span class="n">display</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-3207"><a id="__codelineno-0-3207" name="__codelineno-0-3207"></a>        <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-0-3208"><a id="__codelineno-0-3208" name="__codelineno-0-3208"></a>
</span><span id="__span-0-3209"><a id="__codelineno-0-3209" name="__codelineno-0-3209"></a>    <span class="c1"># Custom solve using sympy&#39;s solve method</span>
</span><span id="__span-0-3210"><a id="__codelineno-0-3210" name="__codelineno-0-3210"></a>    <span class="n">sol</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">create_unk_matrix</span><span class="p">(</span><span class="n">ATb</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-3211"><a id="__codelineno-0-3211" name="__codelineno-0-3211"></a>    <span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">ATA</span> <span class="o">@</span> <span class="n">sol</span> <span class="o">-</span> <span class="n">ATb</span><span class="p">,</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-0-3212"><a id="__codelineno-0-3212" name="__codelineno-0-3212"></a>
</span><span id="__span-0-3213"><a id="__codelineno-0-3213" name="__codelineno-0-3213"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3214"><a id="__codelineno-0-3214" name="__codelineno-0-3214"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before RREF: [self.T @ self | self.T @ rhs]&quot;</span><span class="p">)</span>
</span><span id="__span-0-3215"><a id="__codelineno-0-3215" name="__codelineno-0-3215"></a>        <span class="n">aug_matrix</span> <span class="o">=</span> <span class="n">ATA</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">ATb</span><span class="p">)</span>
</span><span id="__span-0-3216"><a id="__codelineno-0-3216" name="__codelineno-0-3216"></a>        <span class="n">display</span><span class="p">(</span><span class="n">aug_matrix</span><span class="p">)</span>
</span><span id="__span-0-3217"><a id="__codelineno-0-3217" name="__codelineno-0-3217"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF&quot;</span><span class="p">)</span>
</span><span id="__span-0-3218"><a id="__codelineno-0-3218" name="__codelineno-0-3218"></a>        <span class="n">display</span><span class="p">(</span><span class="n">aug_matrix</span><span class="o">.</span><span class="n">rref</span><span class="p">())</span>
</span><span id="__span-0-3219"><a id="__codelineno-0-3219" name="__codelineno-0-3219"></a>
</span><span id="__span-0-3220"><a id="__codelineno-0-3220" name="__codelineno-0-3220"></a>    <span class="k">if</span> <span class="n">matrices</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3221"><a id="__codelineno-0-3221" name="__codelineno-0-3221"></a>        <span class="k">return</span> <span class="n">sol</span>
</span><span id="__span-0-3222"><a id="__codelineno-0-3222" name="__codelineno-0-3222"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3223"><a id="__codelineno-0-3223" name="__codelineno-0-3223"></a>        <span class="k">return</span> <span class="n">sol</span><span class="o">.</span><span class="n">sep_part_gen</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.create_vander" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">create_vander</span><span class="p">(</span><span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">is_real</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ma1522.symbolic.Matrix.create_vander" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Creates a Vandermonde matrix with symbolic entries.</p>
<p>This method generates a Vandermonde matrix of size <code>num_rows</code> x <code>num_cols</code>
where the entries are symbolic expressions. Each row in the matrix is formed
by raising a symbolic variable (indexed by row) to increasing powers (from 0
to <code>num_cols-1</code>). The <code>is_real</code> flag determines whether the symbols are real-valued.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_rows</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The number of rows in the Vandermonde matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_cols</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The number of columns in the Vandermonde matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>symbol</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                  <code>&#39;x&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>The base name for the symbols used in the matrix entries.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>is_real</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True (default), the symbols are real-valued;
otherwise, they are complex.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A Vandermonde matrix with symbolic entries.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="o">.</span><span class="n">create_vander</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="go">Matrix([</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[1, a_1, a_1**2, a_1**3]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1, a_2, a_2**2, a_2**3]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            apply_vander(x: Matrix) -> Matrix" href="#ma1522.symbolic.Matrix.apply_vander"><code>apply_vander</code></a> for applying the Vandermonde transformation to a matrix.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3225">3225</a></span>
<span class="normal"><a href="#__codelineno-0-3226">3226</a></span>
<span class="normal"><a href="#__codelineno-0-3227">3227</a></span>
<span class="normal"><a href="#__codelineno-0-3228">3228</a></span>
<span class="normal"><a href="#__codelineno-0-3229">3229</a></span>
<span class="normal"><a href="#__codelineno-0-3230">3230</a></span>
<span class="normal"><a href="#__codelineno-0-3231">3231</a></span>
<span class="normal"><a href="#__codelineno-0-3232">3232</a></span>
<span class="normal"><a href="#__codelineno-0-3233">3233</a></span>
<span class="normal"><a href="#__codelineno-0-3234">3234</a></span>
<span class="normal"><a href="#__codelineno-0-3235">3235</a></span>
<span class="normal"><a href="#__codelineno-0-3236">3236</a></span>
<span class="normal"><a href="#__codelineno-0-3237">3237</a></span>
<span class="normal"><a href="#__codelineno-0-3238">3238</a></span>
<span class="normal"><a href="#__codelineno-0-3239">3239</a></span>
<span class="normal"><a href="#__codelineno-0-3240">3240</a></span>
<span class="normal"><a href="#__codelineno-0-3241">3241</a></span>
<span class="normal"><a href="#__codelineno-0-3242">3242</a></span>
<span class="normal"><a href="#__codelineno-0-3243">3243</a></span>
<span class="normal"><a href="#__codelineno-0-3244">3244</a></span>
<span class="normal"><a href="#__codelineno-0-3245">3245</a></span>
<span class="normal"><a href="#__codelineno-0-3246">3246</a></span>
<span class="normal"><a href="#__codelineno-0-3247">3247</a></span>
<span class="normal"><a href="#__codelineno-0-3248">3248</a></span>
<span class="normal"><a href="#__codelineno-0-3249">3249</a></span>
<span class="normal"><a href="#__codelineno-0-3250">3250</a></span>
<span class="normal"><a href="#__codelineno-0-3251">3251</a></span>
<span class="normal"><a href="#__codelineno-0-3252">3252</a></span>
<span class="normal"><a href="#__codelineno-0-3253">3253</a></span>
<span class="normal"><a href="#__codelineno-0-3254">3254</a></span>
<span class="normal"><a href="#__codelineno-0-3255">3255</a></span>
<span class="normal"><a href="#__codelineno-0-3256">3256</a></span>
<span class="normal"><a href="#__codelineno-0-3257">3257</a></span>
<span class="normal"><a href="#__codelineno-0-3258">3258</a></span>
<span class="normal"><a href="#__codelineno-0-3259">3259</a></span>
<span class="normal"><a href="#__codelineno-0-3260">3260</a></span>
<span class="normal"><a href="#__codelineno-0-3261">3261</a></span>
<span class="normal"><a href="#__codelineno-0-3262">3262</a></span>
<span class="normal"><a href="#__codelineno-0-3263">3263</a></span>
<span class="normal"><a href="#__codelineno-0-3264">3264</a></span>
<span class="normal"><a href="#__codelineno-0-3265">3265</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3225"><a id="__codelineno-0-3225" name="__codelineno-0-3225"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-3226"><a id="__codelineno-0-3226" name="__codelineno-0-3226"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_vander</span><span class="p">(</span>
</span><span id="__span-0-3227"><a id="__codelineno-0-3227" name="__codelineno-0-3227"></a>    <span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">is_real</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-3228"><a id="__codelineno-0-3228" name="__codelineno-0-3228"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-3229"><a id="__codelineno-0-3229" name="__codelineno-0-3229"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a Vandermonde matrix with symbolic entries.</span>
</span><span id="__span-0-3230"><a id="__codelineno-0-3230" name="__codelineno-0-3230"></a>
</span><span id="__span-0-3231"><a id="__codelineno-0-3231" name="__codelineno-0-3231"></a><span class="sd">    This method generates a Vandermonde matrix of size `num_rows` x `num_cols`</span>
</span><span id="__span-0-3232"><a id="__codelineno-0-3232" name="__codelineno-0-3232"></a><span class="sd">    where the entries are symbolic expressions. Each row in the matrix is formed</span>
</span><span id="__span-0-3233"><a id="__codelineno-0-3233" name="__codelineno-0-3233"></a><span class="sd">    by raising a symbolic variable (indexed by row) to increasing powers (from 0</span>
</span><span id="__span-0-3234"><a id="__codelineno-0-3234" name="__codelineno-0-3234"></a><span class="sd">    to `num_cols-1`). The `is_real` flag determines whether the symbols are real-valued.</span>
</span><span id="__span-0-3235"><a id="__codelineno-0-3235" name="__codelineno-0-3235"></a>
</span><span id="__span-0-3236"><a id="__codelineno-0-3236" name="__codelineno-0-3236"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3237"><a id="__codelineno-0-3237" name="__codelineno-0-3237"></a><span class="sd">        num_rows (int, optional): The number of rows in the Vandermonde matrix.</span>
</span><span id="__span-0-3238"><a id="__codelineno-0-3238" name="__codelineno-0-3238"></a><span class="sd">        num_cols (int, optional): The number of columns in the Vandermonde matrix.</span>
</span><span id="__span-0-3239"><a id="__codelineno-0-3239" name="__codelineno-0-3239"></a><span class="sd">        symbol (str, optional): The base name for the symbols used in the matrix entries.</span>
</span><span id="__span-0-3240"><a id="__codelineno-0-3240" name="__codelineno-0-3240"></a><span class="sd">        is_real (bool, optional): If True (default), the symbols are real-valued;</span>
</span><span id="__span-0-3241"><a id="__codelineno-0-3241" name="__codelineno-0-3241"></a><span class="sd">            otherwise, they are complex.</span>
</span><span id="__span-0-3242"><a id="__codelineno-0-3242" name="__codelineno-0-3242"></a>
</span><span id="__span-0-3243"><a id="__codelineno-0-3243" name="__codelineno-0-3243"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3244"><a id="__codelineno-0-3244" name="__codelineno-0-3244"></a><span class="sd">        (Matrix): A Vandermonde matrix with symbolic entries.</span>
</span><span id="__span-0-3245"><a id="__codelineno-0-3245" name="__codelineno-0-3245"></a>
</span><span id="__span-0-3246"><a id="__codelineno-0-3246" name="__codelineno-0-3246"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3247"><a id="__codelineno-0-3247" name="__codelineno-0-3247"></a><span class="sd">        &gt;&gt;&gt; Matrix.create_vander(2, 4, symbol=&#39;a&#39;)</span>
</span><span id="__span-0-3248"><a id="__codelineno-0-3248" name="__codelineno-0-3248"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-3249"><a id="__codelineno-0-3249" name="__codelineno-0-3249"></a><span class="sd">        [1, a_1, a_1**2, a_1**3]</span>
</span><span id="__span-0-3250"><a id="__codelineno-0-3250" name="__codelineno-0-3250"></a><span class="sd">        [1, a_2, a_2**2, a_2**3]</span>
</span><span id="__span-0-3251"><a id="__codelineno-0-3251" name="__codelineno-0-3251"></a><span class="sd">        ])</span>
</span><span id="__span-0-3252"><a id="__codelineno-0-3252" name="__codelineno-0-3252"></a>
</span><span id="__span-0-3253"><a id="__codelineno-0-3253" name="__codelineno-0-3253"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-3254"><a id="__codelineno-0-3254" name="__codelineno-0-3254"></a><span class="sd">        - [`apply_vander`][..] for applying the Vandermonde transformation to a matrix.</span>
</span><span id="__span-0-3255"><a id="__codelineno-0-3255" name="__codelineno-0-3255"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3256"><a id="__codelineno-0-3256" name="__codelineno-0-3256"></a>
</span><span id="__span-0-3257"><a id="__codelineno-0-3257" name="__codelineno-0-3257"></a>    <span class="n">entries</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">_(1:</span><span class="si">{</span><span class="n">num_rows</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">is_real</span><span class="o">=</span><span class="n">is_real</span><span class="p">)</span>
</span><span id="__span-0-3258"><a id="__codelineno-0-3258" name="__codelineno-0-3258"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-3259"><a id="__codelineno-0-3259" name="__codelineno-0-3259"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
</span><span id="__span-0-3260"><a id="__codelineno-0-3260" name="__codelineno-0-3260"></a>        <span class="n">sub_res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-3261"><a id="__codelineno-0-3261" name="__codelineno-0-3261"></a>        <span class="k">for</span> <span class="n">col_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cols</span><span class="p">):</span>
</span><span id="__span-0-3262"><a id="__codelineno-0-3262" name="__codelineno-0-3262"></a>            <span class="c1"># Raise the symbol to the power of the column index</span>
</span><span id="__span-0-3263"><a id="__codelineno-0-3263" name="__codelineno-0-3263"></a>            <span class="n">sub_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">))</span>
</span><span id="__span-0-3264"><a id="__codelineno-0-3264" name="__codelineno-0-3264"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_res</span><span class="p">)</span>
</span><span id="__span-0-3265"><a id="__codelineno-0-3265" name="__codelineno-0-3265"></a>    <span class="k">return</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.apply_vander" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">apply_vander</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.apply_vander" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Applies a Vandermonde transformation to the current matrix using the given vector.</p>
<p>This method applies a Vandermonde transformation to the current matrix by
substituting the free symbols in the last column with corresponding values
from the provided vector <code>x</code>. The number of rows in <code>self</code> must match the
number of elements in <code>x</code>, and <code>x</code> must be a column vector.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The matrix <code>self</code> is expected to be created via <a class="autorefs autorefs-internal" title="            create_vander(num_rows: int = 1, num_cols: int = 1, symbol: str = 'x', is_real: bool = True) -> Matrix

  
      staticmethod
  " href="#ma1522.symbolic.Matrix.create_vander"><code>Matrix.create_vander()</code></a>.</li>
<li>The <code>x</code> vector provides the values to substitute in place of these symbols.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>A column vector (Matrix object with a single column) containing
the values to substitute into the last column of the matrix.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A new Matrix object where the free symbols in the last column of
the original matrix are substituted by the corresponding values from <code>x</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.matrices.exceptions.ShapeError" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.ShapeError">ShapeError</a></code>
            –
          <div class="doc-md-description">
            <p>If <code>x</code> is not a column vector or if
the number of rows in <code>self</code> does not match the size of <code>x</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">create_vander</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">apply_vander</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1, 1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[1, 2]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3267">3267</a></span>
<span class="normal"><a href="#__codelineno-0-3268">3268</a></span>
<span class="normal"><a href="#__codelineno-0-3269">3269</a></span>
<span class="normal"><a href="#__codelineno-0-3270">3270</a></span>
<span class="normal"><a href="#__codelineno-0-3271">3271</a></span>
<span class="normal"><a href="#__codelineno-0-3272">3272</a></span>
<span class="normal"><a href="#__codelineno-0-3273">3273</a></span>
<span class="normal"><a href="#__codelineno-0-3274">3274</a></span>
<span class="normal"><a href="#__codelineno-0-3275">3275</a></span>
<span class="normal"><a href="#__codelineno-0-3276">3276</a></span>
<span class="normal"><a href="#__codelineno-0-3277">3277</a></span>
<span class="normal"><a href="#__codelineno-0-3278">3278</a></span>
<span class="normal"><a href="#__codelineno-0-3279">3279</a></span>
<span class="normal"><a href="#__codelineno-0-3280">3280</a></span>
<span class="normal"><a href="#__codelineno-0-3281">3281</a></span>
<span class="normal"><a href="#__codelineno-0-3282">3282</a></span>
<span class="normal"><a href="#__codelineno-0-3283">3283</a></span>
<span class="normal"><a href="#__codelineno-0-3284">3284</a></span>
<span class="normal"><a href="#__codelineno-0-3285">3285</a></span>
<span class="normal"><a href="#__codelineno-0-3286">3286</a></span>
<span class="normal"><a href="#__codelineno-0-3287">3287</a></span>
<span class="normal"><a href="#__codelineno-0-3288">3288</a></span>
<span class="normal"><a href="#__codelineno-0-3289">3289</a></span>
<span class="normal"><a href="#__codelineno-0-3290">3290</a></span>
<span class="normal"><a href="#__codelineno-0-3291">3291</a></span>
<span class="normal"><a href="#__codelineno-0-3292">3292</a></span>
<span class="normal"><a href="#__codelineno-0-3293">3293</a></span>
<span class="normal"><a href="#__codelineno-0-3294">3294</a></span>
<span class="normal"><a href="#__codelineno-0-3295">3295</a></span>
<span class="normal"><a href="#__codelineno-0-3296">3296</a></span>
<span class="normal"><a href="#__codelineno-0-3297">3297</a></span>
<span class="normal"><a href="#__codelineno-0-3298">3298</a></span>
<span class="normal"><a href="#__codelineno-0-3299">3299</a></span>
<span class="normal"><a href="#__codelineno-0-3300">3300</a></span>
<span class="normal"><a href="#__codelineno-0-3301">3301</a></span>
<span class="normal"><a href="#__codelineno-0-3302">3302</a></span>
<span class="normal"><a href="#__codelineno-0-3303">3303</a></span>
<span class="normal"><a href="#__codelineno-0-3304">3304</a></span>
<span class="normal"><a href="#__codelineno-0-3305">3305</a></span>
<span class="normal"><a href="#__codelineno-0-3306">3306</a></span>
<span class="normal"><a href="#__codelineno-0-3307">3307</a></span>
<span class="normal"><a href="#__codelineno-0-3308">3308</a></span>
<span class="normal"><a href="#__codelineno-0-3309">3309</a></span>
<span class="normal"><a href="#__codelineno-0-3310">3310</a></span>
<span class="normal"><a href="#__codelineno-0-3311">3311</a></span>
<span class="normal"><a href="#__codelineno-0-3312">3312</a></span>
<span class="normal"><a href="#__codelineno-0-3313">3313</a></span>
<span class="normal"><a href="#__codelineno-0-3314">3314</a></span>
<span class="normal"><a href="#__codelineno-0-3315">3315</a></span>
<span class="normal"><a href="#__codelineno-0-3316">3316</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3267"><a id="__codelineno-0-3267" name="__codelineno-0-3267"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_vander</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-3268"><a id="__codelineno-0-3268" name="__codelineno-0-3268"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3269"><a id="__codelineno-0-3269" name="__codelineno-0-3269"></a><span class="sd">    Applies a Vandermonde transformation to the current matrix using the given vector.</span>
</span><span id="__span-0-3270"><a id="__codelineno-0-3270" name="__codelineno-0-3270"></a>
</span><span id="__span-0-3271"><a id="__codelineno-0-3271" name="__codelineno-0-3271"></a><span class="sd">    This method applies a Vandermonde transformation to the current matrix by</span>
</span><span id="__span-0-3272"><a id="__codelineno-0-3272" name="__codelineno-0-3272"></a><span class="sd">    substituting the free symbols in the last column with corresponding values</span>
</span><span id="__span-0-3273"><a id="__codelineno-0-3273" name="__codelineno-0-3273"></a><span class="sd">    from the provided vector `x`. The number of rows in `self` must match the</span>
</span><span id="__span-0-3274"><a id="__codelineno-0-3274" name="__codelineno-0-3274"></a><span class="sd">    number of elements in `x`, and `x` must be a column vector.</span>
</span><span id="__span-0-3275"><a id="__codelineno-0-3275" name="__codelineno-0-3275"></a>
</span><span id="__span-0-3276"><a id="__codelineno-0-3276" name="__codelineno-0-3276"></a><span class="sd">    Note:</span>
</span><span id="__span-0-3277"><a id="__codelineno-0-3277" name="__codelineno-0-3277"></a><span class="sd">        - The matrix `self` is expected to be created via [`Matrix.create_vander()`][..create_vander].</span>
</span><span id="__span-0-3278"><a id="__codelineno-0-3278" name="__codelineno-0-3278"></a><span class="sd">        - The `x` vector provides the values to substitute in place of these symbols.</span>
</span><span id="__span-0-3279"><a id="__codelineno-0-3279" name="__codelineno-0-3279"></a>
</span><span id="__span-0-3280"><a id="__codelineno-0-3280" name="__codelineno-0-3280"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3281"><a id="__codelineno-0-3281" name="__codelineno-0-3281"></a><span class="sd">        x (Matrix): A column vector (Matrix object with a single column) containing</span>
</span><span id="__span-0-3282"><a id="__codelineno-0-3282" name="__codelineno-0-3282"></a><span class="sd">            the values to substitute into the last column of the matrix.</span>
</span><span id="__span-0-3283"><a id="__codelineno-0-3283" name="__codelineno-0-3283"></a>
</span><span id="__span-0-3284"><a id="__codelineno-0-3284" name="__codelineno-0-3284"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3285"><a id="__codelineno-0-3285" name="__codelineno-0-3285"></a><span class="sd">        (Matrix): A new Matrix object where the free symbols in the last column of</span>
</span><span id="__span-0-3286"><a id="__codelineno-0-3286" name="__codelineno-0-3286"></a><span class="sd">            the original matrix are substituted by the corresponding values from `x`.</span>
</span><span id="__span-0-3287"><a id="__codelineno-0-3287" name="__codelineno-0-3287"></a>
</span><span id="__span-0-3288"><a id="__codelineno-0-3288" name="__codelineno-0-3288"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-3289"><a id="__codelineno-0-3289" name="__codelineno-0-3289"></a><span class="sd">        sympy.matrices.exceptions.ShapeError: If `x` is not a column vector or if</span>
</span><span id="__span-0-3290"><a id="__codelineno-0-3290" name="__codelineno-0-3290"></a><span class="sd">            the number of rows in `self` does not match the size of `x`.</span>
</span><span id="__span-0-3291"><a id="__codelineno-0-3291" name="__codelineno-0-3291"></a>
</span><span id="__span-0-3292"><a id="__codelineno-0-3292" name="__codelineno-0-3292"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3293"><a id="__codelineno-0-3293" name="__codelineno-0-3293"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix.create_vander(2, 2)</span>
</span><span id="__span-0-3294"><a id="__codelineno-0-3294" name="__codelineno-0-3294"></a><span class="sd">        &gt;&gt;&gt; x = Matrix([1, 2])</span>
</span><span id="__span-0-3295"><a id="__codelineno-0-3295" name="__codelineno-0-3295"></a><span class="sd">        &gt;&gt;&gt; mat.apply_vander(x)</span>
</span><span id="__span-0-3296"><a id="__codelineno-0-3296" name="__codelineno-0-3296"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-3297"><a id="__codelineno-0-3297" name="__codelineno-0-3297"></a><span class="sd">        [1, 1]</span>
</span><span id="__span-0-3298"><a id="__codelineno-0-3298" name="__codelineno-0-3298"></a><span class="sd">        [1, 2]</span>
</span><span id="__span-0-3299"><a id="__codelineno-0-3299" name="__codelineno-0-3299"></a><span class="sd">        ])</span>
</span><span id="__span-0-3300"><a id="__codelineno-0-3300" name="__codelineno-0-3300"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3301"><a id="__codelineno-0-3301" name="__codelineno-0-3301"></a>    <span class="c1"># Validate the size of the vector x</span>
</span><span id="__span-0-3302"><a id="__codelineno-0-3302" name="__codelineno-0-3302"></a>    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">cols</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3303"><a id="__codelineno-0-3303" name="__codelineno-0-3303"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">ShapeError</span><span class="p">(</span>
</span><span id="__span-0-3304"><a id="__codelineno-0-3304" name="__codelineno-0-3304"></a>            <span class="sa">f</span><span class="s2">&quot;Input vector x must be a column vector. (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="__span-0-3305"><a id="__codelineno-0-3305" name="__codelineno-0-3305"></a>        <span class="p">)</span>
</span><span id="__span-0-3306"><a id="__codelineno-0-3306" name="__codelineno-0-3306"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-3307"><a id="__codelineno-0-3307" name="__codelineno-0-3307"></a>        <span class="k">raise</span> <span class="n">sym</span><span class="o">.</span><span class="n">ShapeError</span><span class="p">(</span>
</span><span id="__span-0-3308"><a id="__codelineno-0-3308" name="__codelineno-0-3308"></a>            <span class="sa">f</span><span class="s2">&quot;Number of rows in matrix (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">) must match the size of the input vector (</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">rows</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="__span-0-3309"><a id="__codelineno-0-3309" name="__codelineno-0-3309"></a>        <span class="p">)</span>
</span><span id="__span-0-3310"><a id="__codelineno-0-3310" name="__codelineno-0-3310"></a>
</span><span id="__span-0-3311"><a id="__codelineno-0-3311" name="__codelineno-0-3311"></a>    <span class="c1"># Get the free symbols from the last column of the matrix</span>
</span><span id="__span-0-3312"><a id="__codelineno-0-3312" name="__codelineno-0-3312"></a>    <span class="n">ordered_syms</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">free_symbols</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-3313"><a id="__codelineno-0-3313" name="__codelineno-0-3313"></a>
</span><span id="__span-0-3314"><a id="__codelineno-0-3314" name="__codelineno-0-3314"></a>    <span class="c1"># Create a substitution dictionary mapping symbols to values from vector x</span>
</span><span id="__span-0-3315"><a id="__codelineno-0-3315" name="__codelineno-0-3315"></a>    <span class="n">substitution</span> <span class="o">=</span> <span class="p">{</span><span class="n">var</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ordered_syms</span><span class="p">,</span> <span class="n">x</span><span class="p">)}</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-3316"><a id="__codelineno-0-3316" name="__codelineno-0-3316"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">substitution</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.cpoly" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">cpoly</span><span class="p">(</span><span class="n">force_factor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mul</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Mul</span><span class="p">,</span> <span class="n">Mul</span><span class="p">]</span></code>

<a href="#ma1522.symbolic.Matrix.cpoly" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the characteristic polynomial of the matrix and attempts to factor it into real and complex parts.</p>
<p>The characteristic polynomial is defined as <code>det(x * I - self)</code>, where <code>I</code> is the identity matrix of the same size as <code>self</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>force_factor</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, the polynomial is fully factored, even if it doesn't have real factors.
If <code>False</code>, the polynomial is returned in its factored form if possible.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="sympy.core.mul.Mul" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.mul.Mul">Mul</a></code>
          –
          <div class="doc-md-description">
            <p>If the polynomial factors only into real terms, returns a single factored polynomial.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="sympy.core.mul.Mul" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.mul.Mul">Mul</a>, <a class="autorefs autorefs-external" title="sympy.core.mul.Mul" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.mul.Mul">Mul</a>]</code>
          –
          <div class="doc-md-description">
            <p>If the polynomial has both real and complex factors, returns a tuple of two polynomials
one with real factors and the other with complex factors.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">cpoly</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">(x - 4)*(x + 1)</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3322">3322</a></span>
<span class="normal"><a href="#__codelineno-0-3323">3323</a></span>
<span class="normal"><a href="#__codelineno-0-3324">3324</a></span>
<span class="normal"><a href="#__codelineno-0-3325">3325</a></span>
<span class="normal"><a href="#__codelineno-0-3326">3326</a></span>
<span class="normal"><a href="#__codelineno-0-3327">3327</a></span>
<span class="normal"><a href="#__codelineno-0-3328">3328</a></span>
<span class="normal"><a href="#__codelineno-0-3329">3329</a></span>
<span class="normal"><a href="#__codelineno-0-3330">3330</a></span>
<span class="normal"><a href="#__codelineno-0-3331">3331</a></span>
<span class="normal"><a href="#__codelineno-0-3332">3332</a></span>
<span class="normal"><a href="#__codelineno-0-3333">3333</a></span>
<span class="normal"><a href="#__codelineno-0-3334">3334</a></span>
<span class="normal"><a href="#__codelineno-0-3335">3335</a></span>
<span class="normal"><a href="#__codelineno-0-3336">3336</a></span>
<span class="normal"><a href="#__codelineno-0-3337">3337</a></span>
<span class="normal"><a href="#__codelineno-0-3338">3338</a></span>
<span class="normal"><a href="#__codelineno-0-3339">3339</a></span>
<span class="normal"><a href="#__codelineno-0-3340">3340</a></span>
<span class="normal"><a href="#__codelineno-0-3341">3341</a></span>
<span class="normal"><a href="#__codelineno-0-3342">3342</a></span>
<span class="normal"><a href="#__codelineno-0-3343">3343</a></span>
<span class="normal"><a href="#__codelineno-0-3344">3344</a></span>
<span class="normal"><a href="#__codelineno-0-3345">3345</a></span>
<span class="normal"><a href="#__codelineno-0-3346">3346</a></span>
<span class="normal"><a href="#__codelineno-0-3347">3347</a></span>
<span class="normal"><a href="#__codelineno-0-3348">3348</a></span>
<span class="normal"><a href="#__codelineno-0-3349">3349</a></span>
<span class="normal"><a href="#__codelineno-0-3350">3350</a></span>
<span class="normal"><a href="#__codelineno-0-3351">3351</a></span>
<span class="normal"><a href="#__codelineno-0-3352">3352</a></span>
<span class="normal"><a href="#__codelineno-0-3353">3353</a></span>
<span class="normal"><a href="#__codelineno-0-3354">3354</a></span>
<span class="normal"><a href="#__codelineno-0-3355">3355</a></span>
<span class="normal"><a href="#__codelineno-0-3356">3356</a></span>
<span class="normal"><a href="#__codelineno-0-3357">3357</a></span>
<span class="normal"><a href="#__codelineno-0-3358">3358</a></span>
<span class="normal"><a href="#__codelineno-0-3359">3359</a></span>
<span class="normal"><a href="#__codelineno-0-3360">3360</a></span>
<span class="normal"><a href="#__codelineno-0-3361">3361</a></span>
<span class="normal"><a href="#__codelineno-0-3362">3362</a></span>
<span class="normal"><a href="#__codelineno-0-3363">3363</a></span>
<span class="normal"><a href="#__codelineno-0-3364">3364</a></span>
<span class="normal"><a href="#__codelineno-0-3365">3365</a></span>
<span class="normal"><a href="#__codelineno-0-3366">3366</a></span>
<span class="normal"><a href="#__codelineno-0-3367">3367</a></span>
<span class="normal"><a href="#__codelineno-0-3368">3368</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3322"><a id="__codelineno-0-3322" name="__codelineno-0-3322"></a><span class="k">def</span><span class="w"> </span><span class="nf">cpoly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_factor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mul</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Mul</span><span class="p">,</span> <span class="n">Mul</span><span class="p">]:</span>
</span><span id="__span-0-3323"><a id="__codelineno-0-3323" name="__codelineno-0-3323"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the characteristic polynomial of the matrix and attempts to factor it into real and complex parts.</span>
</span><span id="__span-0-3324"><a id="__codelineno-0-3324" name="__codelineno-0-3324"></a>
</span><span id="__span-0-3325"><a id="__codelineno-0-3325" name="__codelineno-0-3325"></a><span class="sd">    The characteristic polynomial is defined as `det(x * I - self)`, where `I` is the identity matrix of the same size as `self`.</span>
</span><span id="__span-0-3326"><a id="__codelineno-0-3326" name="__codelineno-0-3326"></a>
</span><span id="__span-0-3327"><a id="__codelineno-0-3327" name="__codelineno-0-3327"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3328"><a id="__codelineno-0-3328" name="__codelineno-0-3328"></a><span class="sd">        force_factor (bool): If `True`, the polynomial is fully factored, even if it doesn&#39;t have real factors.</span>
</span><span id="__span-0-3329"><a id="__codelineno-0-3329" name="__codelineno-0-3329"></a><span class="sd">            If `False`, the polynomial is returned in its factored form if possible.</span>
</span><span id="__span-0-3330"><a id="__codelineno-0-3330" name="__codelineno-0-3330"></a>
</span><span id="__span-0-3331"><a id="__codelineno-0-3331" name="__codelineno-0-3331"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3332"><a id="__codelineno-0-3332" name="__codelineno-0-3332"></a><span class="sd">        (Mul): If the polynomial factors only into real terms, returns a single factored polynomial.</span>
</span><span id="__span-0-3333"><a id="__codelineno-0-3333" name="__codelineno-0-3333"></a><span class="sd">        (tuple[Mul, Mul]): If the polynomial has both real and complex factors, returns a tuple of two polynomials</span>
</span><span id="__span-0-3334"><a id="__codelineno-0-3334" name="__codelineno-0-3334"></a><span class="sd">            one with real factors and the other with complex factors.</span>
</span><span id="__span-0-3335"><a id="__codelineno-0-3335" name="__codelineno-0-3335"></a>
</span><span id="__span-0-3336"><a id="__codelineno-0-3336" name="__codelineno-0-3336"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3337"><a id="__codelineno-0-3337" name="__codelineno-0-3337"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[-1, 0], [0, 4]])</span>
</span><span id="__span-0-3338"><a id="__codelineno-0-3338" name="__codelineno-0-3338"></a><span class="sd">        &gt;&gt;&gt; mat.cpoly()</span>
</span><span id="__span-0-3339"><a id="__codelineno-0-3339" name="__codelineno-0-3339"></a><span class="sd">        (x - 4)*(x + 1)</span>
</span><span id="__span-0-3340"><a id="__codelineno-0-3340" name="__codelineno-0-3340"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3341"><a id="__codelineno-0-3341" name="__codelineno-0-3341"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3342"><a id="__codelineno-0-3342" name="__codelineno-0-3342"></a>    <span class="n">poly</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
</span><span id="__span-0-3343"><a id="__codelineno-0-3343" name="__codelineno-0-3343"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">force_factor</span><span class="p">:</span>
</span><span id="__span-0-3344"><a id="__codelineno-0-3344" name="__codelineno-0-3344"></a>        <span class="k">return</span> <span class="n">poly</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</span><span id="__span-0-3345"><a id="__codelineno-0-3345" name="__codelineno-0-3345"></a>    <span class="c1"># Attempt to factor poly into real factors</span>
</span><span id="__span-0-3346"><a id="__codelineno-0-3346" name="__codelineno-0-3346"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-3347"><a id="__codelineno-0-3347" name="__codelineno-0-3347"></a>        <span class="n">roots</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span>
</span><span id="__span-0-3348"><a id="__codelineno-0-3348" name="__codelineno-0-3348"></a>            <span class="n">poly</span>
</span><span id="__span-0-3349"><a id="__codelineno-0-3349" name="__codelineno-0-3349"></a>        <span class="p">)</span>  <span class="c1"># TODO: FIX sym.roots NotImplementedError for multi variable</span>
</span><span id="__span-0-3350"><a id="__codelineno-0-3350" name="__codelineno-0-3350"></a>        <span class="n">real_fact</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-3351"><a id="__codelineno-0-3351" name="__codelineno-0-3351"></a>        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">mult</span> <span class="ow">in</span> <span class="n">roots</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-3352"><a id="__codelineno-0-3352" name="__codelineno-0-3352"></a>            <span class="n">term</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">root</span>
</span><span id="__span-0-3353"><a id="__codelineno-0-3353" name="__codelineno-0-3353"></a>            <span class="k">if</span> <span class="n">mult</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3354"><a id="__codelineno-0-3354" name="__codelineno-0-3354"></a>                <span class="n">term</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">mult</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3355"><a id="__codelineno-0-3355" name="__codelineno-0-3355"></a>            <span class="k">if</span> <span class="n">root</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
</span><span id="__span-0-3356"><a id="__codelineno-0-3356" name="__codelineno-0-3356"></a>                <span class="n">real_fact</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
</span><span id="__span-0-3357"><a id="__codelineno-0-3357" name="__codelineno-0-3357"></a>                <span class="n">poly</span> <span class="o">/=</span> <span class="n">term</span>
</span><span id="__span-0-3358"><a id="__codelineno-0-3358" name="__codelineno-0-3358"></a>
</span><span id="__span-0-3359"><a id="__codelineno-0-3359" name="__codelineno-0-3359"></a>        <span class="n">linear_fact</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">real_fact</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3360"><a id="__codelineno-0-3360" name="__codelineno-0-3360"></a>        <span class="n">complex_fact</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</span><span id="__span-0-3361"><a id="__codelineno-0-3361" name="__codelineno-0-3361"></a>
</span><span id="__span-0-3362"><a id="__codelineno-0-3362" name="__codelineno-0-3362"></a>        <span class="k">if</span> <span class="n">complex_fact</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3363"><a id="__codelineno-0-3363" name="__codelineno-0-3363"></a>            <span class="k">return</span> <span class="n">linear_fact</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-3364"><a id="__codelineno-0-3364" name="__codelineno-0-3364"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3365"><a id="__codelineno-0-3365" name="__codelineno-0-3365"></a>            <span class="k">return</span> <span class="n">linear_fact</span><span class="p">,</span> <span class="n">complex_fact</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-3366"><a id="__codelineno-0-3366" name="__codelineno-0-3366"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
</span><span id="__span-0-3367"><a id="__codelineno-0-3367" name="__codelineno-0-3367"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encountered Error: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-3368"><a id="__codelineno-0-3368" name="__codelineno-0-3368"></a>        <span class="k">return</span> <span class="n">poly</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.is_diagonalizable" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_diagonalizable</span><span class="p">(</span><span class="n">reals_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#ma1522.symbolic.Matrix.is_diagonalizable" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if the matrix is diagonalizable, with the option to focus only on real eigenvalues.</p>
<p>A matrix is diagonalizable if it has enough linearly independent eigenvectors to form a basis for the space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>reals_only</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, diagonalization will focus on real eigenvalues.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Controls the level of output during the diagonalization process.</p>
<ul>
<li>0: No output.</li>
<li>1: Displays the characteristic polynomial, eigenvalues, algebraic multiplicities, and eigenspaces.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Additional positional arguments passed to SymPy's
<a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.is_diagonalizable"><code>is_diagonalizable</code></a> method.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments passed to SymPy's
<a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.is_diagonalizable"><code>is_diagonalizable</code></a> method.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p>True if the matrix is diagonalizable, False otherwise.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">(</span><span class="n">reals_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">True</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.is_diagonalizable"><code>Matrix.is_diagonalizable</code></a></li>
<li>Sympy's <a class="autorefs autorefs-internal" title="            eigenvects(error_when_incomplete=True, iszerofunc=_iszero, **flags)" href="../inherited/#ma1522.symbolic.Matrix.eigenvects"><code>Matrix.eigenvects</code></a> for computing eigenvalues and their multiplicities.</li>
<li><a class="autorefs autorefs-internal" title="            diagonalize(reals_only: bool = True, verbosity: int = 0, *args, **kwargs) -> PDP" href="#ma1522.symbolic.Matrix.diagonalize"><code>diagonalize</code></a> for diagonalizing the matrix.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3371">3371</a></span>
<span class="normal"><a href="#__codelineno-0-3372">3372</a></span>
<span class="normal"><a href="#__codelineno-0-3373">3373</a></span>
<span class="normal"><a href="#__codelineno-0-3374">3374</a></span>
<span class="normal"><a href="#__codelineno-0-3375">3375</a></span>
<span class="normal"><a href="#__codelineno-0-3376">3376</a></span>
<span class="normal"><a href="#__codelineno-0-3377">3377</a></span>
<span class="normal"><a href="#__codelineno-0-3378">3378</a></span>
<span class="normal"><a href="#__codelineno-0-3379">3379</a></span>
<span class="normal"><a href="#__codelineno-0-3380">3380</a></span>
<span class="normal"><a href="#__codelineno-0-3381">3381</a></span>
<span class="normal"><a href="#__codelineno-0-3382">3382</a></span>
<span class="normal"><a href="#__codelineno-0-3383">3383</a></span>
<span class="normal"><a href="#__codelineno-0-3384">3384</a></span>
<span class="normal"><a href="#__codelineno-0-3385">3385</a></span>
<span class="normal"><a href="#__codelineno-0-3386">3386</a></span>
<span class="normal"><a href="#__codelineno-0-3387">3387</a></span>
<span class="normal"><a href="#__codelineno-0-3388">3388</a></span>
<span class="normal"><a href="#__codelineno-0-3389">3389</a></span>
<span class="normal"><a href="#__codelineno-0-3390">3390</a></span>
<span class="normal"><a href="#__codelineno-0-3391">3391</a></span>
<span class="normal"><a href="#__codelineno-0-3392">3392</a></span>
<span class="normal"><a href="#__codelineno-0-3393">3393</a></span>
<span class="normal"><a href="#__codelineno-0-3394">3394</a></span>
<span class="normal"><a href="#__codelineno-0-3395">3395</a></span>
<span class="normal"><a href="#__codelineno-0-3396">3396</a></span>
<span class="normal"><a href="#__codelineno-0-3397">3397</a></span>
<span class="normal"><a href="#__codelineno-0-3398">3398</a></span>
<span class="normal"><a href="#__codelineno-0-3399">3399</a></span>
<span class="normal"><a href="#__codelineno-0-3400">3400</a></span>
<span class="normal"><a href="#__codelineno-0-3401">3401</a></span>
<span class="normal"><a href="#__codelineno-0-3402">3402</a></span>
<span class="normal"><a href="#__codelineno-0-3403">3403</a></span>
<span class="normal"><a href="#__codelineno-0-3404">3404</a></span>
<span class="normal"><a href="#__codelineno-0-3405">3405</a></span>
<span class="normal"><a href="#__codelineno-0-3406">3406</a></span>
<span class="normal"><a href="#__codelineno-0-3407">3407</a></span>
<span class="normal"><a href="#__codelineno-0-3408">3408</a></span>
<span class="normal"><a href="#__codelineno-0-3409">3409</a></span>
<span class="normal"><a href="#__codelineno-0-3410">3410</a></span>
<span class="normal"><a href="#__codelineno-0-3411">3411</a></span>
<span class="normal"><a href="#__codelineno-0-3412">3412</a></span>
<span class="normal"><a href="#__codelineno-0-3413">3413</a></span>
<span class="normal"><a href="#__codelineno-0-3414">3414</a></span>
<span class="normal"><a href="#__codelineno-0-3415">3415</a></span>
<span class="normal"><a href="#__codelineno-0-3416">3416</a></span>
<span class="normal"><a href="#__codelineno-0-3417">3417</a></span>
<span class="normal"><a href="#__codelineno-0-3418">3418</a></span>
<span class="normal"><a href="#__codelineno-0-3419">3419</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3371"><a id="__codelineno-0-3371" name="__codelineno-0-3371"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_diagonalizable</span><span class="p">(</span>
</span><span id="__span-0-3372"><a id="__codelineno-0-3372" name="__codelineno-0-3372"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">reals_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-3373"><a id="__codelineno-0-3373" name="__codelineno-0-3373"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-3374"><a id="__codelineno-0-3374" name="__codelineno-0-3374"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the matrix is diagonalizable, with the option to focus only on real eigenvalues.</span>
</span><span id="__span-0-3375"><a id="__codelineno-0-3375" name="__codelineno-0-3375"></a>
</span><span id="__span-0-3376"><a id="__codelineno-0-3376" name="__codelineno-0-3376"></a><span class="sd">    A matrix is diagonalizable if it has enough linearly independent eigenvectors to form a basis for the space.</span>
</span><span id="__span-0-3377"><a id="__codelineno-0-3377" name="__codelineno-0-3377"></a>
</span><span id="__span-0-3378"><a id="__codelineno-0-3378" name="__codelineno-0-3378"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3379"><a id="__codelineno-0-3379" name="__codelineno-0-3379"></a><span class="sd">        reals_only (bool, optional): If True, diagonalization will focus on real eigenvalues.</span>
</span><span id="__span-0-3380"><a id="__codelineno-0-3380" name="__codelineno-0-3380"></a><span class="sd">        verbosity (int, optional): Controls the level of output during the diagonalization process.</span>
</span><span id="__span-0-3381"><a id="__codelineno-0-3381" name="__codelineno-0-3381"></a>
</span><span id="__span-0-3382"><a id="__codelineno-0-3382" name="__codelineno-0-3382"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-3383"><a id="__codelineno-0-3383" name="__codelineno-0-3383"></a><span class="sd">            - 1: Displays the characteristic polynomial, eigenvalues, algebraic multiplicities, and eigenspaces.</span>
</span><span id="__span-0-3384"><a id="__codelineno-0-3384" name="__codelineno-0-3384"></a>
</span><span id="__span-0-3385"><a id="__codelineno-0-3385" name="__codelineno-0-3385"></a><span class="sd">        *args: Additional positional arguments passed to SymPy&#39;s</span>
</span><span id="__span-0-3386"><a id="__codelineno-0-3386" name="__codelineno-0-3386"></a><span class="sd">            [`is_diagonalizable`][sympy.matrices.matrixbase.MatrixBase.is_diagonalizable] method.</span>
</span><span id="__span-0-3387"><a id="__codelineno-0-3387" name="__codelineno-0-3387"></a><span class="sd">        **kwargs: Additional arguments passed to SymPy&#39;s</span>
</span><span id="__span-0-3388"><a id="__codelineno-0-3388" name="__codelineno-0-3388"></a><span class="sd">            [`is_diagonalizable`][sympy.matrices.matrixbase.MatrixBase.is_diagonalizable] method.</span>
</span><span id="__span-0-3389"><a id="__codelineno-0-3389" name="__codelineno-0-3389"></a>
</span><span id="__span-0-3390"><a id="__codelineno-0-3390" name="__codelineno-0-3390"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3391"><a id="__codelineno-0-3391" name="__codelineno-0-3391"></a><span class="sd">        (bool): True if the matrix is diagonalizable, False otherwise.</span>
</span><span id="__span-0-3392"><a id="__codelineno-0-3392" name="__codelineno-0-3392"></a>
</span><span id="__span-0-3393"><a id="__codelineno-0-3393" name="__codelineno-0-3393"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3394"><a id="__codelineno-0-3394" name="__codelineno-0-3394"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2, 0], [0, 3, 0], [2, -4, 2]])</span>
</span><span id="__span-0-3395"><a id="__codelineno-0-3395" name="__codelineno-0-3395"></a><span class="sd">        &gt;&gt;&gt; mat.is_diagonalizable(reals_only=True, verbosity=0)</span>
</span><span id="__span-0-3396"><a id="__codelineno-0-3396" name="__codelineno-0-3396"></a><span class="sd">        True</span>
</span><span id="__span-0-3397"><a id="__codelineno-0-3397" name="__codelineno-0-3397"></a>
</span><span id="__span-0-3398"><a id="__codelineno-0-3398" name="__codelineno-0-3398"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-3399"><a id="__codelineno-0-3399" name="__codelineno-0-3399"></a><span class="sd">        - SymPy&#39;s [`Matrix.is_diagonalizable`][sympy.matrices.matrixbase.MatrixBase.is_diagonalizable]</span>
</span><span id="__span-0-3400"><a id="__codelineno-0-3400" name="__codelineno-0-3400"></a><span class="sd">        - Sympy&#39;s [`Matrix.eigenvects`][sympy.matrices.matrixbase.MatrixBase.eigenvects] for computing eigenvalues and their multiplicities.</span>
</span><span id="__span-0-3401"><a id="__codelineno-0-3401" name="__codelineno-0-3401"></a><span class="sd">        - [`diagonalize`][..] for diagonalizing the matrix.</span>
</span><span id="__span-0-3402"><a id="__codelineno-0-3402" name="__codelineno-0-3402"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3403"><a id="__codelineno-0-3403" name="__codelineno-0-3403"></a>
</span><span id="__span-0-3404"><a id="__codelineno-0-3404" name="__codelineno-0-3404"></a>    <span class="c1"># Changed default for reals_only to True to align with MA1522 syllabus</span>
</span><span id="__span-0-3405"><a id="__codelineno-0-3405" name="__codelineno-0-3405"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3406"><a id="__codelineno-0-3406" name="__codelineno-0-3406"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Characteristic Polynomial is: &quot;</span><span class="p">)</span>
</span><span id="__span-0-3407"><a id="__codelineno-0-3407" name="__codelineno-0-3407"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpoly</span><span class="p">())</span>
</span><span id="__span-0-3408"><a id="__codelineno-0-3408" name="__codelineno-0-3408"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Check if algebraic multiplicity equals number of eigenvectors.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-3409"><a id="__codelineno-0-3409" name="__codelineno-0-3409"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eigenvectors are:&quot;</span><span class="p">)</span>
</span><span id="__span-0-3410"><a id="__codelineno-0-3410" name="__codelineno-0-3410"></a>        <span class="k">for</span> <span class="n">val</span><span class="p">,</span> <span class="n">mult</span><span class="p">,</span> <span class="n">space</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigenvects</span><span class="p">():</span>
</span><span id="__span-0-3411"><a id="__codelineno-0-3411" name="__codelineno-0-3411"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">is_real</span> <span class="ow">and</span> <span class="n">reals_only</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">reals_only</span><span class="p">:</span>
</span><span id="__span-0-3412"><a id="__codelineno-0-3412" name="__codelineno-0-3412"></a>                <span class="n">res</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-3413"><a id="__codelineno-0-3413" name="__codelineno-0-3413"></a>                    <span class="s2">&quot;eigenvalue&quot;</span><span class="p">:</span> <span class="n">val</span><span class="p">,</span>
</span><span id="__span-0-3414"><a id="__codelineno-0-3414" name="__codelineno-0-3414"></a>                    <span class="s2">&quot;algebraic multiplicity&quot;</span><span class="p">:</span> <span class="n">mult</span><span class="p">,</span>
</span><span id="__span-0-3415"><a id="__codelineno-0-3415" name="__codelineno-0-3415"></a>                    <span class="s2">&quot;eigenspace&quot;</span><span class="p">:</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">space</span><span class="p">),</span>
</span><span id="__span-0-3416"><a id="__codelineno-0-3416" name="__codelineno-0-3416"></a>                <span class="p">}</span>
</span><span id="__span-0-3417"><a id="__codelineno-0-3417" name="__codelineno-0-3417"></a>                <span class="n">display</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;dict&quot;</span><span class="p">)</span>
</span><span id="__span-0-3418"><a id="__codelineno-0-3418" name="__codelineno-0-3418"></a>
</span><span id="__span-0-3419"><a id="__codelineno-0-3419" name="__codelineno-0-3419"></a>    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">(</span><span class="n">reals_only</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.eigenvects_associated" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">eigenvects_associated</span><span class="p">(</span><span class="n">eigenvalue</span><span class="p">:</span> <span class="n">Expr</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span></code>

<a href="#ma1522.symbolic.Matrix.eigenvects_associated" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the eigenvectors associated with a given eigenvalue.</p>
<p>This method finds all (nonzero) vectors <code>v</code> such that <code>(eigenvalue * I - self) * v = 0</code>
where <code>I</code> is the identity matrix of the same size as <code>self</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>eigenvalue</code></b>
              (<code><a class="autorefs autorefs-external" title="sympy.core.expr.Expr" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.expr.Expr">Expr</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The eigenvalue for which to compute the associated eigenvectors.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a>]</code>
          –
          <div class="doc-md-description">
            <p>A list of eigenvectors (as Matrix objects) associated with the given eigenvalue,</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code>None</code>
          –
          <div class="doc-md-description">
            <p>If the eigenvalue does not correspond to any eigenvectors.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">eigenvects_associated</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">[Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[1],</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[0]])]</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3421">3421</a></span>
<span class="normal"><a href="#__codelineno-0-3422">3422</a></span>
<span class="normal"><a href="#__codelineno-0-3423">3423</a></span>
<span class="normal"><a href="#__codelineno-0-3424">3424</a></span>
<span class="normal"><a href="#__codelineno-0-3425">3425</a></span>
<span class="normal"><a href="#__codelineno-0-3426">3426</a></span>
<span class="normal"><a href="#__codelineno-0-3427">3427</a></span>
<span class="normal"><a href="#__codelineno-0-3428">3428</a></span>
<span class="normal"><a href="#__codelineno-0-3429">3429</a></span>
<span class="normal"><a href="#__codelineno-0-3430">3430</a></span>
<span class="normal"><a href="#__codelineno-0-3431">3431</a></span>
<span class="normal"><a href="#__codelineno-0-3432">3432</a></span>
<span class="normal"><a href="#__codelineno-0-3433">3433</a></span>
<span class="normal"><a href="#__codelineno-0-3434">3434</a></span>
<span class="normal"><a href="#__codelineno-0-3435">3435</a></span>
<span class="normal"><a href="#__codelineno-0-3436">3436</a></span>
<span class="normal"><a href="#__codelineno-0-3437">3437</a></span>
<span class="normal"><a href="#__codelineno-0-3438">3438</a></span>
<span class="normal"><a href="#__codelineno-0-3439">3439</a></span>
<span class="normal"><a href="#__codelineno-0-3440">3440</a></span>
<span class="normal"><a href="#__codelineno-0-3441">3441</a></span>
<span class="normal"><a href="#__codelineno-0-3442">3442</a></span>
<span class="normal"><a href="#__codelineno-0-3443">3443</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3421"><a id="__codelineno-0-3421" name="__codelineno-0-3421"></a><span class="k">def</span><span class="w"> </span><span class="nf">eigenvects_associated</span><span class="p">(</span>
</span><span id="__span-0-3422"><a id="__codelineno-0-3422" name="__codelineno-0-3422"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">eigenvalue</span><span class="p">:</span> <span class="n">Expr</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span>
</span><span id="__span-0-3423"><a id="__codelineno-0-3423" name="__codelineno-0-3423"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-3424"><a id="__codelineno-0-3424" name="__codelineno-0-3424"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the eigenvectors associated with a given eigenvalue.</span>
</span><span id="__span-0-3425"><a id="__codelineno-0-3425" name="__codelineno-0-3425"></a>
</span><span id="__span-0-3426"><a id="__codelineno-0-3426" name="__codelineno-0-3426"></a><span class="sd">    This method finds all (nonzero) vectors `v` such that `(eigenvalue * I - self) * v = 0`</span>
</span><span id="__span-0-3427"><a id="__codelineno-0-3427" name="__codelineno-0-3427"></a><span class="sd">    where `I` is the identity matrix of the same size as `self`.</span>
</span><span id="__span-0-3428"><a id="__codelineno-0-3428" name="__codelineno-0-3428"></a>
</span><span id="__span-0-3429"><a id="__codelineno-0-3429" name="__codelineno-0-3429"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3430"><a id="__codelineno-0-3430" name="__codelineno-0-3430"></a><span class="sd">        eigenvalue (Expr | int | float): The eigenvalue for which to compute the associated eigenvectors.</span>
</span><span id="__span-0-3431"><a id="__codelineno-0-3431" name="__codelineno-0-3431"></a>
</span><span id="__span-0-3432"><a id="__codelineno-0-3432" name="__codelineno-0-3432"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3433"><a id="__codelineno-0-3433" name="__codelineno-0-3433"></a><span class="sd">        (list[Matrix]): A list of eigenvectors (as Matrix objects) associated with the given eigenvalue,</span>
</span><span id="__span-0-3434"><a id="__codelineno-0-3434" name="__codelineno-0-3434"></a><span class="sd">        (None): If the eigenvalue does not correspond to any eigenvectors.</span>
</span><span id="__span-0-3435"><a id="__codelineno-0-3435" name="__codelineno-0-3435"></a>
</span><span id="__span-0-3436"><a id="__codelineno-0-3436" name="__codelineno-0-3436"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3437"><a id="__codelineno-0-3437" name="__codelineno-0-3437"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[2, 0], [0, 3]])</span>
</span><span id="__span-0-3438"><a id="__codelineno-0-3438" name="__codelineno-0-3438"></a><span class="sd">        &gt;&gt;&gt; mat.eigenvects_associated(2)</span>
</span><span id="__span-0-3439"><a id="__codelineno-0-3439" name="__codelineno-0-3439"></a><span class="sd">        [Matrix([</span>
</span><span id="__span-0-3440"><a id="__codelineno-0-3440" name="__codelineno-0-3440"></a><span class="sd">        [1],</span>
</span><span id="__span-0-3441"><a id="__codelineno-0-3441" name="__codelineno-0-3441"></a><span class="sd">        [0]])]</span>
</span><span id="__span-0-3442"><a id="__codelineno-0-3442" name="__codelineno-0-3442"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3443"><a id="__codelineno-0-3443" name="__codelineno-0-3443"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">eigenvalue</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.diagonalize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">diagonalize</span><span class="p">(</span><span class="n">reals_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDP</span></code>

<a href="#ma1522.symbolic.Matrix.diagonalize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Diagonalizes the matrix if possible, focusing on real eigenvalues unless specified otherwise.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>reals_only</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, diagonalization will focus on real eigenvalues.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Controls the level of output during the diagonalization process.</p>
<ul>
<li>0: No output.</li>
<li>1: Displays the characteristic polynomial and eigenvectors.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Additional positional arguments passed to SymPy's
<a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.diagonalize"><code>diagonalize</code></a> method.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments passed to SymPy's
<a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.diagonalize"><code>diagonalize</code></a> method.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              PDP(P: Matrix, D: Matrix)

  
      dataclass
   (ma1522.custom_types.PDP)" href="../custom_types/#ma1522.custom_types.PDP">PDP</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing:</p>
<ul>
<li><code>P</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The matrix of eigenvectors.</li>
<li><code>D</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The diagonal matrix of eigenvalues.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span>
<span class="normal"><a href="#__codelineno-0-8">8</a></span>
<span class="normal"><a href="#__codelineno-0-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">PDP(P=Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[-sqrt(33)/6 - 1/2, -1/2 + sqrt(33)/6]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[                1,                 1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">]), D=Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[5/2 - sqrt(33)/2,                0]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[               0, 5/2 + sqrt(33)/2]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3446">3446</a></span>
<span class="normal"><a href="#__codelineno-0-3447">3447</a></span>
<span class="normal"><a href="#__codelineno-0-3448">3448</a></span>
<span class="normal"><a href="#__codelineno-0-3449">3449</a></span>
<span class="normal"><a href="#__codelineno-0-3450">3450</a></span>
<span class="normal"><a href="#__codelineno-0-3451">3451</a></span>
<span class="normal"><a href="#__codelineno-0-3452">3452</a></span>
<span class="normal"><a href="#__codelineno-0-3453">3453</a></span>
<span class="normal"><a href="#__codelineno-0-3454">3454</a></span>
<span class="normal"><a href="#__codelineno-0-3455">3455</a></span>
<span class="normal"><a href="#__codelineno-0-3456">3456</a></span>
<span class="normal"><a href="#__codelineno-0-3457">3457</a></span>
<span class="normal"><a href="#__codelineno-0-3458">3458</a></span>
<span class="normal"><a href="#__codelineno-0-3459">3459</a></span>
<span class="normal"><a href="#__codelineno-0-3460">3460</a></span>
<span class="normal"><a href="#__codelineno-0-3461">3461</a></span>
<span class="normal"><a href="#__codelineno-0-3462">3462</a></span>
<span class="normal"><a href="#__codelineno-0-3463">3463</a></span>
<span class="normal"><a href="#__codelineno-0-3464">3464</a></span>
<span class="normal"><a href="#__codelineno-0-3465">3465</a></span>
<span class="normal"><a href="#__codelineno-0-3466">3466</a></span>
<span class="normal"><a href="#__codelineno-0-3467">3467</a></span>
<span class="normal"><a href="#__codelineno-0-3468">3468</a></span>
<span class="normal"><a href="#__codelineno-0-3469">3469</a></span>
<span class="normal"><a href="#__codelineno-0-3470">3470</a></span>
<span class="normal"><a href="#__codelineno-0-3471">3471</a></span>
<span class="normal"><a href="#__codelineno-0-3472">3472</a></span>
<span class="normal"><a href="#__codelineno-0-3473">3473</a></span>
<span class="normal"><a href="#__codelineno-0-3474">3474</a></span>
<span class="normal"><a href="#__codelineno-0-3475">3475</a></span>
<span class="normal"><a href="#__codelineno-0-3476">3476</a></span>
<span class="normal"><a href="#__codelineno-0-3477">3477</a></span>
<span class="normal"><a href="#__codelineno-0-3478">3478</a></span>
<span class="normal"><a href="#__codelineno-0-3479">3479</a></span>
<span class="normal"><a href="#__codelineno-0-3480">3480</a></span>
<span class="normal"><a href="#__codelineno-0-3481">3481</a></span>
<span class="normal"><a href="#__codelineno-0-3482">3482</a></span>
<span class="normal"><a href="#__codelineno-0-3483">3483</a></span>
<span class="normal"><a href="#__codelineno-0-3484">3484</a></span>
<span class="normal"><a href="#__codelineno-0-3485">3485</a></span>
<span class="normal"><a href="#__codelineno-0-3486">3486</a></span>
<span class="normal"><a href="#__codelineno-0-3487">3487</a></span>
<span class="normal"><a href="#__codelineno-0-3488">3488</a></span>
<span class="normal"><a href="#__codelineno-0-3489">3489</a></span>
<span class="normal"><a href="#__codelineno-0-3490">3490</a></span>
<span class="normal"><a href="#__codelineno-0-3491">3491</a></span>
<span class="normal"><a href="#__codelineno-0-3492">3492</a></span>
<span class="normal"><a href="#__codelineno-0-3493">3493</a></span>
<span class="normal"><a href="#__codelineno-0-3494">3494</a></span>
<span class="normal"><a href="#__codelineno-0-3495">3495</a></span>
<span class="normal"><a href="#__codelineno-0-3496">3496</a></span>
<span class="normal"><a href="#__codelineno-0-3497">3497</a></span>
<span class="normal"><a href="#__codelineno-0-3498">3498</a></span>
<span class="normal"><a href="#__codelineno-0-3499">3499</a></span>
<span class="normal"><a href="#__codelineno-0-3500">3500</a></span>
<span class="normal"><a href="#__codelineno-0-3501">3501</a></span>
<span class="normal"><a href="#__codelineno-0-3502">3502</a></span>
<span class="normal"><a href="#__codelineno-0-3503">3503</a></span>
<span class="normal"><a href="#__codelineno-0-3504">3504</a></span>
<span class="normal"><a href="#__codelineno-0-3505">3505</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3446"><a id="__codelineno-0-3446" name="__codelineno-0-3446"></a><span class="k">def</span><span class="w"> </span><span class="nf">diagonalize</span><span class="p">(</span>
</span><span id="__span-0-3447"><a id="__codelineno-0-3447" name="__codelineno-0-3447"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">reals_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-3448"><a id="__codelineno-0-3448" name="__codelineno-0-3448"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDP</span><span class="p">:</span>
</span><span id="__span-0-3449"><a id="__codelineno-0-3449" name="__codelineno-0-3449"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Diagonalizes the matrix if possible, focusing on real eigenvalues unless specified otherwise.</span>
</span><span id="__span-0-3450"><a id="__codelineno-0-3450" name="__codelineno-0-3450"></a>
</span><span id="__span-0-3451"><a id="__codelineno-0-3451" name="__codelineno-0-3451"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3452"><a id="__codelineno-0-3452" name="__codelineno-0-3452"></a><span class="sd">        reals_only (bool, optional): If `True`, diagonalization will focus on real eigenvalues.</span>
</span><span id="__span-0-3453"><a id="__codelineno-0-3453" name="__codelineno-0-3453"></a><span class="sd">        verbosity (int, optional): Controls the level of output during the diagonalization process.</span>
</span><span id="__span-0-3454"><a id="__codelineno-0-3454" name="__codelineno-0-3454"></a>
</span><span id="__span-0-3455"><a id="__codelineno-0-3455" name="__codelineno-0-3455"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-3456"><a id="__codelineno-0-3456" name="__codelineno-0-3456"></a><span class="sd">            - 1: Displays the characteristic polynomial and eigenvectors.</span>
</span><span id="__span-0-3457"><a id="__codelineno-0-3457" name="__codelineno-0-3457"></a><span class="sd">        *args: Additional positional arguments passed to SymPy&#39;s</span>
</span><span id="__span-0-3458"><a id="__codelineno-0-3458" name="__codelineno-0-3458"></a><span class="sd">            [`diagonalize`][sympy.matrices.matrixbase.MatrixBase.diagonalize] method.</span>
</span><span id="__span-0-3459"><a id="__codelineno-0-3459" name="__codelineno-0-3459"></a><span class="sd">        **kwargs: Additional arguments passed to SymPy&#39;s</span>
</span><span id="__span-0-3460"><a id="__codelineno-0-3460" name="__codelineno-0-3460"></a><span class="sd">            [`diagonalize`][sympy.matrices.matrixbase.MatrixBase.diagonalize] method.</span>
</span><span id="__span-0-3461"><a id="__codelineno-0-3461" name="__codelineno-0-3461"></a>
</span><span id="__span-0-3462"><a id="__codelineno-0-3462" name="__codelineno-0-3462"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3463"><a id="__codelineno-0-3463" name="__codelineno-0-3463"></a><span class="sd">        (PDP): A dataclass containing:</span>
</span><span id="__span-0-3464"><a id="__codelineno-0-3464" name="__codelineno-0-3464"></a>
</span><span id="__span-0-3465"><a id="__codelineno-0-3465" name="__codelineno-0-3465"></a><span class="sd">            - `P` ([`Matrix`][...]): The matrix of eigenvectors.</span>
</span><span id="__span-0-3466"><a id="__codelineno-0-3466" name="__codelineno-0-3466"></a><span class="sd">            - `D` ([`Matrix`][...]): The diagonal matrix of eigenvalues.</span>
</span><span id="__span-0-3467"><a id="__codelineno-0-3467" name="__codelineno-0-3467"></a>
</span><span id="__span-0-3468"><a id="__codelineno-0-3468" name="__codelineno-0-3468"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3469"><a id="__codelineno-0-3469" name="__codelineno-0-3469"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [3, 4]])</span>
</span><span id="__span-0-3470"><a id="__codelineno-0-3470" name="__codelineno-0-3470"></a><span class="sd">        &gt;&gt;&gt; mat.diagonalize()</span>
</span><span id="__span-0-3471"><a id="__codelineno-0-3471" name="__codelineno-0-3471"></a><span class="sd">        PDP(P=Matrix([</span>
</span><span id="__span-0-3472"><a id="__codelineno-0-3472" name="__codelineno-0-3472"></a><span class="sd">        [-sqrt(33)/6 - 1/2, -1/2 + sqrt(33)/6]</span>
</span><span id="__span-0-3473"><a id="__codelineno-0-3473" name="__codelineno-0-3473"></a><span class="sd">        [                1,                 1]</span>
</span><span id="__span-0-3474"><a id="__codelineno-0-3474" name="__codelineno-0-3474"></a><span class="sd">        ]), D=Matrix([</span>
</span><span id="__span-0-3475"><a id="__codelineno-0-3475" name="__codelineno-0-3475"></a><span class="sd">        [5/2 - sqrt(33)/2,                0]</span>
</span><span id="__span-0-3476"><a id="__codelineno-0-3476" name="__codelineno-0-3476"></a><span class="sd">        [               0, 5/2 + sqrt(33)/2]</span>
</span><span id="__span-0-3477"><a id="__codelineno-0-3477" name="__codelineno-0-3477"></a><span class="sd">        ]))</span>
</span><span id="__span-0-3478"><a id="__codelineno-0-3478" name="__codelineno-0-3478"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3479"><a id="__codelineno-0-3479" name="__codelineno-0-3479"></a>
</span><span id="__span-0-3480"><a id="__codelineno-0-3480" name="__codelineno-0-3480"></a>    <span class="c1"># Changed default for reals_only to True to align with MA1522 syllabus</span>
</span><span id="__span-0-3481"><a id="__codelineno-0-3481" name="__codelineno-0-3481"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3482"><a id="__codelineno-0-3482" name="__codelineno-0-3482"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Characteristic Polynomial&quot;</span><span class="p">)</span>
</span><span id="__span-0-3483"><a id="__codelineno-0-3483" name="__codelineno-0-3483"></a>        <span class="n">poly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpoly</span><span class="p">()</span>
</span><span id="__span-0-3484"><a id="__codelineno-0-3484" name="__codelineno-0-3484"></a>        <span class="n">display</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
</span><span id="__span-0-3485"><a id="__codelineno-0-3485" name="__codelineno-0-3485"></a>        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sym</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-3486"><a id="__codelineno-0-3486" name="__codelineno-0-3486"></a>            <span class="k">if</span> <span class="n">root</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
</span><span id="__span-0-3487"><a id="__codelineno-0-3487" name="__codelineno-0-3487"></a>                <span class="n">display</span><span class="p">(</span>
</span><span id="__span-0-3488"><a id="__codelineno-0-3488" name="__codelineno-0-3488"></a>                    <span class="n">_textify</span><span class="p">(</span><span class="s2">&quot;Before RREF: &quot;</span><span class="p">)</span>
</span><span id="__span-0-3489"><a id="__codelineno-0-3489" name="__codelineno-0-3489"></a>                    <span class="o">+</span> <span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="__span-0-3490"><a id="__codelineno-0-3490" name="__codelineno-0-3490"></a>                    <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\mathbb</span><span class="si">{I}</span><span class="s2"> - \mathrm</span><span class="si">{self}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3491"><a id="__codelineno-0-3491" name="__codelineno-0-3491"></a>                    <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">,</span>
</span><span id="__span-0-3492"><a id="__codelineno-0-3492" name="__codelineno-0-3492"></a>                <span class="p">)</span>
</span><span id="__span-0-3493"><a id="__codelineno-0-3493" name="__codelineno-0-3493"></a>                <span class="n">expr</span> <span class="o">=</span> <span class="n">root</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span>
</span><span id="__span-0-3494"><a id="__codelineno-0-3494" name="__codelineno-0-3494"></a>                <span class="n">display</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</span><span id="__span-0-3495"><a id="__codelineno-0-3495" name="__codelineno-0-3495"></a>
</span><span id="__span-0-3496"><a id="__codelineno-0-3496" name="__codelineno-0-3496"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After RREF:&quot;</span><span class="p">)</span>
</span><span id="__span-0-3497"><a id="__codelineno-0-3497" name="__codelineno-0-3497"></a>                <span class="n">display</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">rref</span><span class="p">())</span>
</span><span id="__span-0-3498"><a id="__codelineno-0-3498" name="__codelineno-0-3498"></a>
</span><span id="__span-0-3499"><a id="__codelineno-0-3499" name="__codelineno-0-3499"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Eigenvectors:&quot;</span><span class="p">)</span>
</span><span id="__span-0-3500"><a id="__codelineno-0-3500" name="__codelineno-0-3500"></a>                <span class="n">display</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">nullspace</span><span class="p">())</span>
</span><span id="__span-0-3501"><a id="__codelineno-0-3501" name="__codelineno-0-3501"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-3502"><a id="__codelineno-0-3502" name="__codelineno-0-3502"></a>
</span><span id="__span-0-3503"><a id="__codelineno-0-3503" name="__codelineno-0-3503"></a>    <span class="n">P</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span><span class="n">reals_only</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-0-3504"><a id="__codelineno-0-3504" name="__codelineno-0-3504"></a>    <span class="n">P</span><span class="o">.</span><span class="n">rm_aug_line</span><span class="p">()</span>  <span class="c1"># Remove augmented line if exists</span>
</span><span id="__span-0-3505"><a id="__codelineno-0-3505" name="__codelineno-0-3505"></a>    <span class="k">return</span> <span class="n">PDP</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.is_orthogonally_diagonalizable" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_orthogonally_diagonalizable</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#ma1522.symbolic.Matrix.is_orthogonally_diagonalizable" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Determines whether the matrix is orthogonally diagonalizable.</p>
<p>A matrix is orthogonally diagonalizable if and only if it is symmetric.
This method checks the symmetry of the matrix and optionally displays
diagnostic information based on the verbosity level.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>2</code>
)
          –
          <div class="doc-md-description">
            <p>Level of diagnostic output.</p>
<ul>
<li>0: No output.</li>
<li>1: Displays the matrix.</li>
<li>2: Displays the result of the symmetry check.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p>True if the matrix is symmetric (orthogonally diagonalizable), False otherwise.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_orthogonally_diagonalizable</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">True</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>SymPy's <a class="autorefs autorefs-internal" title="            is_symmetric(simplify=True)" href="../inherited/#ma1522.symbolic.Matrix.is_symmetric"><code>Matrix.is_symmetric</code></a></li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3507">3507</a></span>
<span class="normal"><a href="#__codelineno-0-3508">3508</a></span>
<span class="normal"><a href="#__codelineno-0-3509">3509</a></span>
<span class="normal"><a href="#__codelineno-0-3510">3510</a></span>
<span class="normal"><a href="#__codelineno-0-3511">3511</a></span>
<span class="normal"><a href="#__codelineno-0-3512">3512</a></span>
<span class="normal"><a href="#__codelineno-0-3513">3513</a></span>
<span class="normal"><a href="#__codelineno-0-3514">3514</a></span>
<span class="normal"><a href="#__codelineno-0-3515">3515</a></span>
<span class="normal"><a href="#__codelineno-0-3516">3516</a></span>
<span class="normal"><a href="#__codelineno-0-3517">3517</a></span>
<span class="normal"><a href="#__codelineno-0-3518">3518</a></span>
<span class="normal"><a href="#__codelineno-0-3519">3519</a></span>
<span class="normal"><a href="#__codelineno-0-3520">3520</a></span>
<span class="normal"><a href="#__codelineno-0-3521">3521</a></span>
<span class="normal"><a href="#__codelineno-0-3522">3522</a></span>
<span class="normal"><a href="#__codelineno-0-3523">3523</a></span>
<span class="normal"><a href="#__codelineno-0-3524">3524</a></span>
<span class="normal"><a href="#__codelineno-0-3525">3525</a></span>
<span class="normal"><a href="#__codelineno-0-3526">3526</a></span>
<span class="normal"><a href="#__codelineno-0-3527">3527</a></span>
<span class="normal"><a href="#__codelineno-0-3528">3528</a></span>
<span class="normal"><a href="#__codelineno-0-3529">3529</a></span>
<span class="normal"><a href="#__codelineno-0-3530">3530</a></span>
<span class="normal"><a href="#__codelineno-0-3531">3531</a></span>
<span class="normal"><a href="#__codelineno-0-3532">3532</a></span>
<span class="normal"><a href="#__codelineno-0-3533">3533</a></span>
<span class="normal"><a href="#__codelineno-0-3534">3534</a></span>
<span class="normal"><a href="#__codelineno-0-3535">3535</a></span>
<span class="normal"><a href="#__codelineno-0-3536">3536</a></span>
<span class="normal"><a href="#__codelineno-0-3537">3537</a></span>
<span class="normal"><a href="#__codelineno-0-3538">3538</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3507"><a id="__codelineno-0-3507" name="__codelineno-0-3507"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_orthogonally_diagonalizable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-3508"><a id="__codelineno-0-3508" name="__codelineno-0-3508"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determines whether the matrix is orthogonally diagonalizable.</span>
</span><span id="__span-0-3509"><a id="__codelineno-0-3509" name="__codelineno-0-3509"></a>
</span><span id="__span-0-3510"><a id="__codelineno-0-3510" name="__codelineno-0-3510"></a><span class="sd">    A matrix is orthogonally diagonalizable if and only if it is symmetric.</span>
</span><span id="__span-0-3511"><a id="__codelineno-0-3511" name="__codelineno-0-3511"></a><span class="sd">    This method checks the symmetry of the matrix and optionally displays</span>
</span><span id="__span-0-3512"><a id="__codelineno-0-3512" name="__codelineno-0-3512"></a><span class="sd">    diagnostic information based on the verbosity level.</span>
</span><span id="__span-0-3513"><a id="__codelineno-0-3513" name="__codelineno-0-3513"></a>
</span><span id="__span-0-3514"><a id="__codelineno-0-3514" name="__codelineno-0-3514"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3515"><a id="__codelineno-0-3515" name="__codelineno-0-3515"></a><span class="sd">        verbosity (int, optional): Level of diagnostic output.</span>
</span><span id="__span-0-3516"><a id="__codelineno-0-3516" name="__codelineno-0-3516"></a>
</span><span id="__span-0-3517"><a id="__codelineno-0-3517" name="__codelineno-0-3517"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-3518"><a id="__codelineno-0-3518" name="__codelineno-0-3518"></a><span class="sd">            - 1: Displays the matrix.</span>
</span><span id="__span-0-3519"><a id="__codelineno-0-3519" name="__codelineno-0-3519"></a><span class="sd">            - 2: Displays the result of the symmetry check.</span>
</span><span id="__span-0-3520"><a id="__codelineno-0-3520" name="__codelineno-0-3520"></a>
</span><span id="__span-0-3521"><a id="__codelineno-0-3521" name="__codelineno-0-3521"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3522"><a id="__codelineno-0-3522" name="__codelineno-0-3522"></a><span class="sd">        (bool): True if the matrix is symmetric (orthogonally diagonalizable), False otherwise.</span>
</span><span id="__span-0-3523"><a id="__codelineno-0-3523" name="__codelineno-0-3523"></a>
</span><span id="__span-0-3524"><a id="__codelineno-0-3524" name="__codelineno-0-3524"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3525"><a id="__codelineno-0-3525" name="__codelineno-0-3525"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [2, 1]])</span>
</span><span id="__span-0-3526"><a id="__codelineno-0-3526" name="__codelineno-0-3526"></a><span class="sd">        &gt;&gt;&gt; mat.is_orthogonally_diagonalizable(verbosity=0)</span>
</span><span id="__span-0-3527"><a id="__codelineno-0-3527" name="__codelineno-0-3527"></a><span class="sd">        True</span>
</span><span id="__span-0-3528"><a id="__codelineno-0-3528" name="__codelineno-0-3528"></a>
</span><span id="__span-0-3529"><a id="__codelineno-0-3529" name="__codelineno-0-3529"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-3530"><a id="__codelineno-0-3530" name="__codelineno-0-3530"></a><span class="sd">        - SymPy&#39;s [`Matrix.is_symmetric`][sympy.matrices.matrixbase.MatrixBase.is_symmetric]</span>
</span><span id="__span-0-3531"><a id="__codelineno-0-3531" name="__codelineno-0-3531"></a>
</span><span id="__span-0-3532"><a id="__codelineno-0-3532" name="__codelineno-0-3532"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3533"><a id="__codelineno-0-3533" name="__codelineno-0-3533"></a>    <span class="k">if</span> <span class="n">verbosity</span><span class="p">:</span>
</span><span id="__span-0-3534"><a id="__codelineno-0-3534" name="__codelineno-0-3534"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Check if matrix is symmetric: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-3535"><a id="__codelineno-0-3535" name="__codelineno-0-3535"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-3536"><a id="__codelineno-0-3536" name="__codelineno-0-3536"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Check if self == self^T:&quot;</span><span class="p">)</span>
</span><span id="__span-0-3537"><a id="__codelineno-0-3537" name="__codelineno-0-3537"></a>        <span class="n">display</span><span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</span><span id="__span-0-3538"><a id="__codelineno-0-3538" name="__codelineno-0-3538"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.orthogonally_diagonalize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">orthogonally_diagonalize</span><span class="p">(</span><span class="n">reals_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">factor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDP</span></code>

<a href="#ma1522.symbolic.Matrix.orthogonally_diagonalize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Orthogonally diagonalizes the matrix, ensuring that eigenvectors corresponding to different eigenvalues are orthogonal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>reals_only</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, only real eigenvalues are considered.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>factor</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the eigenvectors are orthogonalized using the Gram-Schmidt process.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Controls the verbosity of output during the process.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>*args</code></b>
          –
          <div class="doc-md-description">
            <p>Additional positional arguments passed to the <a class="autorefs autorefs-internal" title="            diagonalize(reals_only: bool = True, verbosity: int = 0, *args, **kwargs) -> PDP" href="#ma1522.symbolic.Matrix.diagonalize"><code>diagonalize</code></a> method.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments passed to the <a class="autorefs autorefs-internal" title="            diagonalize(reals_only: bool = True, verbosity: int = 0, *args, **kwargs) -> PDP" href="#ma1522.symbolic.Matrix.diagonalize"><code>diagonalize</code></a> method.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              PDP(P: Matrix, D: Matrix)

  
      dataclass
   (ma1522.custom_types.PDP)" href="../custom_types/#ma1522.custom_types.PDP">PDP</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing:</p>
<ul>
<li><code>P</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The orthogonal matrix of eigenvectors.</li>
<li><code>D</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The diagonal matrix of eigenvalues.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            –
          <div class="doc-md-description">
            <p>If the matrix is not orthogonally diagonalizable (i.e., not symmetric).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span>
<span class="normal"><a href="#__codelineno-0-8">8</a></span>
<span class="normal"><a href="#__codelineno-0-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">orthogonally_diagonalize</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">PDP(P=Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[-sqrt(2)/2, sqrt(2)/2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[ sqrt(2)/2, sqrt(2)/2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">]), D=Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[-1, 0]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[ 0, 3]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            is_orthogonally_diagonalizable(verbosity: int = 2) -> bool" href="#ma1522.symbolic.Matrix.is_orthogonally_diagonalizable"><code>is_orthogonally_diagonalizable</code></a> to check if the matrix is orthogonally diagonalizable.</li>
<li><a class="autorefs autorefs-internal" title="            diagonalize(reals_only: bool = True, verbosity: int = 0, *args, **kwargs) -> PDP" href="#ma1522.symbolic.Matrix.diagonalize"><code>diagonalize</code></a> for diagonalizing the matrix.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3541">3541</a></span>
<span class="normal"><a href="#__codelineno-0-3542">3542</a></span>
<span class="normal"><a href="#__codelineno-0-3543">3543</a></span>
<span class="normal"><a href="#__codelineno-0-3544">3544</a></span>
<span class="normal"><a href="#__codelineno-0-3545">3545</a></span>
<span class="normal"><a href="#__codelineno-0-3546">3546</a></span>
<span class="normal"><a href="#__codelineno-0-3547">3547</a></span>
<span class="normal"><a href="#__codelineno-0-3548">3548</a></span>
<span class="normal"><a href="#__codelineno-0-3549">3549</a></span>
<span class="normal"><a href="#__codelineno-0-3550">3550</a></span>
<span class="normal"><a href="#__codelineno-0-3551">3551</a></span>
<span class="normal"><a href="#__codelineno-0-3552">3552</a></span>
<span class="normal"><a href="#__codelineno-0-3553">3553</a></span>
<span class="normal"><a href="#__codelineno-0-3554">3554</a></span>
<span class="normal"><a href="#__codelineno-0-3555">3555</a></span>
<span class="normal"><a href="#__codelineno-0-3556">3556</a></span>
<span class="normal"><a href="#__codelineno-0-3557">3557</a></span>
<span class="normal"><a href="#__codelineno-0-3558">3558</a></span>
<span class="normal"><a href="#__codelineno-0-3559">3559</a></span>
<span class="normal"><a href="#__codelineno-0-3560">3560</a></span>
<span class="normal"><a href="#__codelineno-0-3561">3561</a></span>
<span class="normal"><a href="#__codelineno-0-3562">3562</a></span>
<span class="normal"><a href="#__codelineno-0-3563">3563</a></span>
<span class="normal"><a href="#__codelineno-0-3564">3564</a></span>
<span class="normal"><a href="#__codelineno-0-3565">3565</a></span>
<span class="normal"><a href="#__codelineno-0-3566">3566</a></span>
<span class="normal"><a href="#__codelineno-0-3567">3567</a></span>
<span class="normal"><a href="#__codelineno-0-3568">3568</a></span>
<span class="normal"><a href="#__codelineno-0-3569">3569</a></span>
<span class="normal"><a href="#__codelineno-0-3570">3570</a></span>
<span class="normal"><a href="#__codelineno-0-3571">3571</a></span>
<span class="normal"><a href="#__codelineno-0-3572">3572</a></span>
<span class="normal"><a href="#__codelineno-0-3573">3573</a></span>
<span class="normal"><a href="#__codelineno-0-3574">3574</a></span>
<span class="normal"><a href="#__codelineno-0-3575">3575</a></span>
<span class="normal"><a href="#__codelineno-0-3576">3576</a></span>
<span class="normal"><a href="#__codelineno-0-3577">3577</a></span>
<span class="normal"><a href="#__codelineno-0-3578">3578</a></span>
<span class="normal"><a href="#__codelineno-0-3579">3579</a></span>
<span class="normal"><a href="#__codelineno-0-3580">3580</a></span>
<span class="normal"><a href="#__codelineno-0-3581">3581</a></span>
<span class="normal"><a href="#__codelineno-0-3582">3582</a></span>
<span class="normal"><a href="#__codelineno-0-3583">3583</a></span>
<span class="normal"><a href="#__codelineno-0-3584">3584</a></span>
<span class="normal"><a href="#__codelineno-0-3585">3585</a></span>
<span class="normal"><a href="#__codelineno-0-3586">3586</a></span>
<span class="normal"><a href="#__codelineno-0-3587">3587</a></span>
<span class="normal"><a href="#__codelineno-0-3588">3588</a></span>
<span class="normal"><a href="#__codelineno-0-3589">3589</a></span>
<span class="normal"><a href="#__codelineno-0-3590">3590</a></span>
<span class="normal"><a href="#__codelineno-0-3591">3591</a></span>
<span class="normal"><a href="#__codelineno-0-3592">3592</a></span>
<span class="normal"><a href="#__codelineno-0-3593">3593</a></span>
<span class="normal"><a href="#__codelineno-0-3594">3594</a></span>
<span class="normal"><a href="#__codelineno-0-3595">3595</a></span>
<span class="normal"><a href="#__codelineno-0-3596">3596</a></span>
<span class="normal"><a href="#__codelineno-0-3597">3597</a></span>
<span class="normal"><a href="#__codelineno-0-3598">3598</a></span>
<span class="normal"><a href="#__codelineno-0-3599">3599</a></span>
<span class="normal"><a href="#__codelineno-0-3600">3600</a></span>
<span class="normal"><a href="#__codelineno-0-3601">3601</a></span>
<span class="normal"><a href="#__codelineno-0-3602">3602</a></span>
<span class="normal"><a href="#__codelineno-0-3603">3603</a></span>
<span class="normal"><a href="#__codelineno-0-3604">3604</a></span>
<span class="normal"><a href="#__codelineno-0-3605">3605</a></span>
<span class="normal"><a href="#__codelineno-0-3606">3606</a></span>
<span class="normal"><a href="#__codelineno-0-3607">3607</a></span>
<span class="normal"><a href="#__codelineno-0-3608">3608</a></span>
<span class="normal"><a href="#__codelineno-0-3609">3609</a></span>
<span class="normal"><a href="#__codelineno-0-3610">3610</a></span>
<span class="normal"><a href="#__codelineno-0-3611">3611</a></span>
<span class="normal"><a href="#__codelineno-0-3612">3612</a></span>
<span class="normal"><a href="#__codelineno-0-3613">3613</a></span>
<span class="normal"><a href="#__codelineno-0-3614">3614</a></span>
<span class="normal"><a href="#__codelineno-0-3615">3615</a></span>
<span class="normal"><a href="#__codelineno-0-3616">3616</a></span>
<span class="normal"><a href="#__codelineno-0-3617">3617</a></span>
<span class="normal"><a href="#__codelineno-0-3618">3618</a></span>
<span class="normal"><a href="#__codelineno-0-3619">3619</a></span>
<span class="normal"><a href="#__codelineno-0-3620">3620</a></span>
<span class="normal"><a href="#__codelineno-0-3621">3621</a></span>
<span class="normal"><a href="#__codelineno-0-3622">3622</a></span>
<span class="normal"><a href="#__codelineno-0-3623">3623</a></span>
<span class="normal"><a href="#__codelineno-0-3624">3624</a></span>
<span class="normal"><a href="#__codelineno-0-3625">3625</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3541"><a id="__codelineno-0-3541" name="__codelineno-0-3541"></a><span class="k">def</span><span class="w"> </span><span class="nf">orthogonally_diagonalize</span><span class="p">(</span>
</span><span id="__span-0-3542"><a id="__codelineno-0-3542" name="__codelineno-0-3542"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">reals_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">factor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-3543"><a id="__codelineno-0-3543" name="__codelineno-0-3543"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDP</span><span class="p">:</span>
</span><span id="__span-0-3544"><a id="__codelineno-0-3544" name="__codelineno-0-3544"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Orthogonally diagonalizes the matrix, ensuring that eigenvectors corresponding to different eigenvalues are orthogonal.</span>
</span><span id="__span-0-3545"><a id="__codelineno-0-3545" name="__codelineno-0-3545"></a>
</span><span id="__span-0-3546"><a id="__codelineno-0-3546" name="__codelineno-0-3546"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3547"><a id="__codelineno-0-3547" name="__codelineno-0-3547"></a><span class="sd">        reals_only (bool): If True, only real eigenvalues are considered.</span>
</span><span id="__span-0-3548"><a id="__codelineno-0-3548" name="__codelineno-0-3548"></a><span class="sd">        factor (bool): If True, the eigenvectors are orthogonalized using the Gram-Schmidt process.</span>
</span><span id="__span-0-3549"><a id="__codelineno-0-3549" name="__codelineno-0-3549"></a><span class="sd">        verbosity (int): Controls the verbosity of output during the process.</span>
</span><span id="__span-0-3550"><a id="__codelineno-0-3550" name="__codelineno-0-3550"></a><span class="sd">        *args: Additional positional arguments passed to the [`diagonalize`][..] method.</span>
</span><span id="__span-0-3551"><a id="__codelineno-0-3551" name="__codelineno-0-3551"></a><span class="sd">        **kwargs: Additional arguments passed to the [`diagonalize`][..] method.</span>
</span><span id="__span-0-3552"><a id="__codelineno-0-3552" name="__codelineno-0-3552"></a>
</span><span id="__span-0-3553"><a id="__codelineno-0-3553" name="__codelineno-0-3553"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3554"><a id="__codelineno-0-3554" name="__codelineno-0-3554"></a><span class="sd">        (PDP): A dataclass containing:</span>
</span><span id="__span-0-3555"><a id="__codelineno-0-3555" name="__codelineno-0-3555"></a>
</span><span id="__span-0-3556"><a id="__codelineno-0-3556" name="__codelineno-0-3556"></a><span class="sd">            - `P` ([`Matrix`][...]): The orthogonal matrix of eigenvectors.</span>
</span><span id="__span-0-3557"><a id="__codelineno-0-3557" name="__codelineno-0-3557"></a><span class="sd">            - `D` ([`Matrix`][...]): The diagonal matrix of eigenvalues.</span>
</span><span id="__span-0-3558"><a id="__codelineno-0-3558" name="__codelineno-0-3558"></a>
</span><span id="__span-0-3559"><a id="__codelineno-0-3559" name="__codelineno-0-3559"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-3560"><a id="__codelineno-0-3560" name="__codelineno-0-3560"></a><span class="sd">        AssertionError: If the matrix is not orthogonally diagonalizable (i.e., not symmetric).</span>
</span><span id="__span-0-3561"><a id="__codelineno-0-3561" name="__codelineno-0-3561"></a>
</span><span id="__span-0-3562"><a id="__codelineno-0-3562" name="__codelineno-0-3562"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3563"><a id="__codelineno-0-3563" name="__codelineno-0-3563"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1, 2], [2, 1]])</span>
</span><span id="__span-0-3564"><a id="__codelineno-0-3564" name="__codelineno-0-3564"></a><span class="sd">        &gt;&gt;&gt; mat.orthogonally_diagonalize(factor=False, verbosity=0)</span>
</span><span id="__span-0-3565"><a id="__codelineno-0-3565" name="__codelineno-0-3565"></a><span class="sd">        PDP(P=Matrix([</span>
</span><span id="__span-0-3566"><a id="__codelineno-0-3566" name="__codelineno-0-3566"></a><span class="sd">        [-sqrt(2)/2, sqrt(2)/2]</span>
</span><span id="__span-0-3567"><a id="__codelineno-0-3567" name="__codelineno-0-3567"></a><span class="sd">        [ sqrt(2)/2, sqrt(2)/2]</span>
</span><span id="__span-0-3568"><a id="__codelineno-0-3568" name="__codelineno-0-3568"></a><span class="sd">        ]), D=Matrix([</span>
</span><span id="__span-0-3569"><a id="__codelineno-0-3569" name="__codelineno-0-3569"></a><span class="sd">        [-1, 0]</span>
</span><span id="__span-0-3570"><a id="__codelineno-0-3570" name="__codelineno-0-3570"></a><span class="sd">        [ 0, 3]</span>
</span><span id="__span-0-3571"><a id="__codelineno-0-3571" name="__codelineno-0-3571"></a><span class="sd">        ]))</span>
</span><span id="__span-0-3572"><a id="__codelineno-0-3572" name="__codelineno-0-3572"></a>
</span><span id="__span-0-3573"><a id="__codelineno-0-3573" name="__codelineno-0-3573"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-3574"><a id="__codelineno-0-3574" name="__codelineno-0-3574"></a><span class="sd">        - [`is_orthogonally_diagonalizable`][..] to check if the matrix is orthogonally diagonalizable.</span>
</span><span id="__span-0-3575"><a id="__codelineno-0-3575" name="__codelineno-0-3575"></a><span class="sd">        - [`diagonalize`][..] for diagonalizing the matrix.</span>
</span><span id="__span-0-3576"><a id="__codelineno-0-3576" name="__codelineno-0-3576"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3577"><a id="__codelineno-0-3577" name="__codelineno-0-3577"></a>
</span><span id="__span-0-3578"><a id="__codelineno-0-3578" name="__codelineno-0-3578"></a>    <span class="c1"># Changed default for reals_only to True to align with MA1522 syllabus</span>
</span><span id="__span-0-3579"><a id="__codelineno-0-3579" name="__codelineno-0-3579"></a>    <span class="c1"># Note that you can just apply GSP on P directly, since eigenspace associated to different eigenvalues are orthogonal</span>
</span><span id="__span-0-3580"><a id="__codelineno-0-3580" name="__codelineno-0-3580"></a>    <span class="c1"># However, we follow the steps given in MA1522 syllabus here</span>
</span><span id="__span-0-3581"><a id="__codelineno-0-3581" name="__codelineno-0-3581"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_orthogonally_diagonalizable</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</span><span id="__span-0-3582"><a id="__codelineno-0-3582" name="__codelineno-0-3582"></a>    <span class="c1"># P, D = super().diagonalize(reals_only, *args, **kwargs)</span>
</span><span id="__span-0-3583"><a id="__codelineno-0-3583" name="__codelineno-0-3583"></a>    <span class="n">P</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span>
</span><span id="__span-0-3584"><a id="__codelineno-0-3584" name="__codelineno-0-3584"></a>        <span class="n">reals_only</span><span class="o">=</span><span class="n">reals_only</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-3585"><a id="__codelineno-0-3585" name="__codelineno-0-3585"></a>    <span class="p">)</span>
</span><span id="__span-0-3586"><a id="__codelineno-0-3586" name="__codelineno-0-3586"></a>
</span><span id="__span-0-3587"><a id="__codelineno-0-3587" name="__codelineno-0-3587"></a>    <span class="n">d</span><span class="p">:</span> <span class="n">DefaultDict</span><span class="p">[</span><span class="n">Expr</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="__span-0-3588"><a id="__codelineno-0-3588" name="__codelineno-0-3588"></a>    <span class="k">for</span> <span class="n">vec</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">columnspace</span><span class="p">(),</span> <span class="n">D</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()):</span>
</span><span id="__span-0-3589"><a id="__codelineno-0-3589" name="__codelineno-0-3589"></a>        <span class="n">d</span><span class="p">[</span><span class="n">val</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</span><span id="__span-0-3590"><a id="__codelineno-0-3590" name="__codelineno-0-3590"></a>
</span><span id="__span-0-3591"><a id="__codelineno-0-3591" name="__codelineno-0-3591"></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-3592"><a id="__codelineno-0-3592" name="__codelineno-0-3592"></a>    <span class="k">for</span> <span class="n">val</span><span class="p">,</span> <span class="n">vecs</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-3593"><a id="__codelineno-0-3593" name="__codelineno-0-3593"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3594"><a id="__codelineno-0-3594" name="__codelineno-0-3594"></a>            <span class="c1"># Require Gram Schmidt to ensure eigenvectors are orthogonal</span>
</span><span id="__span-0-3595"><a id="__codelineno-0-3595" name="__codelineno-0-3595"></a>            <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3596"><a id="__codelineno-0-3596" name="__codelineno-0-3596"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eigenvalue: &quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span><span id="__span-0-3597"><a id="__codelineno-0-3597" name="__codelineno-0-3597"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Gram Schmidt Process]&quot;</span><span class="p">)</span>
</span><span id="__span-0-3598"><a id="__codelineno-0-3598" name="__codelineno-0-3598"></a>            <span class="k">if</span> <span class="n">factor</span><span class="p">:</span>
</span><span id="__span-0-3599"><a id="__codelineno-0-3599" name="__codelineno-0-3599"></a>                <span class="n">gram_result</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span>
</span><span id="__span-0-3600"><a id="__codelineno-0-3600" name="__codelineno-0-3600"></a>                    <span class="n">factor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span>
</span><span id="__span-0-3601"><a id="__codelineno-0-3601" name="__codelineno-0-3601"></a>                <span class="p">)</span>
</span><span id="__span-0-3602"><a id="__codelineno-0-3602" name="__codelineno-0-3602"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gram_result</span><span class="p">,</span> <span class="n">ScalarFactor</span><span class="p">):</span>
</span><span id="__span-0-3603"><a id="__codelineno-0-3603" name="__codelineno-0-3603"></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gram_result</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
</span><span id="__span-0-3604"><a id="__codelineno-0-3604" name="__codelineno-0-3604"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gram_result</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">):</span>
</span><span id="__span-0-3605"><a id="__codelineno-0-3605" name="__codelineno-0-3605"></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gram_result</span><span class="p">)</span>
</span><span id="__span-0-3606"><a id="__codelineno-0-3606" name="__codelineno-0-3606"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3607"><a id="__codelineno-0-3607" name="__codelineno-0-3607"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="__span-0-3608"><a id="__codelineno-0-3608" name="__codelineno-0-3608"></a>                        <span class="sa">f</span><span class="s2">&quot;Unexpected return type from gram_schmidt: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">gram_result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-3609"><a id="__codelineno-0-3609" name="__codelineno-0-3609"></a>                    <span class="p">)</span>
</span><span id="__span-0-3610"><a id="__codelineno-0-3610" name="__codelineno-0-3610"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3611"><a id="__codelineno-0-3611" name="__codelineno-0-3611"></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-0-3612"><a id="__codelineno-0-3612" name="__codelineno-0-3612"></a>                    <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">)</span>
</span><span id="__span-0-3613"><a id="__codelineno-0-3613" name="__codelineno-0-3613"></a>                <span class="p">)</span>
</span><span id="__span-0-3614"><a id="__codelineno-0-3614" name="__codelineno-0-3614"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3615"><a id="__codelineno-0-3615" name="__codelineno-0-3615"></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">normalized</span><span class="p">())</span>
</span><span id="__span-0-3616"><a id="__codelineno-0-3616" name="__codelineno-0-3616"></a>
</span><span id="__span-0-3617"><a id="__codelineno-0-3617" name="__codelineno-0-3617"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-3618"><a id="__codelineno-0-3618" name="__codelineno-0-3618"></a>        <span class="n">ortho_P</span> <span class="o">=</span> <span class="n">P</span>
</span><span id="__span-0-3619"><a id="__codelineno-0-3619" name="__codelineno-0-3619"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3620"><a id="__codelineno-0-3620" name="__codelineno-0-3620"></a>        <span class="n">ortho_P</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-3621"><a id="__codelineno-0-3621" name="__codelineno-0-3621"></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
</span><span id="__span-0-3622"><a id="__codelineno-0-3622" name="__codelineno-0-3622"></a>            <span class="n">ortho_P</span> <span class="o">=</span> <span class="n">ortho_P</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3623"><a id="__codelineno-0-3623" name="__codelineno-0-3623"></a>
</span><span id="__span-0-3624"><a id="__codelineno-0-3624" name="__codelineno-0-3624"></a>    <span class="k">assert</span> <span class="p">(</span><span class="n">ortho_P</span> <span class="o">@</span> <span class="n">D</span> <span class="o">@</span> <span class="n">ortho_P</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="__span-0-3625"><a id="__codelineno-0-3625" name="__codelineno-0-3625"></a>    <span class="k">return</span> <span class="n">PDP</span><span class="p">(</span><span class="n">ortho_P</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.is_stochastic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_stochastic</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#ma1522.symbolic.Matrix.is_stochastic" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if the matrix is stochastic.</p>
<p>A matrix is stochastic if all its entries are non-negative and each column sums to 1.
This property is commonly used to identify transition matrices in Markov chains.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Level of diagnostic output.</p>
<ul>
<li>0: No output.</li>
<li>1: Displays the result of the checks.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
          –
          <div class="doc-md-description">
            <p>True if the matrix is stochastic, False otherwise.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Convert floats to symbolic fractions</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_stochastic</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">True</span>
</span></code></pre></div></td></tr></table></div>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">is_stochastic</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">False</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3627">3627</a></span>
<span class="normal"><a href="#__codelineno-0-3628">3628</a></span>
<span class="normal"><a href="#__codelineno-0-3629">3629</a></span>
<span class="normal"><a href="#__codelineno-0-3630">3630</a></span>
<span class="normal"><a href="#__codelineno-0-3631">3631</a></span>
<span class="normal"><a href="#__codelineno-0-3632">3632</a></span>
<span class="normal"><a href="#__codelineno-0-3633">3633</a></span>
<span class="normal"><a href="#__codelineno-0-3634">3634</a></span>
<span class="normal"><a href="#__codelineno-0-3635">3635</a></span>
<span class="normal"><a href="#__codelineno-0-3636">3636</a></span>
<span class="normal"><a href="#__codelineno-0-3637">3637</a></span>
<span class="normal"><a href="#__codelineno-0-3638">3638</a></span>
<span class="normal"><a href="#__codelineno-0-3639">3639</a></span>
<span class="normal"><a href="#__codelineno-0-3640">3640</a></span>
<span class="normal"><a href="#__codelineno-0-3641">3641</a></span>
<span class="normal"><a href="#__codelineno-0-3642">3642</a></span>
<span class="normal"><a href="#__codelineno-0-3643">3643</a></span>
<span class="normal"><a href="#__codelineno-0-3644">3644</a></span>
<span class="normal"><a href="#__codelineno-0-3645">3645</a></span>
<span class="normal"><a href="#__codelineno-0-3646">3646</a></span>
<span class="normal"><a href="#__codelineno-0-3647">3647</a></span>
<span class="normal"><a href="#__codelineno-0-3648">3648</a></span>
<span class="normal"><a href="#__codelineno-0-3649">3649</a></span>
<span class="normal"><a href="#__codelineno-0-3650">3650</a></span>
<span class="normal"><a href="#__codelineno-0-3651">3651</a></span>
<span class="normal"><a href="#__codelineno-0-3652">3652</a></span>
<span class="normal"><a href="#__codelineno-0-3653">3653</a></span>
<span class="normal"><a href="#__codelineno-0-3654">3654</a></span>
<span class="normal"><a href="#__codelineno-0-3655">3655</a></span>
<span class="normal"><a href="#__codelineno-0-3656">3656</a></span>
<span class="normal"><a href="#__codelineno-0-3657">3657</a></span>
<span class="normal"><a href="#__codelineno-0-3658">3658</a></span>
<span class="normal"><a href="#__codelineno-0-3659">3659</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3627"><a id="__codelineno-0-3627" name="__codelineno-0-3627"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_stochastic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-3628"><a id="__codelineno-0-3628" name="__codelineno-0-3628"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the matrix is stochastic.</span>
</span><span id="__span-0-3629"><a id="__codelineno-0-3629" name="__codelineno-0-3629"></a>
</span><span id="__span-0-3630"><a id="__codelineno-0-3630" name="__codelineno-0-3630"></a><span class="sd">    A matrix is stochastic if all its entries are non-negative and each column sums to 1.</span>
</span><span id="__span-0-3631"><a id="__codelineno-0-3631" name="__codelineno-0-3631"></a><span class="sd">    This property is commonly used to identify transition matrices in Markov chains.</span>
</span><span id="__span-0-3632"><a id="__codelineno-0-3632" name="__codelineno-0-3632"></a>
</span><span id="__span-0-3633"><a id="__codelineno-0-3633" name="__codelineno-0-3633"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3634"><a id="__codelineno-0-3634" name="__codelineno-0-3634"></a><span class="sd">        verbosity (int, optional): Level of diagnostic output.</span>
</span><span id="__span-0-3635"><a id="__codelineno-0-3635" name="__codelineno-0-3635"></a>
</span><span id="__span-0-3636"><a id="__codelineno-0-3636" name="__codelineno-0-3636"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-3637"><a id="__codelineno-0-3637" name="__codelineno-0-3637"></a><span class="sd">            - 1: Displays the result of the checks.</span>
</span><span id="__span-0-3638"><a id="__codelineno-0-3638" name="__codelineno-0-3638"></a>
</span><span id="__span-0-3639"><a id="__codelineno-0-3639" name="__codelineno-0-3639"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3640"><a id="__codelineno-0-3640" name="__codelineno-0-3640"></a><span class="sd">        (bool): True if the matrix is stochastic, False otherwise.</span>
</span><span id="__span-0-3641"><a id="__codelineno-0-3641" name="__codelineno-0-3641"></a>
</span><span id="__span-0-3642"><a id="__codelineno-0-3642" name="__codelineno-0-3642"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3643"><a id="__codelineno-0-3643" name="__codelineno-0-3643"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[0.5, 0.1], [0.5, 0.9]])</span>
</span><span id="__span-0-3644"><a id="__codelineno-0-3644" name="__codelineno-0-3644"></a><span class="sd">        &gt;&gt;&gt; mat.simplify(rational=True) # Convert floats to symbolic fractions</span>
</span><span id="__span-0-3645"><a id="__codelineno-0-3645" name="__codelineno-0-3645"></a><span class="sd">        &gt;&gt;&gt; mat.is_stochastic(verbosity=0)</span>
</span><span id="__span-0-3646"><a id="__codelineno-0-3646" name="__codelineno-0-3646"></a><span class="sd">        True</span>
</span><span id="__span-0-3647"><a id="__codelineno-0-3647" name="__codelineno-0-3647"></a>
</span><span id="__span-0-3648"><a id="__codelineno-0-3648" name="__codelineno-0-3648"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[1.1, 1], [-0.1, 0]])</span>
</span><span id="__span-0-3649"><a id="__codelineno-0-3649" name="__codelineno-0-3649"></a><span class="sd">        &gt;&gt;&gt; mat.is_stochastic(verbosity=0)</span>
</span><span id="__span-0-3650"><a id="__codelineno-0-3650" name="__codelineno-0-3650"></a><span class="sd">        False</span>
</span><span id="__span-0-3651"><a id="__codelineno-0-3651" name="__codelineno-0-3651"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3652"><a id="__codelineno-0-3652" name="__codelineno-0-3652"></a>    <span class="n">is_square</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span>
</span><span id="__span-0-3653"><a id="__codelineno-0-3653" name="__codelineno-0-3653"></a>    <span class="n">is_non_negative</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">entry</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flat</span><span class="p">())</span>
</span><span id="__span-0-3654"><a id="__codelineno-0-3654" name="__codelineno-0-3654"></a>    <span class="n">is_prob_vectors</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-3655"><a id="__codelineno-0-3655" name="__codelineno-0-3655"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3656"><a id="__codelineno-0-3656" name="__codelineno-0-3656"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Check if matrix is square: </span><span class="si">{</span><span class="n">is_square</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-3657"><a id="__codelineno-0-3657" name="__codelineno-0-3657"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Check if all entries are non-negative: </span><span class="si">{</span><span class="n">is_non_negative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-3658"><a id="__codelineno-0-3658" name="__codelineno-0-3658"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Check if each column sums to 1: </span><span class="si">{</span><span class="n">is_prob_vectors</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-3659"><a id="__codelineno-0-3659" name="__codelineno-0-3659"></a>    <span class="k">return</span> <span class="n">is_square</span> <span class="ow">and</span> <span class="n">is_non_negative</span> <span class="ow">and</span> <span class="n">is_prob_vectors</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.equilibrium_vectors" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">equilibrium_vectors</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Matrix</span></code>

<a href="#ma1522.symbolic.Matrix.equilibrium_vectors" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the equilibrium vectors of the matrix, i.e., the nullspace of (I - A).</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>A matrix <code>P</code> has a unique equilibrium vector if it is stochastic and
    there exists some positive integer <code>k</code> such that <code>P^k</code> only has positive entries.</li>
</ul>
</details>

<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>
          –
          <div class="doc-md-description">
            <p>A matrix containing equilibrium vectors normalized so that their
column sums to 1.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">equilibrium_vectors</span><span class="p">()</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[1/2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[1/2]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">])</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3661">3661</a></span>
<span class="normal"><a href="#__codelineno-0-3662">3662</a></span>
<span class="normal"><a href="#__codelineno-0-3663">3663</a></span>
<span class="normal"><a href="#__codelineno-0-3664">3664</a></span>
<span class="normal"><a href="#__codelineno-0-3665">3665</a></span>
<span class="normal"><a href="#__codelineno-0-3666">3666</a></span>
<span class="normal"><a href="#__codelineno-0-3667">3667</a></span>
<span class="normal"><a href="#__codelineno-0-3668">3668</a></span>
<span class="normal"><a href="#__codelineno-0-3669">3669</a></span>
<span class="normal"><a href="#__codelineno-0-3670">3670</a></span>
<span class="normal"><a href="#__codelineno-0-3671">3671</a></span>
<span class="normal"><a href="#__codelineno-0-3672">3672</a></span>
<span class="normal"><a href="#__codelineno-0-3673">3673</a></span>
<span class="normal"><a href="#__codelineno-0-3674">3674</a></span>
<span class="normal"><a href="#__codelineno-0-3675">3675</a></span>
<span class="normal"><a href="#__codelineno-0-3676">3676</a></span>
<span class="normal"><a href="#__codelineno-0-3677">3677</a></span>
<span class="normal"><a href="#__codelineno-0-3678">3678</a></span>
<span class="normal"><a href="#__codelineno-0-3679">3679</a></span>
<span class="normal"><a href="#__codelineno-0-3680">3680</a></span>
<span class="normal"><a href="#__codelineno-0-3681">3681</a></span>
<span class="normal"><a href="#__codelineno-0-3682">3682</a></span>
<span class="normal"><a href="#__codelineno-0-3683">3683</a></span>
<span class="normal"><a href="#__codelineno-0-3684">3684</a></span>
<span class="normal"><a href="#__codelineno-0-3685">3685</a></span>
<span class="normal"><a href="#__codelineno-0-3686">3686</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3661"><a id="__codelineno-0-3661" name="__codelineno-0-3661"></a><span class="k">def</span><span class="w"> </span><span class="nf">equilibrium_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
</span><span id="__span-0-3662"><a id="__codelineno-0-3662" name="__codelineno-0-3662"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the equilibrium vectors of the matrix, i.e., the nullspace of (I - A).</span>
</span><span id="__span-0-3663"><a id="__codelineno-0-3663" name="__codelineno-0-3663"></a>
</span><span id="__span-0-3664"><a id="__codelineno-0-3664" name="__codelineno-0-3664"></a><span class="sd">    Note:</span>
</span><span id="__span-0-3665"><a id="__codelineno-0-3665" name="__codelineno-0-3665"></a><span class="sd">        - A matrix `P` has a unique equilibrium vector if it is stochastic and</span>
</span><span id="__span-0-3666"><a id="__codelineno-0-3666" name="__codelineno-0-3666"></a><span class="sd">            there exists some positive integer `k` such that `P^k` only has positive entries.</span>
</span><span id="__span-0-3667"><a id="__codelineno-0-3667" name="__codelineno-0-3667"></a>
</span><span id="__span-0-3668"><a id="__codelineno-0-3668" name="__codelineno-0-3668"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3669"><a id="__codelineno-0-3669" name="__codelineno-0-3669"></a><span class="sd">        (Matrix): A matrix containing equilibrium vectors normalized so that their</span>
</span><span id="__span-0-3670"><a id="__codelineno-0-3670" name="__codelineno-0-3670"></a><span class="sd">            column sums to 1.</span>
</span><span id="__span-0-3671"><a id="__codelineno-0-3671" name="__codelineno-0-3671"></a>
</span><span id="__span-0-3672"><a id="__codelineno-0-3672" name="__codelineno-0-3672"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3673"><a id="__codelineno-0-3673" name="__codelineno-0-3673"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[0.1, 0.9], [0.9, 0.1]])</span>
</span><span id="__span-0-3674"><a id="__codelineno-0-3674" name="__codelineno-0-3674"></a><span class="sd">        &gt;&gt;&gt; mat.simplify()</span>
</span><span id="__span-0-3675"><a id="__codelineno-0-3675" name="__codelineno-0-3675"></a><span class="sd">        &gt;&gt;&gt; mat.equilibrium_vectors()</span>
</span><span id="__span-0-3676"><a id="__codelineno-0-3676" name="__codelineno-0-3676"></a><span class="sd">        Matrix([</span>
</span><span id="__span-0-3677"><a id="__codelineno-0-3677" name="__codelineno-0-3677"></a><span class="sd">        [1/2]</span>
</span><span id="__span-0-3678"><a id="__codelineno-0-3678" name="__codelineno-0-3678"></a><span class="sd">        [1/2]</span>
</span><span id="__span-0-3679"><a id="__codelineno-0-3679" name="__codelineno-0-3679"></a><span class="sd">        ])</span>
</span><span id="__span-0-3680"><a id="__codelineno-0-3680" name="__codelineno-0-3680"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3681"><a id="__codelineno-0-3681" name="__codelineno-0-3681"></a>
</span><span id="__span-0-3682"><a id="__codelineno-0-3682" name="__codelineno-0-3682"></a>    <span class="n">P</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">elem</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">nullspace</span><span class="p">())</span>
</span><span id="__span-0-3683"><a id="__codelineno-0-3683" name="__codelineno-0-3683"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
</span><span id="__span-0-3684"><a id="__codelineno-0-3684" name="__codelineno-0-3684"></a>        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">P</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-3685"><a id="__codelineno-0-3685" name="__codelineno-0-3685"></a>            <span class="n">P</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">P</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-3686"><a id="__codelineno-0-3686" name="__codelineno-0-3686"></a>    <span class="k">return</span> <span class="n">P</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.singular_value_decomposition" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">singular_value_decomposition</span><span class="p">(</span><span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SVD</span></code>

<a href="#ma1522.symbolic.Matrix.singular_value_decomposition" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Performs Singular Value Decomposition (SVD) on the matrix, following the MA1522 syllabus.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>This function is known to take too much time and may kill Jupyter's kernel. Please use it with caution.
    A workaround is to set <code>verify=False</code> to skip the verification step, or use the faster numerical SVD
    method <a class="autorefs autorefs-internal" title="            fast_svd(option: Literal['np', 'sym'] = 'np', identify: bool = True, tol: float | None = None) -> SVD | NumSVD" href="#ma1522.symbolic.Matrix.fast_svd"><code>fast_svd</code></a> instead.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>verbosity</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Controls the verbosity of the output.</p>
<ul>
<li>0: No output.</li>
<li>1: Displays intermediate steps and results of the SVD process.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tol</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>Tolerance for verification of the SVD result.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verify</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If <code>True</code>, verifies the result of the SVD by checking if <code>self = U @ S @ V.T</code>.
If <code>False</code>, skips the verification step for performance reasons.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              SVD(U: Matrix, S: Matrix, V: Matrix)

  
      dataclass
   (ma1522.custom_types.SVD)" href="../custom_types/#ma1522.custom_types.SVD">SVD</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing:</p>
<ul>
<li><code>U</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The left singular vectors.</li>
<li><code>S</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The diagonal matrix of singular values.</li>
<li><code>V</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The right singular vectors.</li>
</ul>
<p>Such that <code>self = U @ S @ V.T</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">singular_value_decomposition</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">SVD(U=Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[sqrt(2)/2, -sqrt(2)/2]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[sqrt(2)/2,  sqrt(2)/2]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">]), S=Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[5, 0, 0]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[0, 3, 0]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">]), V=Matrix([</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="go">[sqrt(2)/2,   -sqrt(2)/6,  2/3]</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="go">[sqrt(2)/2,    sqrt(2)/6, -2/3]</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="go">[        0, -2*sqrt(2)/3, -1/3]</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            fast_svd(option: Literal['np', 'sym'] = 'np', identify: bool = True, tol: float | None = None) -> SVD | NumSVD" href="#ma1522.symbolic.Matrix.fast_svd"><code>fast_svd</code></a> for a faster numerical SVD</li>
<li>SymPy's <a class="autorefs autorefs-external" href="https://docs.sympy.org/latest/modules/matrices/matrices.html#sympy.matrices.matrixbase.MatrixBase.singular_value_decomposition"><code>Matrix.singular_value_decomposition</code></a></li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3688">3688</a></span>
<span class="normal"><a href="#__codelineno-0-3689">3689</a></span>
<span class="normal"><a href="#__codelineno-0-3690">3690</a></span>
<span class="normal"><a href="#__codelineno-0-3691">3691</a></span>
<span class="normal"><a href="#__codelineno-0-3692">3692</a></span>
<span class="normal"><a href="#__codelineno-0-3693">3693</a></span>
<span class="normal"><a href="#__codelineno-0-3694">3694</a></span>
<span class="normal"><a href="#__codelineno-0-3695">3695</a></span>
<span class="normal"><a href="#__codelineno-0-3696">3696</a></span>
<span class="normal"><a href="#__codelineno-0-3697">3697</a></span>
<span class="normal"><a href="#__codelineno-0-3698">3698</a></span>
<span class="normal"><a href="#__codelineno-0-3699">3699</a></span>
<span class="normal"><a href="#__codelineno-0-3700">3700</a></span>
<span class="normal"><a href="#__codelineno-0-3701">3701</a></span>
<span class="normal"><a href="#__codelineno-0-3702">3702</a></span>
<span class="normal"><a href="#__codelineno-0-3703">3703</a></span>
<span class="normal"><a href="#__codelineno-0-3704">3704</a></span>
<span class="normal"><a href="#__codelineno-0-3705">3705</a></span>
<span class="normal"><a href="#__codelineno-0-3706">3706</a></span>
<span class="normal"><a href="#__codelineno-0-3707">3707</a></span>
<span class="normal"><a href="#__codelineno-0-3708">3708</a></span>
<span class="normal"><a href="#__codelineno-0-3709">3709</a></span>
<span class="normal"><a href="#__codelineno-0-3710">3710</a></span>
<span class="normal"><a href="#__codelineno-0-3711">3711</a></span>
<span class="normal"><a href="#__codelineno-0-3712">3712</a></span>
<span class="normal"><a href="#__codelineno-0-3713">3713</a></span>
<span class="normal"><a href="#__codelineno-0-3714">3714</a></span>
<span class="normal"><a href="#__codelineno-0-3715">3715</a></span>
<span class="normal"><a href="#__codelineno-0-3716">3716</a></span>
<span class="normal"><a href="#__codelineno-0-3717">3717</a></span>
<span class="normal"><a href="#__codelineno-0-3718">3718</a></span>
<span class="normal"><a href="#__codelineno-0-3719">3719</a></span>
<span class="normal"><a href="#__codelineno-0-3720">3720</a></span>
<span class="normal"><a href="#__codelineno-0-3721">3721</a></span>
<span class="normal"><a href="#__codelineno-0-3722">3722</a></span>
<span class="normal"><a href="#__codelineno-0-3723">3723</a></span>
<span class="normal"><a href="#__codelineno-0-3724">3724</a></span>
<span class="normal"><a href="#__codelineno-0-3725">3725</a></span>
<span class="normal"><a href="#__codelineno-0-3726">3726</a></span>
<span class="normal"><a href="#__codelineno-0-3727">3727</a></span>
<span class="normal"><a href="#__codelineno-0-3728">3728</a></span>
<span class="normal"><a href="#__codelineno-0-3729">3729</a></span>
<span class="normal"><a href="#__codelineno-0-3730">3730</a></span>
<span class="normal"><a href="#__codelineno-0-3731">3731</a></span>
<span class="normal"><a href="#__codelineno-0-3732">3732</a></span>
<span class="normal"><a href="#__codelineno-0-3733">3733</a></span>
<span class="normal"><a href="#__codelineno-0-3734">3734</a></span>
<span class="normal"><a href="#__codelineno-0-3735">3735</a></span>
<span class="normal"><a href="#__codelineno-0-3736">3736</a></span>
<span class="normal"><a href="#__codelineno-0-3737">3737</a></span>
<span class="normal"><a href="#__codelineno-0-3738">3738</a></span>
<span class="normal"><a href="#__codelineno-0-3739">3739</a></span>
<span class="normal"><a href="#__codelineno-0-3740">3740</a></span>
<span class="normal"><a href="#__codelineno-0-3741">3741</a></span>
<span class="normal"><a href="#__codelineno-0-3742">3742</a></span>
<span class="normal"><a href="#__codelineno-0-3743">3743</a></span>
<span class="normal"><a href="#__codelineno-0-3744">3744</a></span>
<span class="normal"><a href="#__codelineno-0-3745">3745</a></span>
<span class="normal"><a href="#__codelineno-0-3746">3746</a></span>
<span class="normal"><a href="#__codelineno-0-3747">3747</a></span>
<span class="normal"><a href="#__codelineno-0-3748">3748</a></span>
<span class="normal"><a href="#__codelineno-0-3749">3749</a></span>
<span class="normal"><a href="#__codelineno-0-3750">3750</a></span>
<span class="normal"><a href="#__codelineno-0-3751">3751</a></span>
<span class="normal"><a href="#__codelineno-0-3752">3752</a></span>
<span class="normal"><a href="#__codelineno-0-3753">3753</a></span>
<span class="normal"><a href="#__codelineno-0-3754">3754</a></span>
<span class="normal"><a href="#__codelineno-0-3755">3755</a></span>
<span class="normal"><a href="#__codelineno-0-3756">3756</a></span>
<span class="normal"><a href="#__codelineno-0-3757">3757</a></span>
<span class="normal"><a href="#__codelineno-0-3758">3758</a></span>
<span class="normal"><a href="#__codelineno-0-3759">3759</a></span>
<span class="normal"><a href="#__codelineno-0-3760">3760</a></span>
<span class="normal"><a href="#__codelineno-0-3761">3761</a></span>
<span class="normal"><a href="#__codelineno-0-3762">3762</a></span>
<span class="normal"><a href="#__codelineno-0-3763">3763</a></span>
<span class="normal"><a href="#__codelineno-0-3764">3764</a></span>
<span class="normal"><a href="#__codelineno-0-3765">3765</a></span>
<span class="normal"><a href="#__codelineno-0-3766">3766</a></span>
<span class="normal"><a href="#__codelineno-0-3767">3767</a></span>
<span class="normal"><a href="#__codelineno-0-3768">3768</a></span>
<span class="normal"><a href="#__codelineno-0-3769">3769</a></span>
<span class="normal"><a href="#__codelineno-0-3770">3770</a></span>
<span class="normal"><a href="#__codelineno-0-3771">3771</a></span>
<span class="normal"><a href="#__codelineno-0-3772">3772</a></span>
<span class="normal"><a href="#__codelineno-0-3773">3773</a></span>
<span class="normal"><a href="#__codelineno-0-3774">3774</a></span>
<span class="normal"><a href="#__codelineno-0-3775">3775</a></span>
<span class="normal"><a href="#__codelineno-0-3776">3776</a></span>
<span class="normal"><a href="#__codelineno-0-3777">3777</a></span>
<span class="normal"><a href="#__codelineno-0-3778">3778</a></span>
<span class="normal"><a href="#__codelineno-0-3779">3779</a></span>
<span class="normal"><a href="#__codelineno-0-3780">3780</a></span>
<span class="normal"><a href="#__codelineno-0-3781">3781</a></span>
<span class="normal"><a href="#__codelineno-0-3782">3782</a></span>
<span class="normal"><a href="#__codelineno-0-3783">3783</a></span>
<span class="normal"><a href="#__codelineno-0-3784">3784</a></span>
<span class="normal"><a href="#__codelineno-0-3785">3785</a></span>
<span class="normal"><a href="#__codelineno-0-3786">3786</a></span>
<span class="normal"><a href="#__codelineno-0-3787">3787</a></span>
<span class="normal"><a href="#__codelineno-0-3788">3788</a></span>
<span class="normal"><a href="#__codelineno-0-3789">3789</a></span>
<span class="normal"><a href="#__codelineno-0-3790">3790</a></span>
<span class="normal"><a href="#__codelineno-0-3791">3791</a></span>
<span class="normal"><a href="#__codelineno-0-3792">3792</a></span>
<span class="normal"><a href="#__codelineno-0-3793">3793</a></span>
<span class="normal"><a href="#__codelineno-0-3794">3794</a></span>
<span class="normal"><a href="#__codelineno-0-3795">3795</a></span>
<span class="normal"><a href="#__codelineno-0-3796">3796</a></span>
<span class="normal"><a href="#__codelineno-0-3797">3797</a></span>
<span class="normal"><a href="#__codelineno-0-3798">3798</a></span>
<span class="normal"><a href="#__codelineno-0-3799">3799</a></span>
<span class="normal"><a href="#__codelineno-0-3800">3800</a></span>
<span class="normal"><a href="#__codelineno-0-3801">3801</a></span>
<span class="normal"><a href="#__codelineno-0-3802">3802</a></span>
<span class="normal"><a href="#__codelineno-0-3803">3803</a></span>
<span class="normal"><a href="#__codelineno-0-3804">3804</a></span>
<span class="normal"><a href="#__codelineno-0-3805">3805</a></span>
<span class="normal"><a href="#__codelineno-0-3806">3806</a></span>
<span class="normal"><a href="#__codelineno-0-3807">3807</a></span>
<span class="normal"><a href="#__codelineno-0-3808">3808</a></span>
<span class="normal"><a href="#__codelineno-0-3809">3809</a></span>
<span class="normal"><a href="#__codelineno-0-3810">3810</a></span>
<span class="normal"><a href="#__codelineno-0-3811">3811</a></span>
<span class="normal"><a href="#__codelineno-0-3812">3812</a></span>
<span class="normal"><a href="#__codelineno-0-3813">3813</a></span>
<span class="normal"><a href="#__codelineno-0-3814">3814</a></span>
<span class="normal"><a href="#__codelineno-0-3815">3815</a></span>
<span class="normal"><a href="#__codelineno-0-3816">3816</a></span>
<span class="normal"><a href="#__codelineno-0-3817">3817</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3688"><a id="__codelineno-0-3688" name="__codelineno-0-3688"></a><span class="k">def</span><span class="w"> </span><span class="nf">singular_value_decomposition</span><span class="p">(</span>
</span><span id="__span-0-3689"><a id="__codelineno-0-3689" name="__codelineno-0-3689"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-3690"><a id="__codelineno-0-3690" name="__codelineno-0-3690"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SVD</span><span class="p">:</span>
</span><span id="__span-0-3691"><a id="__codelineno-0-3691" name="__codelineno-0-3691"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs Singular Value Decomposition (SVD) on the matrix, following the MA1522 syllabus.</span>
</span><span id="__span-0-3692"><a id="__codelineno-0-3692" name="__codelineno-0-3692"></a>
</span><span id="__span-0-3693"><a id="__codelineno-0-3693" name="__codelineno-0-3693"></a><span class="sd">    Note:</span>
</span><span id="__span-0-3694"><a id="__codelineno-0-3694" name="__codelineno-0-3694"></a><span class="sd">        - This function is known to take too much time and may kill Jupyter&#39;s kernel. Please use it with caution.</span>
</span><span id="__span-0-3695"><a id="__codelineno-0-3695" name="__codelineno-0-3695"></a><span class="sd">            A workaround is to set `verify=False` to skip the verification step, or use the faster numerical SVD</span>
</span><span id="__span-0-3696"><a id="__codelineno-0-3696" name="__codelineno-0-3696"></a><span class="sd">            method [`fast_svd`][..fast_svd] instead.</span>
</span><span id="__span-0-3697"><a id="__codelineno-0-3697" name="__codelineno-0-3697"></a>
</span><span id="__span-0-3698"><a id="__codelineno-0-3698" name="__codelineno-0-3698"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3699"><a id="__codelineno-0-3699" name="__codelineno-0-3699"></a><span class="sd">        verbosity (int, optional): Controls the verbosity of the output.</span>
</span><span id="__span-0-3700"><a id="__codelineno-0-3700" name="__codelineno-0-3700"></a>
</span><span id="__span-0-3701"><a id="__codelineno-0-3701" name="__codelineno-0-3701"></a><span class="sd">            - 0: No output.</span>
</span><span id="__span-0-3702"><a id="__codelineno-0-3702" name="__codelineno-0-3702"></a><span class="sd">            - 1: Displays intermediate steps and results of the SVD process.</span>
</span><span id="__span-0-3703"><a id="__codelineno-0-3703" name="__codelineno-0-3703"></a><span class="sd">        tol (float, optional): Tolerance for verification of the SVD result.</span>
</span><span id="__span-0-3704"><a id="__codelineno-0-3704" name="__codelineno-0-3704"></a><span class="sd">        verify (bool): If `True`, verifies the result of the SVD by checking if `self = U @ S @ V.T`.</span>
</span><span id="__span-0-3705"><a id="__codelineno-0-3705" name="__codelineno-0-3705"></a><span class="sd">            If `False`, skips the verification step for performance reasons.</span>
</span><span id="__span-0-3706"><a id="__codelineno-0-3706" name="__codelineno-0-3706"></a>
</span><span id="__span-0-3707"><a id="__codelineno-0-3707" name="__codelineno-0-3707"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3708"><a id="__codelineno-0-3708" name="__codelineno-0-3708"></a><span class="sd">        (SVD): A dataclass containing:</span>
</span><span id="__span-0-3709"><a id="__codelineno-0-3709" name="__codelineno-0-3709"></a>
</span><span id="__span-0-3710"><a id="__codelineno-0-3710" name="__codelineno-0-3710"></a><span class="sd">            - `U` ([`Matrix`][...]): The left singular vectors.</span>
</span><span id="__span-0-3711"><a id="__codelineno-0-3711" name="__codelineno-0-3711"></a><span class="sd">            - `S` ([`Matrix`][...]): The diagonal matrix of singular values.</span>
</span><span id="__span-0-3712"><a id="__codelineno-0-3712" name="__codelineno-0-3712"></a><span class="sd">            - `V` ([`Matrix`][...]): The right singular vectors.</span>
</span><span id="__span-0-3713"><a id="__codelineno-0-3713" name="__codelineno-0-3713"></a>
</span><span id="__span-0-3714"><a id="__codelineno-0-3714" name="__codelineno-0-3714"></a><span class="sd">            Such that `self = U @ S @ V.T`.</span>
</span><span id="__span-0-3715"><a id="__codelineno-0-3715" name="__codelineno-0-3715"></a>
</span><span id="__span-0-3716"><a id="__codelineno-0-3716" name="__codelineno-0-3716"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3717"><a id="__codelineno-0-3717" name="__codelineno-0-3717"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[3, 2, 2], [2, 3, -2]])</span>
</span><span id="__span-0-3718"><a id="__codelineno-0-3718" name="__codelineno-0-3718"></a><span class="sd">        &gt;&gt;&gt; mat.singular_value_decomposition(verbosity=0, verify=False)</span>
</span><span id="__span-0-3719"><a id="__codelineno-0-3719" name="__codelineno-0-3719"></a><span class="sd">        SVD(U=Matrix([</span>
</span><span id="__span-0-3720"><a id="__codelineno-0-3720" name="__codelineno-0-3720"></a><span class="sd">        [sqrt(2)/2, -sqrt(2)/2]</span>
</span><span id="__span-0-3721"><a id="__codelineno-0-3721" name="__codelineno-0-3721"></a><span class="sd">        [sqrt(2)/2,  sqrt(2)/2]</span>
</span><span id="__span-0-3722"><a id="__codelineno-0-3722" name="__codelineno-0-3722"></a><span class="sd">        ]), S=Matrix([</span>
</span><span id="__span-0-3723"><a id="__codelineno-0-3723" name="__codelineno-0-3723"></a><span class="sd">        [5, 0, 0]</span>
</span><span id="__span-0-3724"><a id="__codelineno-0-3724" name="__codelineno-0-3724"></a><span class="sd">        [0, 3, 0]</span>
</span><span id="__span-0-3725"><a id="__codelineno-0-3725" name="__codelineno-0-3725"></a><span class="sd">        ]), V=Matrix([</span>
</span><span id="__span-0-3726"><a id="__codelineno-0-3726" name="__codelineno-0-3726"></a><span class="sd">        [sqrt(2)/2,   -sqrt(2)/6,  2/3]</span>
</span><span id="__span-0-3727"><a id="__codelineno-0-3727" name="__codelineno-0-3727"></a><span class="sd">        [sqrt(2)/2,    sqrt(2)/6, -2/3]</span>
</span><span id="__span-0-3728"><a id="__codelineno-0-3728" name="__codelineno-0-3728"></a><span class="sd">        [        0, -2*sqrt(2)/3, -1/3]</span>
</span><span id="__span-0-3729"><a id="__codelineno-0-3729" name="__codelineno-0-3729"></a><span class="sd">        ]))</span>
</span><span id="__span-0-3730"><a id="__codelineno-0-3730" name="__codelineno-0-3730"></a>
</span><span id="__span-0-3731"><a id="__codelineno-0-3731" name="__codelineno-0-3731"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-3732"><a id="__codelineno-0-3732" name="__codelineno-0-3732"></a><span class="sd">        - [`fast_svd`][..fast_svd] for a faster numerical SVD</span>
</span><span id="__span-0-3733"><a id="__codelineno-0-3733" name="__codelineno-0-3733"></a><span class="sd">        - SymPy&#39;s [`Matrix.singular_value_decomposition`][sympy.matrices.matrixbase.MatrixBase.singular_value_decomposition]</span>
</span><span id="__span-0-3734"><a id="__codelineno-0-3734" name="__codelineno-0-3734"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3735"><a id="__codelineno-0-3735" name="__codelineno-0-3735"></a>
</span><span id="__span-0-3736"><a id="__codelineno-0-3736" name="__codelineno-0-3736"></a>    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3737"><a id="__codelineno-0-3737" name="__codelineno-0-3737"></a>        <span class="n">AT_A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span>
</span><span id="__span-0-3738"><a id="__codelineno-0-3738" name="__codelineno-0-3738"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A^T A&quot;</span><span class="p">)</span>
</span><span id="__span-0-3739"><a id="__codelineno-0-3739" name="__codelineno-0-3739"></a>        <span class="n">display</span><span class="p">(</span><span class="n">AT_A</span><span class="p">)</span>
</span><span id="__span-0-3740"><a id="__codelineno-0-3740" name="__codelineno-0-3740"></a>        <span class="n">P</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">AT_A</span><span class="o">.</span><span class="n">orthogonally_diagonalize</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</span><span id="__span-0-3741"><a id="__codelineno-0-3741" name="__codelineno-0-3741"></a>        <span class="c1"># Reverse index such that singular values are in decreasing order</span>
</span><span id="__span-0-3742"><a id="__codelineno-0-3742" name="__codelineno-0-3742"></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-3743"><a id="__codelineno-0-3743" name="__codelineno-0-3743"></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">singular</span> <span class="k">for</span> <span class="n">singular</span> <span class="ow">in</span> <span class="n">sigma</span> <span class="k">if</span> <span class="p">(</span><span class="n">singular</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)])</span>
</span><span id="__span-0-3744"><a id="__codelineno-0-3744" name="__codelineno-0-3744"></a>        <span class="n">V</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">cols</span><span class="p">)][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-0-3745"><a id="__codelineno-0-3745" name="__codelineno-0-3745"></a>
</span><span id="__span-0-3746"><a id="__codelineno-0-3746" name="__codelineno-0-3746"></a>        <span class="n">u_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-3747"><a id="__codelineno-0-3747" name="__codelineno-0-3747"></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">V</span><span class="o">.</span><span class="n">columnspace</span><span class="p">(),</span> <span class="n">sigma</span><span class="p">):</span>
</span><span id="__span-0-3748"><a id="__codelineno-0-3748" name="__codelineno-0-3748"></a>            <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-3749"><a id="__codelineno-0-3749" name="__codelineno-0-3749"></a>                <span class="n">u_i</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">@</span> <span class="n">vec</span> <span class="o">/</span> <span class="n">val</span>
</span><span id="__span-0-3750"><a id="__codelineno-0-3750" name="__codelineno-0-3750"></a>                <span class="n">u_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_i</span><span class="p">)</span>
</span><span id="__span-0-3751"><a id="__codelineno-0-3751" name="__codelineno-0-3751"></a>                <span class="n">display</span><span class="p">(</span>
</span><span id="__span-0-3752"><a id="__codelineno-0-3752" name="__codelineno-0-3752"></a>                    <span class="sa">f</span><span class="s2">&quot;u_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> = (1/</span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">)A</span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">u_i</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3753"><a id="__codelineno-0-3753" name="__codelineno-0-3753"></a>                    <span class="n">opt</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">,</span>
</span><span id="__span-0-3754"><a id="__codelineno-0-3754" name="__codelineno-0-3754"></a>                <span class="p">)</span>
</span><span id="__span-0-3755"><a id="__codelineno-0-3755" name="__codelineno-0-3755"></a>
</span><span id="__span-0-3756"><a id="__codelineno-0-3756" name="__codelineno-0-3756"></a>        <span class="n">U</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">u_list</span><span class="p">)</span>
</span><span id="__span-0-3757"><a id="__codelineno-0-3757" name="__codelineno-0-3757"></a>        <span class="c1"># Extend basis using orthogonal complement and gram-schmidt if insufficient vectors</span>
</span><span id="__span-0-3758"><a id="__codelineno-0-3758" name="__codelineno-0-3758"></a>        <span class="k">if</span> <span class="n">U</span><span class="o">.</span><span class="n">cols</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
</span><span id="__span-0-3759"><a id="__codelineno-0-3759" name="__codelineno-0-3759"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Extending U with its orthogonal complement.&quot;</span><span class="p">)</span>
</span><span id="__span-0-3760"><a id="__codelineno-0-3760" name="__codelineno-0-3760"></a>            <span class="k">if</span> <span class="n">U</span><span class="o">.</span><span class="n">cols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-3761"><a id="__codelineno-0-3761" name="__codelineno-0-3761"></a>                <span class="c1"># Pad edge case with identity</span>
</span><span id="__span-0-3762"><a id="__codelineno-0-3762" name="__codelineno-0-3762"></a>                <span class="n">orth</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
</span><span id="__span-0-3763"><a id="__codelineno-0-3763" name="__codelineno-0-3763"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3764"><a id="__codelineno-0-3764" name="__codelineno-0-3764"></a>                <span class="n">complement</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">orthogonal_complement</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>
</span><span id="__span-0-3765"><a id="__codelineno-0-3765" name="__codelineno-0-3765"></a>                <span class="n">gram_result</span> <span class="o">=</span> <span class="n">complement</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span>
</span><span id="__span-0-3766"><a id="__codelineno-0-3766" name="__codelineno-0-3766"></a>                    <span class="n">factor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span>
</span><span id="__span-0-3767"><a id="__codelineno-0-3767" name="__codelineno-0-3767"></a>                <span class="p">)</span>
</span><span id="__span-0-3768"><a id="__codelineno-0-3768" name="__codelineno-0-3768"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gram_result</span><span class="p">,</span> <span class="n">ScalarFactor</span><span class="p">):</span>
</span><span id="__span-0-3769"><a id="__codelineno-0-3769" name="__codelineno-0-3769"></a>                    <span class="n">orth</span> <span class="o">=</span> <span class="n">gram_result</span><span class="o">.</span><span class="n">full</span>
</span><span id="__span-0-3770"><a id="__codelineno-0-3770" name="__codelineno-0-3770"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3771"><a id="__codelineno-0-3771" name="__codelineno-0-3771"></a>                    <span class="n">orth</span> <span class="o">=</span> <span class="n">gram_result</span>
</span><span id="__span-0-3772"><a id="__codelineno-0-3772" name="__codelineno-0-3772"></a>
</span><span id="__span-0-3773"><a id="__codelineno-0-3773" name="__codelineno-0-3773"></a>                <span class="n">orth</span> <span class="o">=</span> <span class="n">orth</span><span class="o">.</span><span class="n">normalized</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3774"><a id="__codelineno-0-3774" name="__codelineno-0-3774"></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">orth</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">),</span> <span class="p">(</span>
</span><span id="__span-0-3775"><a id="__codelineno-0-3775" name="__codelineno-0-3775"></a>                    <span class="sa">f</span><span class="s2">&quot;Expected orth to be a Matrix, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">orth</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-3776"><a id="__codelineno-0-3776" name="__codelineno-0-3776"></a>                <span class="p">)</span>
</span><span id="__span-0-3777"><a id="__codelineno-0-3777" name="__codelineno-0-3777"></a>            <span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">orth</span><span class="p">,</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3778"><a id="__codelineno-0-3778" name="__codelineno-0-3778"></a>
</span><span id="__span-0-3779"><a id="__codelineno-0-3779" name="__codelineno-0-3779"></a>        <span class="c1"># Add zero rows and columns to S so that matrix multiplication is defined</span>
</span><span id="__span-0-3780"><a id="__codelineno-0-3780" name="__codelineno-0-3780"></a>        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-3781"><a id="__codelineno-0-3781" name="__codelineno-0-3781"></a>        <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-3782"><a id="__codelineno-0-3782" name="__codelineno-0-3782"></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">c</span><span class="p">),</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span>
</span><span id="__span-0-3783"><a id="__codelineno-0-3783" name="__codelineno-0-3783"></a>            <span class="n">sym</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-0-3784"><a id="__codelineno-0-3784" name="__codelineno-0-3784"></a>        <span class="p">)</span>
</span><span id="__span-0-3785"><a id="__codelineno-0-3785" name="__codelineno-0-3785"></a>
</span><span id="__span-0-3786"><a id="__codelineno-0-3786" name="__codelineno-0-3786"></a>        <span class="k">if</span> <span class="n">verify</span><span class="p">:</span>
</span><span id="__span-0-3787"><a id="__codelineno-0-3787" name="__codelineno-0-3787"></a>            <span class="k">assert</span> <span class="p">(</span><span class="n">U</span> <span class="o">@</span> <span class="n">S</span> <span class="o">@</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="__span-0-3788"><a id="__codelineno-0-3788" name="__codelineno-0-3788"></a>        <span class="k">return</span> <span class="n">SVD</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
</span><span id="__span-0-3789"><a id="__codelineno-0-3789" name="__codelineno-0-3789"></a>
</span><span id="__span-0-3790"><a id="__codelineno-0-3790" name="__codelineno-0-3790"></a>    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-3791"><a id="__codelineno-0-3791" name="__codelineno-0-3791"></a>    <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">singular_value_decomposition</span><span class="p">()</span>
</span><span id="__span-0-3792"><a id="__codelineno-0-3792" name="__codelineno-0-3792"></a>    <span class="c1"># Reverse index such that singular values are in decreasing order</span>
</span><span id="__span-0-3793"><a id="__codelineno-0-3793" name="__codelineno-0-3793"></a>    <span class="n">new_S</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-0-3794"><a id="__codelineno-0-3794" name="__codelineno-0-3794"></a>
</span><span id="__span-0-3795"><a id="__codelineno-0-3795" name="__codelineno-0-3795"></a>    <span class="n">S_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">cols</span><span class="p">)][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-3796"><a id="__codelineno-0-3796" name="__codelineno-0-3796"></a>    <span class="n">new_U</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">U</span><span class="p">)</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="o">*</span><span class="n">S_index</span><span class="p">)</span>
</span><span id="__span-0-3797"><a id="__codelineno-0-3797" name="__codelineno-0-3797"></a>    <span class="n">new_V</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">select_cols</span><span class="p">(</span><span class="o">*</span><span class="n">S_index</span><span class="p">)</span>
</span><span id="__span-0-3798"><a id="__codelineno-0-3798" name="__codelineno-0-3798"></a>
</span><span id="__span-0-3799"><a id="__codelineno-0-3799" name="__codelineno-0-3799"></a>    <span class="c1"># new_U = Matrix(U).</span>
</span><span id="__span-0-3800"><a id="__codelineno-0-3800" name="__codelineno-0-3800"></a>    <span class="c1"># Add orthonormal columns to U and V so that they are square matrices</span>
</span><span id="__span-0-3801"><a id="__codelineno-0-3801" name="__codelineno-0-3801"></a>    <span class="n">new_U</span> <span class="o">=</span> <span class="n">new_U</span><span class="o">.</span><span class="n">QRdecomposition</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">Q</span>
</span><span id="__span-0-3802"><a id="__codelineno-0-3802" name="__codelineno-0-3802"></a>    <span class="n">new_V</span> <span class="o">=</span> <span class="n">new_V</span><span class="o">.</span><span class="n">QRdecomposition</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">Q</span>
</span><span id="__span-0-3803"><a id="__codelineno-0-3803" name="__codelineno-0-3803"></a>
</span><span id="__span-0-3804"><a id="__codelineno-0-3804" name="__codelineno-0-3804"></a>    <span class="c1"># Add zero rows and columns to S so that matrix multiplication is defined</span>
</span><span id="__span-0-3805"><a id="__codelineno-0-3805" name="__codelineno-0-3805"></a>    <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">new_S</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-3806"><a id="__codelineno-0-3806" name="__codelineno-0-3806"></a>    <span class="n">new_S</span> <span class="o">=</span> <span class="n">new_S</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">c</span><span class="p">),</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span>
</span><span id="__span-0-3807"><a id="__codelineno-0-3807" name="__codelineno-0-3807"></a>        <span class="n">sym</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-0-3808"><a id="__codelineno-0-3808" name="__codelineno-0-3808"></a>    <span class="p">)</span>
</span><span id="__span-0-3809"><a id="__codelineno-0-3809" name="__codelineno-0-3809"></a>
</span><span id="__span-0-3810"><a id="__codelineno-0-3810" name="__codelineno-0-3810"></a>    <span class="k">if</span> <span class="n">verify</span> <span class="ow">and</span> <span class="p">(</span><span class="n">residues</span> <span class="o">:=</span> <span class="p">(</span><span class="n">new_U</span> <span class="o">@</span> <span class="n">new_S</span> <span class="o">@</span> <span class="n">new_V</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
</span><span id="__span-0-3811"><a id="__codelineno-0-3811" name="__codelineno-0-3811"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">residues</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</span><span id="__span-0-3812"><a id="__codelineno-0-3812" name="__codelineno-0-3812"></a>        <span class="n">warn</span><span class="p">(</span>
</span><span id="__span-0-3813"><a id="__codelineno-0-3813" name="__codelineno-0-3813"></a>            <span class="sa">f</span><span class="s2">&quot;Verification failed: norm of residual is </span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="n">tol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3814"><a id="__codelineno-0-3814" name="__codelineno-0-3814"></a>            <span class="ne">RuntimeWarning</span><span class="p">,</span>
</span><span id="__span-0-3815"><a id="__codelineno-0-3815" name="__codelineno-0-3815"></a>            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-3816"><a id="__codelineno-0-3816" name="__codelineno-0-3816"></a>        <span class="p">)</span>
</span><span id="__span-0-3817"><a id="__codelineno-0-3817" name="__codelineno-0-3817"></a>    <span class="k">return</span> <span class="n">SVD</span><span class="p">(</span><span class="n">new_U</span><span class="p">,</span> <span class="n">new_S</span><span class="p">,</span> <span class="n">new_V</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.fast_svd" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">fast_svd</span><span class="p">(</span><span class="n">option</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;np&#39;</span><span class="p">,</span> <span class="s1">&#39;sym&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;np&#39;</span><span class="p">,</span> <span class="n">identify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SVD</span> <span class="o">|</span> <span class="n">NumSVD</span></code>

<a href="#ma1522.symbolic.Matrix.fast_svd" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A faster version of SVD that computes numerically using NumPy's SVD function.</p>
<p>This method is designed to be efficient and suitable for large matrices, but it does not guarantee
exact symbolic results like the <a class="autorefs autorefs-internal" title="            singular_value_decomposition(verbosity: int = 0, tol: float = 0.0, verify: bool = True) -> SVD" href="#ma1522.symbolic.Matrix.singular_value_decomposition"><code>singular_value_decomposition</code></a> method.
It uses <a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.svd.html#numpy.linalg.svd"><code>numpy.linalg.svd</code></a> function to compute the singular value decomposition and
<a class="autorefs autorefs-external" href="https://mpmath.org/doc/current/identification.html#mpmath.identify"><code>mpmath.identify</code></a> function to identify rational numbers or surds if requested.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>This method might not return exact values, even if identification is enabled as it does
    not use SymPy's symbolic computation for SVD.</li>
<li>Use this method when performance is a concern and exact symbolic results are not required.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>option</code></b>
              (<code><a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[&#39;np&#39;, &#39;sym&#39;]</code>, default:
                  <code>&#39;np&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return numpy arrays or sympy matrices.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>identify</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to attempt identification of rational numbers or surds.
If <code>True</code>, <code>option</code> must be <code>"sym"</code> to return symbolic matrices.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tol</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Tolerance for <a class="autorefs autorefs-external" href="https://mpmath.org/doc/current/identification.html#mpmath.identify"><code>mpmath.identify</code></a> function as well as
for verifying the SVD result.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="              SVD(U: Matrix, S: Matrix, V: Matrix)

  
      dataclass
   (ma1522.custom_types.SVD)" href="../custom_types/#ma1522.custom_types.SVD">SVD</a></code>
          –
          <div class="doc-md-description">
            <p>A dataclass containing:</p>
<ul>
<li><code>U</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The left singular vectors.</li>
<li><code>S</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The diagonal matrix of singular values.</li>
<li><code>V</code> (<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs)" href="#ma1522.symbolic.Matrix"><code>Matrix</code></a>): The right singular vectors.</li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            NumSVD (ma1522.custom_types.NumSVD)" href="../custom_types/#ma1522.custom_types.NumSVD">NumSVD</a></code>
          –
          <div class="doc-md-description">
            <p>A named tuple containing:</p>
<ul>
<li><code>U</code> (<a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray"><code>numpy.ndarray</code></a>): The left singular vectors as a NumPy array.</li>
<li><code>S</code> (<a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray"><code>numpy.ndarray</code></a>): The diagonal matrix of singular values as a NumPy array.</li>
<li><code>V</code> (<a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray"><code>numpy.ndarray</code></a>): The right singular vectors as a NumPy array.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">fast_svd</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;sym&quot;</span><span class="p">,</span> <span class="n">identify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="go">SVD(U=Matrix([</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[-0.707106781186548, -0.707106781186548]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[-0.707106781186547,  0.707106781186548]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">]), S=Matrix([</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[5.0, 0.0, 0.0]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">[0.0, 3.0, 0.0]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="go">]), V=Matrix([</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="go">[   -0.707106781186548, -0.235702260395516, -0.666666666666667]</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="go">[   -0.707106781186548,  0.235702260395516,  0.666666666666667]</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="go">[-6.47932334256779e-17, -0.942809041582063,  0.333333333333333]</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="go">]))</span>
</span></code></pre></div></td></tr></table></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li><a class="autorefs autorefs-internal" title="            singular_value_decomposition(verbosity: int = 0, tol: float = 0.0, verify: bool = True) -> SVD" href="#ma1522.symbolic.Matrix.singular_value_decomposition"><code>singular_value_decomposition</code></a> for the
    symbolic version of SVD.</li>
<li>NumPy's <a class="autorefs autorefs-external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.svd.html#numpy.linalg.svd"><code>numpy.linalg.svd</code></a> for the underlying numerical
    SVD implementation.</li>
</ul>
</details>
          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3819">3819</a></span>
<span class="normal"><a href="#__codelineno-0-3820">3820</a></span>
<span class="normal"><a href="#__codelineno-0-3821">3821</a></span>
<span class="normal"><a href="#__codelineno-0-3822">3822</a></span>
<span class="normal"><a href="#__codelineno-0-3823">3823</a></span>
<span class="normal"><a href="#__codelineno-0-3824">3824</a></span>
<span class="normal"><a href="#__codelineno-0-3825">3825</a></span>
<span class="normal"><a href="#__codelineno-0-3826">3826</a></span>
<span class="normal"><a href="#__codelineno-0-3827">3827</a></span>
<span class="normal"><a href="#__codelineno-0-3828">3828</a></span>
<span class="normal"><a href="#__codelineno-0-3829">3829</a></span>
<span class="normal"><a href="#__codelineno-0-3830">3830</a></span>
<span class="normal"><a href="#__codelineno-0-3831">3831</a></span>
<span class="normal"><a href="#__codelineno-0-3832">3832</a></span>
<span class="normal"><a href="#__codelineno-0-3833">3833</a></span>
<span class="normal"><a href="#__codelineno-0-3834">3834</a></span>
<span class="normal"><a href="#__codelineno-0-3835">3835</a></span>
<span class="normal"><a href="#__codelineno-0-3836">3836</a></span>
<span class="normal"><a href="#__codelineno-0-3837">3837</a></span>
<span class="normal"><a href="#__codelineno-0-3838">3838</a></span>
<span class="normal"><a href="#__codelineno-0-3839">3839</a></span>
<span class="normal"><a href="#__codelineno-0-3840">3840</a></span>
<span class="normal"><a href="#__codelineno-0-3841">3841</a></span>
<span class="normal"><a href="#__codelineno-0-3842">3842</a></span>
<span class="normal"><a href="#__codelineno-0-3843">3843</a></span>
<span class="normal"><a href="#__codelineno-0-3844">3844</a></span>
<span class="normal"><a href="#__codelineno-0-3845">3845</a></span>
<span class="normal"><a href="#__codelineno-0-3846">3846</a></span>
<span class="normal"><a href="#__codelineno-0-3847">3847</a></span>
<span class="normal"><a href="#__codelineno-0-3848">3848</a></span>
<span class="normal"><a href="#__codelineno-0-3849">3849</a></span>
<span class="normal"><a href="#__codelineno-0-3850">3850</a></span>
<span class="normal"><a href="#__codelineno-0-3851">3851</a></span>
<span class="normal"><a href="#__codelineno-0-3852">3852</a></span>
<span class="normal"><a href="#__codelineno-0-3853">3853</a></span>
<span class="normal"><a href="#__codelineno-0-3854">3854</a></span>
<span class="normal"><a href="#__codelineno-0-3855">3855</a></span>
<span class="normal"><a href="#__codelineno-0-3856">3856</a></span>
<span class="normal"><a href="#__codelineno-0-3857">3857</a></span>
<span class="normal"><a href="#__codelineno-0-3858">3858</a></span>
<span class="normal"><a href="#__codelineno-0-3859">3859</a></span>
<span class="normal"><a href="#__codelineno-0-3860">3860</a></span>
<span class="normal"><a href="#__codelineno-0-3861">3861</a></span>
<span class="normal"><a href="#__codelineno-0-3862">3862</a></span>
<span class="normal"><a href="#__codelineno-0-3863">3863</a></span>
<span class="normal"><a href="#__codelineno-0-3864">3864</a></span>
<span class="normal"><a href="#__codelineno-0-3865">3865</a></span>
<span class="normal"><a href="#__codelineno-0-3866">3866</a></span>
<span class="normal"><a href="#__codelineno-0-3867">3867</a></span>
<span class="normal"><a href="#__codelineno-0-3868">3868</a></span>
<span class="normal"><a href="#__codelineno-0-3869">3869</a></span>
<span class="normal"><a href="#__codelineno-0-3870">3870</a></span>
<span class="normal"><a href="#__codelineno-0-3871">3871</a></span>
<span class="normal"><a href="#__codelineno-0-3872">3872</a></span>
<span class="normal"><a href="#__codelineno-0-3873">3873</a></span>
<span class="normal"><a href="#__codelineno-0-3874">3874</a></span>
<span class="normal"><a href="#__codelineno-0-3875">3875</a></span>
<span class="normal"><a href="#__codelineno-0-3876">3876</a></span>
<span class="normal"><a href="#__codelineno-0-3877">3877</a></span>
<span class="normal"><a href="#__codelineno-0-3878">3878</a></span>
<span class="normal"><a href="#__codelineno-0-3879">3879</a></span>
<span class="normal"><a href="#__codelineno-0-3880">3880</a></span>
<span class="normal"><a href="#__codelineno-0-3881">3881</a></span>
<span class="normal"><a href="#__codelineno-0-3882">3882</a></span>
<span class="normal"><a href="#__codelineno-0-3883">3883</a></span>
<span class="normal"><a href="#__codelineno-0-3884">3884</a></span>
<span class="normal"><a href="#__codelineno-0-3885">3885</a></span>
<span class="normal"><a href="#__codelineno-0-3886">3886</a></span>
<span class="normal"><a href="#__codelineno-0-3887">3887</a></span>
<span class="normal"><a href="#__codelineno-0-3888">3888</a></span>
<span class="normal"><a href="#__codelineno-0-3889">3889</a></span>
<span class="normal"><a href="#__codelineno-0-3890">3890</a></span>
<span class="normal"><a href="#__codelineno-0-3891">3891</a></span>
<span class="normal"><a href="#__codelineno-0-3892">3892</a></span>
<span class="normal"><a href="#__codelineno-0-3893">3893</a></span>
<span class="normal"><a href="#__codelineno-0-3894">3894</a></span>
<span class="normal"><a href="#__codelineno-0-3895">3895</a></span>
<span class="normal"><a href="#__codelineno-0-3896">3896</a></span>
<span class="normal"><a href="#__codelineno-0-3897">3897</a></span>
<span class="normal"><a href="#__codelineno-0-3898">3898</a></span>
<span class="normal"><a href="#__codelineno-0-3899">3899</a></span>
<span class="normal"><a href="#__codelineno-0-3900">3900</a></span>
<span class="normal"><a href="#__codelineno-0-3901">3901</a></span>
<span class="normal"><a href="#__codelineno-0-3902">3902</a></span>
<span class="normal"><a href="#__codelineno-0-3903">3903</a></span>
<span class="normal"><a href="#__codelineno-0-3904">3904</a></span>
<span class="normal"><a href="#__codelineno-0-3905">3905</a></span>
<span class="normal"><a href="#__codelineno-0-3906">3906</a></span>
<span class="normal"><a href="#__codelineno-0-3907">3907</a></span>
<span class="normal"><a href="#__codelineno-0-3908">3908</a></span>
<span class="normal"><a href="#__codelineno-0-3909">3909</a></span>
<span class="normal"><a href="#__codelineno-0-3910">3910</a></span>
<span class="normal"><a href="#__codelineno-0-3911">3911</a></span>
<span class="normal"><a href="#__codelineno-0-3912">3912</a></span>
<span class="normal"><a href="#__codelineno-0-3913">3913</a></span>
<span class="normal"><a href="#__codelineno-0-3914">3914</a></span>
<span class="normal"><a href="#__codelineno-0-3915">3915</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3819"><a id="__codelineno-0-3819" name="__codelineno-0-3819"></a><span class="k">def</span><span class="w"> </span><span class="nf">fast_svd</span><span class="p">(</span>
</span><span id="__span-0-3820"><a id="__codelineno-0-3820" name="__codelineno-0-3820"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-3821"><a id="__codelineno-0-3821" name="__codelineno-0-3821"></a>    <span class="n">option</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;np&quot;</span><span class="p">,</span> <span class="s2">&quot;sym&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;np&quot;</span><span class="p">,</span>
</span><span id="__span-0-3822"><a id="__codelineno-0-3822" name="__codelineno-0-3822"></a>    <span class="n">identify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-3823"><a id="__codelineno-0-3823" name="__codelineno-0-3823"></a>    <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3824"><a id="__codelineno-0-3824" name="__codelineno-0-3824"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SVD</span> <span class="o">|</span> <span class="n">NumSVD</span><span class="p">:</span>
</span><span id="__span-0-3825"><a id="__codelineno-0-3825" name="__codelineno-0-3825"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A faster version of SVD that computes numerically using NumPy&#39;s SVD function.</span>
</span><span id="__span-0-3826"><a id="__codelineno-0-3826" name="__codelineno-0-3826"></a>
</span><span id="__span-0-3827"><a id="__codelineno-0-3827" name="__codelineno-0-3827"></a><span class="sd">    This method is designed to be efficient and suitable for large matrices, but it does not guarantee</span>
</span><span id="__span-0-3828"><a id="__codelineno-0-3828" name="__codelineno-0-3828"></a><span class="sd">    exact symbolic results like the [`singular_value_decomposition`][..singular_value_decomposition] method.</span>
</span><span id="__span-0-3829"><a id="__codelineno-0-3829" name="__codelineno-0-3829"></a><span class="sd">    It uses [`numpy.linalg.svd`][numpy.linalg.svd] function to compute the singular value decomposition and</span>
</span><span id="__span-0-3830"><a id="__codelineno-0-3830" name="__codelineno-0-3830"></a><span class="sd">    [`mpmath.identify`][mpmath.identify] function to identify rational numbers or surds if requested.</span>
</span><span id="__span-0-3831"><a id="__codelineno-0-3831" name="__codelineno-0-3831"></a>
</span><span id="__span-0-3832"><a id="__codelineno-0-3832" name="__codelineno-0-3832"></a><span class="sd">    Note:</span>
</span><span id="__span-0-3833"><a id="__codelineno-0-3833" name="__codelineno-0-3833"></a><span class="sd">        - This method might not return exact values, even if identification is enabled as it does</span>
</span><span id="__span-0-3834"><a id="__codelineno-0-3834" name="__codelineno-0-3834"></a><span class="sd">            not use SymPy&#39;s symbolic computation for SVD.</span>
</span><span id="__span-0-3835"><a id="__codelineno-0-3835" name="__codelineno-0-3835"></a><span class="sd">        - Use this method when performance is a concern and exact symbolic results are not required.</span>
</span><span id="__span-0-3836"><a id="__codelineno-0-3836" name="__codelineno-0-3836"></a>
</span><span id="__span-0-3837"><a id="__codelineno-0-3837" name="__codelineno-0-3837"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3838"><a id="__codelineno-0-3838" name="__codelineno-0-3838"></a><span class="sd">        option (Literal[&quot;np&quot;, &quot;sym&quot;], optional): Whether to return numpy arrays or sympy matrices.</span>
</span><span id="__span-0-3839"><a id="__codelineno-0-3839" name="__codelineno-0-3839"></a><span class="sd">        identify (bool, optional): Whether to attempt identification of rational numbers or surds.</span>
</span><span id="__span-0-3840"><a id="__codelineno-0-3840" name="__codelineno-0-3840"></a><span class="sd">            If `True`, `option` must be `&quot;sym&quot;` to return symbolic matrices.</span>
</span><span id="__span-0-3841"><a id="__codelineno-0-3841" name="__codelineno-0-3841"></a><span class="sd">        tol (float, optional): Tolerance for [`mpmath.identify`][mpmath.identify] function as well as</span>
</span><span id="__span-0-3842"><a id="__codelineno-0-3842" name="__codelineno-0-3842"></a><span class="sd">            for verifying the SVD result.</span>
</span><span id="__span-0-3843"><a id="__codelineno-0-3843" name="__codelineno-0-3843"></a>
</span><span id="__span-0-3844"><a id="__codelineno-0-3844" name="__codelineno-0-3844"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3845"><a id="__codelineno-0-3845" name="__codelineno-0-3845"></a><span class="sd">        (SVD): A dataclass containing:</span>
</span><span id="__span-0-3846"><a id="__codelineno-0-3846" name="__codelineno-0-3846"></a>
</span><span id="__span-0-3847"><a id="__codelineno-0-3847" name="__codelineno-0-3847"></a><span class="sd">            - `U` ([`Matrix`][...]): The left singular vectors.</span>
</span><span id="__span-0-3848"><a id="__codelineno-0-3848" name="__codelineno-0-3848"></a><span class="sd">            - `S` ([`Matrix`][...]): The diagonal matrix of singular values.</span>
</span><span id="__span-0-3849"><a id="__codelineno-0-3849" name="__codelineno-0-3849"></a><span class="sd">            - `V` ([`Matrix`][...]): The right singular vectors.</span>
</span><span id="__span-0-3850"><a id="__codelineno-0-3850" name="__codelineno-0-3850"></a>
</span><span id="__span-0-3851"><a id="__codelineno-0-3851" name="__codelineno-0-3851"></a><span class="sd">        (NumSVD): A named tuple containing:</span>
</span><span id="__span-0-3852"><a id="__codelineno-0-3852" name="__codelineno-0-3852"></a>
</span><span id="__span-0-3853"><a id="__codelineno-0-3853" name="__codelineno-0-3853"></a><span class="sd">            - `U` ([`numpy.ndarray`][numpy.ndarray]): The left singular vectors as a NumPy array.</span>
</span><span id="__span-0-3854"><a id="__codelineno-0-3854" name="__codelineno-0-3854"></a><span class="sd">            - `S` ([`numpy.ndarray`][numpy.ndarray]): The diagonal matrix of singular values as a NumPy array.</span>
</span><span id="__span-0-3855"><a id="__codelineno-0-3855" name="__codelineno-0-3855"></a><span class="sd">            - `V` ([`numpy.ndarray`][numpy.ndarray]): The right singular vectors as a NumPy array.</span>
</span><span id="__span-0-3856"><a id="__codelineno-0-3856" name="__codelineno-0-3856"></a>
</span><span id="__span-0-3857"><a id="__codelineno-0-3857" name="__codelineno-0-3857"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3858"><a id="__codelineno-0-3858" name="__codelineno-0-3858"></a><span class="sd">        &gt;&gt;&gt; mat = Matrix([[3, 2, 2], [2, 3, -2]])</span>
</span><span id="__span-0-3859"><a id="__codelineno-0-3859" name="__codelineno-0-3859"></a><span class="sd">        &gt;&gt;&gt; mat.fast_svd(option=&quot;sym&quot;, identify=False)</span>
</span><span id="__span-0-3860"><a id="__codelineno-0-3860" name="__codelineno-0-3860"></a><span class="sd">        SVD(U=Matrix([</span>
</span><span id="__span-0-3861"><a id="__codelineno-0-3861" name="__codelineno-0-3861"></a><span class="sd">        [-0.707106781186548, -0.707106781186548]</span>
</span><span id="__span-0-3862"><a id="__codelineno-0-3862" name="__codelineno-0-3862"></a><span class="sd">        [-0.707106781186547,  0.707106781186548]</span>
</span><span id="__span-0-3863"><a id="__codelineno-0-3863" name="__codelineno-0-3863"></a><span class="sd">        ]), S=Matrix([</span>
</span><span id="__span-0-3864"><a id="__codelineno-0-3864" name="__codelineno-0-3864"></a><span class="sd">        [5.0, 0.0, 0.0]</span>
</span><span id="__span-0-3865"><a id="__codelineno-0-3865" name="__codelineno-0-3865"></a><span class="sd">        [0.0, 3.0, 0.0]</span>
</span><span id="__span-0-3866"><a id="__codelineno-0-3866" name="__codelineno-0-3866"></a><span class="sd">        ]), V=Matrix([</span>
</span><span id="__span-0-3867"><a id="__codelineno-0-3867" name="__codelineno-0-3867"></a><span class="sd">        [   -0.707106781186548, -0.235702260395516, -0.666666666666667]</span>
</span><span id="__span-0-3868"><a id="__codelineno-0-3868" name="__codelineno-0-3868"></a><span class="sd">        [   -0.707106781186548,  0.235702260395516,  0.666666666666667]</span>
</span><span id="__span-0-3869"><a id="__codelineno-0-3869" name="__codelineno-0-3869"></a><span class="sd">        [-6.47932334256779e-17, -0.942809041582063,  0.333333333333333]</span>
</span><span id="__span-0-3870"><a id="__codelineno-0-3870" name="__codelineno-0-3870"></a><span class="sd">        ]))</span>
</span><span id="__span-0-3871"><a id="__codelineno-0-3871" name="__codelineno-0-3871"></a>
</span><span id="__span-0-3872"><a id="__codelineno-0-3872" name="__codelineno-0-3872"></a><span class="sd">    See Also:</span>
</span><span id="__span-0-3873"><a id="__codelineno-0-3873" name="__codelineno-0-3873"></a><span class="sd">        - [`singular_value_decomposition`][..singular_value_decomposition] for the</span>
</span><span id="__span-0-3874"><a id="__codelineno-0-3874" name="__codelineno-0-3874"></a><span class="sd">            symbolic version of SVD.</span>
</span><span id="__span-0-3875"><a id="__codelineno-0-3875" name="__codelineno-0-3875"></a><span class="sd">        - NumPy&#39;s [`numpy.linalg.svd`][numpy.linalg.svd] for the underlying numerical</span>
</span><span id="__span-0-3876"><a id="__codelineno-0-3876" name="__codelineno-0-3876"></a><span class="sd">            SVD implementation.</span>
</span><span id="__span-0-3877"><a id="__codelineno-0-3877" name="__codelineno-0-3877"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3878"><a id="__codelineno-0-3878" name="__codelineno-0-3878"></a>
</span><span id="__span-0-3879"><a id="__codelineno-0-3879" name="__codelineno-0-3879"></a>    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-3880"><a id="__codelineno-0-3880" name="__codelineno-0-3880"></a>    <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
</span><span id="__span-0-3881"><a id="__codelineno-0-3881" name="__codelineno-0-3881"></a>    <span class="c1"># To align with MA1522 Syllabus, return V instead of V.T</span>
</span><span id="__span-0-3882"><a id="__codelineno-0-3882" name="__codelineno-0-3882"></a>    <span class="c1"># Need not use conjugate transpose as MA1522 deals with real matrices</span>
</span><span id="__span-0-3883"><a id="__codelineno-0-3883" name="__codelineno-0-3883"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">Vh</span><span class="o">.</span><span class="n">T</span>
</span><span id="__span-0-3884"><a id="__codelineno-0-3884" name="__codelineno-0-3884"></a>
</span><span id="__span-0-3885"><a id="__codelineno-0-3885" name="__codelineno-0-3885"></a>    <span class="c1"># Create sigma matrix from singular values</span>
</span><span id="__span-0-3886"><a id="__codelineno-0-3886" name="__codelineno-0-3886"></a>    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</span><span id="__span-0-3887"><a id="__codelineno-0-3887" name="__codelineno-0-3887"></a>    <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-0-3888"><a id="__codelineno-0-3888" name="__codelineno-0-3888"></a>    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">S</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">c</span><span class="p">))),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-3889"><a id="__codelineno-0-3889" name="__codelineno-0-3889"></a>    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">S</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span> <span class="o">-</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">))),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-3890"><a id="__codelineno-0-3890" name="__codelineno-0-3890"></a>    <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;np&quot;</span><span class="p">:</span>
</span><span id="__span-0-3891"><a id="__codelineno-0-3891" name="__codelineno-0-3891"></a>        <span class="k">return</span> <span class="n">NumSVD</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
</span><span id="__span-0-3892"><a id="__codelineno-0-3892" name="__codelineno-0-3892"></a>    <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;sym&quot;</span><span class="p">:</span>
</span><span id="__span-0-3893"><a id="__codelineno-0-3893" name="__codelineno-0-3893"></a>        <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">U</span><span class="p">),</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
</span><span id="__span-0-3894"><a id="__codelineno-0-3894" name="__codelineno-0-3894"></a>        <span class="k">if</span> <span class="n">identify</span><span class="p">:</span>
</span><span id="__span-0-3895"><a id="__codelineno-0-3895" name="__codelineno-0-3895"></a>            <span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3896"><a id="__codelineno-0-3896" name="__codelineno-0-3896"></a>            <span class="n">S</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3897"><a id="__codelineno-0-3897" name="__codelineno-0-3897"></a>            <span class="n">V</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3898"><a id="__codelineno-0-3898" name="__codelineno-0-3898"></a>            <span class="n">residues</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">U</span> <span class="o">@</span> <span class="n">S</span> <span class="o">@</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</span><span id="__span-0-3899"><a id="__codelineno-0-3899" name="__codelineno-0-3899"></a>            <span class="k">if</span> <span class="n">residues</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
</span><span id="__span-0-3900"><a id="__codelineno-0-3900" name="__codelineno-0-3900"></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">residues</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</span><span id="__span-0-3901"><a id="__codelineno-0-3901" name="__codelineno-0-3901"></a>                <span class="n">warn</span><span class="p">(</span>
</span><span id="__span-0-3902"><a id="__codelineno-0-3902" name="__codelineno-0-3902"></a>                    <span class="sa">f</span><span class="s2">&quot;Non-zero Identification Error: </span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-0-3903"><a id="__codelineno-0-3903" name="__codelineno-0-3903"></a>                    <span class="ne">RuntimeWarning</span><span class="p">,</span>
</span><span id="__span-0-3904"><a id="__codelineno-0-3904" name="__codelineno-0-3904"></a>                    <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-3905"><a id="__codelineno-0-3905" name="__codelineno-0-3905"></a>                <span class="p">)</span>
</span><span id="__span-0-3906"><a id="__codelineno-0-3906" name="__codelineno-0-3906"></a>            <span class="k">return</span> <span class="n">SVD</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
</span><span id="__span-0-3907"><a id="__codelineno-0-3907" name="__codelineno-0-3907"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3908"><a id="__codelineno-0-3908" name="__codelineno-0-3908"></a>            <span class="k">return</span> <span class="n">SVD</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
</span><span id="__span-0-3909"><a id="__codelineno-0-3909" name="__codelineno-0-3909"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3910"><a id="__codelineno-0-3910" name="__codelineno-0-3910"></a>        <span class="n">warn</span><span class="p">(</span>
</span><span id="__span-0-3911"><a id="__codelineno-0-3911" name="__codelineno-0-3911"></a>            <span class="sa">f</span><span class="s2">&quot;Invalid option &#39;</span><span class="si">{</span><span class="n">option</span><span class="si">}</span><span class="s2">&#39;. Expected &#39;np&#39; or &#39;sym&#39;. Returning NumSVD.&quot;</span><span class="p">,</span>
</span><span id="__span-0-3912"><a id="__codelineno-0-3912" name="__codelineno-0-3912"></a>            <span class="ne">SyntaxWarning</span><span class="p">,</span>
</span><span id="__span-0-3913"><a id="__codelineno-0-3913" name="__codelineno-0-3913"></a>            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-3914"><a id="__codelineno-0-3914" name="__codelineno-0-3914"></a>        <span class="p">)</span>
</span><span id="__span-0-3915"><a id="__codelineno-0-3915" name="__codelineno-0-3915"></a>        <span class="k">return</span> <span class="n">NumSVD</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ma1522.symbolic.Matrix.standard_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">standard_matrix</span><span class="p">(</span><span class="n">out</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">matrices</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">PartGen</span><span class="p">]</span></code>

<a href="#ma1522.symbolic.Matrix.standard_matrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the standard matrix for the transformation from self to out.</p>
<p>The standard matrix is a matrix <code>T</code> such that <code>T @ self = out</code>, where <code>self</code> is the matrix
whos columns represent the input vectors and <code>out</code> is the matrix whose columns represent the output vectors.</p>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The standard matrix may not be unique if the transformation is not injective.</li>
<li>If multiple solutions are found, the first solution is returned.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>out</code></b>
              (<code><a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a></code>)
          –
          <div class="doc-md-description">
            <p>The target matrix for the transformation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>matrices</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>The type of matrices to return:</p>
<ul>
<li>1: Returns the standard matrix.</li>
<li>2: Returns a <a class="autorefs autorefs-internal" title="              PartGen(part_sol: Matrix, gen_sol: Matrix)

  
      dataclass
  " href="../custom_types/#ma1522.custom_types.PartGen"><code>PartGen</code></a> with the part solution and general solution.</li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="              ma1522.symbolic.Matrix(*args, aug_pos: Iterable[int] | int | None = None, **kwargs) (ma1522.symbolic.Matrix)" href="#ma1522.symbolic.Matrix">Matrix</a>]</code>
          –
          <div class="doc-md-description">
            <p>If <code>matrices=1</code>, returns the standard matrix for the transformation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-internal" title="              PartGen(part_sol: Matrix, gen_sol: Matrix)

  
      dataclass
   (ma1522.custom_types.PartGen)" href="../custom_types/#ma1522.custom_types.PartGen">PartGen</a>]</code>
          –
          <div class="doc-md-description">
            <p>If <code>matrices=2</code>, returns a <a class="autorefs autorefs-internal" title="              PartGen(part_sol: Matrix, gen_sol: Matrix)

  
      dataclass
  " href="../custom_types/#ma1522.custom_types.PartGen"><code>PartGen</code></a> with the part solution and general solution.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python Console Session</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span>
<span class="normal"><a href="#__codelineno-0-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span><span class="o">.</span><span class="n">standard_matrix</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="go">[Matrix([</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="go">[   2,    1,   1]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="go">[-3/5, 14/5, 3/5]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="go">[ 3/5,  1/5, 7/5]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="go">])]</span>
</span></code></pre></div></td></tr></table></div>

          

            <details class="quote">
              <summary>Source code in <code>src/ma1522/symbolic.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3921">3921</a></span>
<span class="normal"><a href="#__codelineno-0-3922">3922</a></span>
<span class="normal"><a href="#__codelineno-0-3923">3923</a></span>
<span class="normal"><a href="#__codelineno-0-3924">3924</a></span>
<span class="normal"><a href="#__codelineno-0-3925">3925</a></span>
<span class="normal"><a href="#__codelineno-0-3926">3926</a></span>
<span class="normal"><a href="#__codelineno-0-3927">3927</a></span>
<span class="normal"><a href="#__codelineno-0-3928">3928</a></span>
<span class="normal"><a href="#__codelineno-0-3929">3929</a></span>
<span class="normal"><a href="#__codelineno-0-3930">3930</a></span>
<span class="normal"><a href="#__codelineno-0-3931">3931</a></span>
<span class="normal"><a href="#__codelineno-0-3932">3932</a></span>
<span class="normal"><a href="#__codelineno-0-3933">3933</a></span>
<span class="normal"><a href="#__codelineno-0-3934">3934</a></span>
<span class="normal"><a href="#__codelineno-0-3935">3935</a></span>
<span class="normal"><a href="#__codelineno-0-3936">3936</a></span>
<span class="normal"><a href="#__codelineno-0-3937">3937</a></span>
<span class="normal"><a href="#__codelineno-0-3938">3938</a></span>
<span class="normal"><a href="#__codelineno-0-3939">3939</a></span>
<span class="normal"><a href="#__codelineno-0-3940">3940</a></span>
<span class="normal"><a href="#__codelineno-0-3941">3941</a></span>
<span class="normal"><a href="#__codelineno-0-3942">3942</a></span>
<span class="normal"><a href="#__codelineno-0-3943">3943</a></span>
<span class="normal"><a href="#__codelineno-0-3944">3944</a></span>
<span class="normal"><a href="#__codelineno-0-3945">3945</a></span>
<span class="normal"><a href="#__codelineno-0-3946">3946</a></span>
<span class="normal"><a href="#__codelineno-0-3947">3947</a></span>
<span class="normal"><a href="#__codelineno-0-3948">3948</a></span>
<span class="normal"><a href="#__codelineno-0-3949">3949</a></span>
<span class="normal"><a href="#__codelineno-0-3950">3950</a></span>
<span class="normal"><a href="#__codelineno-0-3951">3951</a></span>
<span class="normal"><a href="#__codelineno-0-3952">3952</a></span>
<span class="normal"><a href="#__codelineno-0-3953">3953</a></span>
<span class="normal"><a href="#__codelineno-0-3954">3954</a></span>
<span class="normal"><a href="#__codelineno-0-3955">3955</a></span>
<span class="normal"><a href="#__codelineno-0-3956">3956</a></span>
<span class="normal"><a href="#__codelineno-0-3957">3957</a></span>
<span class="normal"><a href="#__codelineno-0-3958">3958</a></span>
<span class="normal"><a href="#__codelineno-0-3959">3959</a></span>
<span class="normal"><a href="#__codelineno-0-3960">3960</a></span>
<span class="normal"><a href="#__codelineno-0-3961">3961</a></span>
<span class="normal"><a href="#__codelineno-0-3962">3962</a></span>
<span class="normal"><a href="#__codelineno-0-3963">3963</a></span>
<span class="normal"><a href="#__codelineno-0-3964">3964</a></span>
<span class="normal"><a href="#__codelineno-0-3965">3965</a></span>
<span class="normal"><a href="#__codelineno-0-3966">3966</a></span>
<span class="normal"><a href="#__codelineno-0-3967">3967</a></span>
<span class="normal"><a href="#__codelineno-0-3968">3968</a></span>
<span class="normal"><a href="#__codelineno-0-3969">3969</a></span>
<span class="normal"><a href="#__codelineno-0-3970">3970</a></span>
<span class="normal"><a href="#__codelineno-0-3971">3971</a></span>
<span class="normal"><a href="#__codelineno-0-3972">3972</a></span>
<span class="normal"><a href="#__codelineno-0-3973">3973</a></span>
<span class="normal"><a href="#__codelineno-0-3974">3974</a></span>
<span class="normal"><a href="#__codelineno-0-3975">3975</a></span>
<span class="normal"><a href="#__codelineno-0-3976">3976</a></span>
<span class="normal"><a href="#__codelineno-0-3977">3977</a></span>
<span class="normal"><a href="#__codelineno-0-3978">3978</a></span>
<span class="normal"><a href="#__codelineno-0-3979">3979</a></span>
<span class="normal"><a href="#__codelineno-0-3980">3980</a></span>
<span class="normal"><a href="#__codelineno-0-3981">3981</a></span>
<span class="normal"><a href="#__codelineno-0-3982">3982</a></span>
<span class="normal"><a href="#__codelineno-0-3983">3983</a></span>
<span class="normal"><a href="#__codelineno-0-3984">3984</a></span>
<span class="normal"><a href="#__codelineno-0-3985">3985</a></span>
<span class="normal"><a href="#__codelineno-0-3986">3986</a></span>
<span class="normal"><a href="#__codelineno-0-3987">3987</a></span>
<span class="normal"><a href="#__codelineno-0-3988">3988</a></span>
<span class="normal"><a href="#__codelineno-0-3989">3989</a></span>
<span class="normal"><a href="#__codelineno-0-3990">3990</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-3921"><a id="__codelineno-0-3921" name="__codelineno-0-3921"></a><span class="k">def</span><span class="w"> </span><span class="nf">standard_matrix</span><span class="p">(</span>
</span><span id="__span-0-3922"><a id="__codelineno-0-3922" name="__codelineno-0-3922"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">matrices</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-3923"><a id="__codelineno-0-3923" name="__codelineno-0-3923"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">PartGen</span><span class="p">]:</span>
</span><span id="__span-0-3924"><a id="__codelineno-0-3924" name="__codelineno-0-3924"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the standard matrix for the transformation from self to out.</span>
</span><span id="__span-0-3925"><a id="__codelineno-0-3925" name="__codelineno-0-3925"></a>
</span><span id="__span-0-3926"><a id="__codelineno-0-3926" name="__codelineno-0-3926"></a><span class="sd">    The standard matrix is a matrix `T` such that `T @ self = out`, where `self` is the matrix</span>
</span><span id="__span-0-3927"><a id="__codelineno-0-3927" name="__codelineno-0-3927"></a><span class="sd">    whos columns represent the input vectors and `out` is the matrix whose columns represent the output vectors.</span>
</span><span id="__span-0-3928"><a id="__codelineno-0-3928" name="__codelineno-0-3928"></a>
</span><span id="__span-0-3929"><a id="__codelineno-0-3929" name="__codelineno-0-3929"></a><span class="sd">    Note:</span>
</span><span id="__span-0-3930"><a id="__codelineno-0-3930" name="__codelineno-0-3930"></a><span class="sd">        - The standard matrix may not be unique if the transformation is not injective.</span>
</span><span id="__span-0-3931"><a id="__codelineno-0-3931" name="__codelineno-0-3931"></a><span class="sd">        - If multiple solutions are found, the first solution is returned.</span>
</span><span id="__span-0-3932"><a id="__codelineno-0-3932" name="__codelineno-0-3932"></a>
</span><span id="__span-0-3933"><a id="__codelineno-0-3933" name="__codelineno-0-3933"></a><span class="sd">    Args:</span>
</span><span id="__span-0-3934"><a id="__codelineno-0-3934" name="__codelineno-0-3934"></a><span class="sd">        out (Matrix): The target matrix for the transformation.</span>
</span><span id="__span-0-3935"><a id="__codelineno-0-3935" name="__codelineno-0-3935"></a><span class="sd">        matrices (int): The type of matrices to return:</span>
</span><span id="__span-0-3936"><a id="__codelineno-0-3936" name="__codelineno-0-3936"></a>
</span><span id="__span-0-3937"><a id="__codelineno-0-3937" name="__codelineno-0-3937"></a><span class="sd">            - 1: Returns the standard matrix.</span>
</span><span id="__span-0-3938"><a id="__codelineno-0-3938" name="__codelineno-0-3938"></a><span class="sd">            - 2: Returns a [`PartGen`][(p).] with the part solution and general solution.</span>
</span><span id="__span-0-3939"><a id="__codelineno-0-3939" name="__codelineno-0-3939"></a>
</span><span id="__span-0-3940"><a id="__codelineno-0-3940" name="__codelineno-0-3940"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-3941"><a id="__codelineno-0-3941" name="__codelineno-0-3941"></a><span class="sd">        (list[Matrix]): If `matrices=1`, returns the standard matrix for the transformation.</span>
</span><span id="__span-0-3942"><a id="__codelineno-0-3942" name="__codelineno-0-3942"></a><span class="sd">        (list[PartGen]): If `matrices=2`, returns a [`PartGen`][(p).] with the part solution and general solution.</span>
</span><span id="__span-0-3943"><a id="__codelineno-0-3943" name="__codelineno-0-3943"></a>
</span><span id="__span-0-3944"><a id="__codelineno-0-3944" name="__codelineno-0-3944"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-3945"><a id="__codelineno-0-3945" name="__codelineno-0-3945"></a><span class="sd">        &gt;&gt;&gt; input = Matrix([[1, 0, 1], [2, -1, 0], [0, 3, 1]])</span>
</span><span id="__span-0-3946"><a id="__codelineno-0-3946" name="__codelineno-0-3946"></a><span class="sd">        &gt;&gt;&gt; output = Matrix([[4, 2, 3], [5, -1, 0], [1, 4, 2]])</span>
</span><span id="__span-0-3947"><a id="__codelineno-0-3947" name="__codelineno-0-3947"></a><span class="sd">        &gt;&gt;&gt; input.standard_matrix(output)</span>
</span><span id="__span-0-3948"><a id="__codelineno-0-3948" name="__codelineno-0-3948"></a><span class="sd">        [Matrix([</span>
</span><span id="__span-0-3949"><a id="__codelineno-0-3949" name="__codelineno-0-3949"></a><span class="sd">        [   2,    1,   1]</span>
</span><span id="__span-0-3950"><a id="__codelineno-0-3950" name="__codelineno-0-3950"></a><span class="sd">        [-3/5, 14/5, 3/5]</span>
</span><span id="__span-0-3951"><a id="__codelineno-0-3951" name="__codelineno-0-3951"></a><span class="sd">        [ 3/5,  1/5, 7/5]</span>
</span><span id="__span-0-3952"><a id="__codelineno-0-3952" name="__codelineno-0-3952"></a><span class="sd">        ])]</span>
</span><span id="__span-0-3953"><a id="__codelineno-0-3953" name="__codelineno-0-3953"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-3954"><a id="__codelineno-0-3954" name="__codelineno-0-3954"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">create_unk_matrix</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
</span><span id="__span-0-3955"><a id="__codelineno-0-3955" name="__codelineno-0-3955"></a>    <span class="n">equal_0</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">out</span>
</span><span id="__span-0-3956"><a id="__codelineno-0-3956" name="__codelineno-0-3956"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-3957"><a id="__codelineno-0-3957" name="__codelineno-0-3957"></a>        <span class="c1"># Add zeroing examples to condition the transformation matrix for unknown vectors</span>
</span><span id="__span-0-3958"><a id="__codelineno-0-3958" name="__codelineno-0-3958"></a>        <span class="n">examples</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-3959"><a id="__codelineno-0-3959" name="__codelineno-0-3959"></a>        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="p">(</span><span class="n">symbols</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">):</span>
</span><span id="__span-0-3960"><a id="__codelineno-0-3960" name="__codelineno-0-3960"></a>            <span class="n">sub</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">symbols</span> <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">symbol</span><span class="p">}</span>
</span><span id="__span-0-3961"><a id="__codelineno-0-3961" name="__codelineno-0-3961"></a>            <span class="n">sub</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-3962"><a id="__codelineno-0-3962" name="__codelineno-0-3962"></a>            <span class="n">examples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">equal_0</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span>
</span><span id="__span-0-3963"><a id="__codelineno-0-3963" name="__codelineno-0-3963"></a>
</span><span id="__span-0-3964"><a id="__codelineno-0-3964" name="__codelineno-0-3964"></a>        <span class="c1"># for _ in range(X.rows * X.cols):</span>
</span><span id="__span-0-3965"><a id="__codelineno-0-3965" name="__codelineno-0-3965"></a>        <span class="c1">#     # Add random examples to condition the transformation matrix</span>
</span><span id="__span-0-3966"><a id="__codelineno-0-3966" name="__codelineno-0-3966"></a>        <span class="c1">#     rand = Matrix.create_rand_matrix(r=len(self.free_symbols), c=1)</span>
</span><span id="__span-0-3967"><a id="__codelineno-0-3967" name="__codelineno-0-3967"></a>        <span class="c1">#     sub = {s: rand[i, 0] for i, s in enumerate(symbols)}</span>
</span><span id="__span-0-3968"><a id="__codelineno-0-3968" name="__codelineno-0-3968"></a>        <span class="c1">#     examples.append(equal_0.subs(sub))</span>
</span><span id="__span-0-3969"><a id="__codelineno-0-3969" name="__codelineno-0-3969"></a>
</span><span id="__span-0-3970"><a id="__codelineno-0-3970" name="__codelineno-0-3970"></a>        <span class="n">condition</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>
</span><span id="__span-0-3971"><a id="__codelineno-0-3971" name="__codelineno-0-3971"></a>        <span class="n">equal_0</span> <span class="o">=</span> <span class="n">equal_0</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">aug_line</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-3972"><a id="__codelineno-0-3972" name="__codelineno-0-3972"></a>
</span><span id="__span-0-3973"><a id="__codelineno-0-3973" name="__codelineno-0-3973"></a>    <span class="n">sol</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">equal_0</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">,</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-3974"><a id="__codelineno-0-3974" name="__codelineno-0-3974"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-3975"><a id="__codelineno-0-3975" name="__codelineno-0-3975"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-3976"><a id="__codelineno-0-3976" name="__codelineno-0-3976"></a>            <span class="s2">&quot;No solution found for the standard matrix. &quot;</span>
</span><span id="__span-0-3977"><a id="__codelineno-0-3977" name="__codelineno-0-3977"></a>            <span class="s2">&quot;This may indicate that the transformation is not linear.&quot;</span>
</span><span id="__span-0-3978"><a id="__codelineno-0-3978" name="__codelineno-0-3978"></a>        <span class="p">)</span>
</span><span id="__span-0-3979"><a id="__codelineno-0-3979" name="__codelineno-0-3979"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-3980"><a id="__codelineno-0-3980" name="__codelineno-0-3980"></a>    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
</span><span id="__span-0-3981"><a id="__codelineno-0-3981" name="__codelineno-0-3981"></a>        <span class="n">tmp</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="__span-0-3982"><a id="__codelineno-0-3982" name="__codelineno-0-3982"></a>        <span class="k">if</span> <span class="n">matrices</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-3983"><a id="__codelineno-0-3983" name="__codelineno-0-3983"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span><span id="__span-0-3984"><a id="__codelineno-0-3984" name="__codelineno-0-3984"></a>        <span class="k">elif</span> <span class="n">matrices</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-3985"><a id="__codelineno-0-3985" name="__codelineno-0-3985"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">sep_part_gen</span><span class="p">())</span>
</span><span id="__span-0-3986"><a id="__codelineno-0-3986" name="__codelineno-0-3986"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-3987"><a id="__codelineno-0-3987" name="__codelineno-0-3987"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-3988"><a id="__codelineno-0-3988" name="__codelineno-0-3988"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid value for matrices: </span><span class="si">{</span><span class="n">matrices</span><span class="si">}</span><span class="s2">. Expected 1 or 2.&quot;</span>
</span><span id="__span-0-3989"><a id="__codelineno-0-3989" name="__codelineno-0-3989"></a>            <span class="p">)</span>
</span><span id="__span-0-3990"><a id="__codelineno-0-3990" name="__codelineno-0-3990"></a>    <span class="k">return</span> <span class="n">res</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../custom_types/" class="md-footer__link md-footer__link--prev" aria-label="Previous: custom_types">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                custom_types
              </div>
            </div>
          </a>
        
        
          
          <a href="../inherited/" class="md-footer__link md-footer__link--next" aria-label="Next: inherited methods">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                inherited methods
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Yee Shin Teng
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.expand", "navigation.footer", "navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../assets/javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"></script>
      
    
  </body>
</html>